/*! Tripetto Form Runner 8.2.0 - Copyright (C) 2024 Tripetto B.V. - All Rights Reserved */
var t,e,s=Object.freeze({__proto__:null,get AES(){return di},get Await(){return ss},get Branch(){return Qs},get Callback(){return es},get Condition(){return Zs},get ConditionBlock(){return _n},get ConditionBlocksNamespace(){return bn},get Console(){return Jt},get Context(){return Es},get DEBUG(){return se},get Data(){return Fs},get DateTime(){return b},get Debounce(){return te},get Enumerator(){return i},get Environment(){return Yt},get Errors(){return ws},get Export(){return Sn},get Flags(){return Zt},get HeadlessBlock(){return gn},get Hooks(){return re},get Import(){return Cn},get Instance(){return Vs},get L10n(){return qs},get Limiter(){return Qt},get MarkdownFeatures(){return tn},get MarkdownParser(){return sn},get Moment(){return xn},get NAME(){return ki},get Namespaces(){return An},get Node(){return fn},get NodeBlock(){return dn},get NodeBlocksNamespace(){return En},get Num(){return t},get Runner(){return Nn},get SHA2(){return je},get Section(){return Xs},get Slot(){return _s},get Slots(){return Ms},get Stack(){return ee},get Storyline(){return wn},get Str(){return e},get Throttle(){return Xt},get VERSION(){return Si},get Value(){return Ps},get arrayItem(){return R},get arraySize(){return B},get assert(){return G},get block(){return _i},get calculateFingerprintAndStencil(){return Rn},get call(){return mt},get callAsync(){return pt},get callBind(){return ft},get callEx(){return gt},get callFunction(){return _t},get callPromise(){return dt},get cancelFrame(){return Mt},get cancelInterval(){return Ft},get cancelPromise(){return Ct},get cancelTick(){return vt},get cancelTimeout(){return It},get cancelUIInterval(){return Lt},get cancelUITimeout(){return Pt},get cast(){return $},get castToBoolean(){return W},get castToFloat(){return q},get castToNumber(){return j},get castToString(){return K},get checksum(){return zn},get clone(){return J},get compare(){return Q},get condition(){return bi},get count(){return at},get createInstanceOf(){return Wt},get destroy(){return vi},get disableDebugging(){return ie},get each(){return X},get eachReverse(){return tt},get enableDebugging(){return ne},get extend(){return Y},get extendImmutable(){return Z},get filter(){return ht},get find(){return ct},get findFirst(){return lt},get findLast(){return ut},get fingerprint(){return Hn},get firstArrayItem(){return H},get forEach(){return ot},get get(){return zt},get getAny(){return Ut},get getBoolean(){return Gt},get getFloat(){return jt},get getNumber(){return Kt},get getString(){return $t},get has(){return nt},get hasOneOrMore(){return rt},get hasOnly(){return it},get hookup(){return ue},get isArray(){return F},get isArrayOrCollection(){return L},get isBoolean(){return A},get isCollection(){return O},get isDate(){return N},get isDefined(){return k},get isError(){return z},get isFilledString(){return T},get isFloat(){return P},get isFunction(){return x},get isNull(){return S},get isNumber(){return I},get isNumberFinite(){return E},get isObject(){return C},get isPromise(){return U},get isRegEx(){return D},get isString(){return w},get isUndefined(){return v},get isVariable(){return rn},get lastArrayItem(){return V},get licensee(){return gi},get map(){return et},get markdownify(){return ln},get markdownifyTo(){return mn},get markdownifyToPlainText(){return pn},get markdownifyToString(){return un},get markdownifyToURL(){return cn},get mountNamespace(){return Fn},get noop(){return y},get powDuration(){return Xn},get powHashRate(){return Zn},get powSolve(){return Jn},get powSpentTime(){return Qn},get powVerify(){return Yn},get reduce(){return st},get scheduleAction(){return Vt},get scheduleAndCancelFrame(){return wt},get scheduleAndCancelPromise(){return St},get scheduleAndCancelTick(){return yt},get scheduleAnimation(){return Rt},get scheduleEvent(){return Ht},get scheduleFrame(){return xt},get scheduleInterval(){return At},get scheduleNumberOfFrames(){return Bt},get schedulePromise(){return kt},get scheduleTick(){return bt},get scheduleTimeout(){return Tt},get scheduleUIInterval(){return Ot},get scheduleUITimeout(){return Et},get set(){return Nt},get setAny(){return Dt},get stencil(){return Dn},get stringLength(){return M},get tripetto(){return _i},get unmountNamespace(){return On},get validator(){return yi},get verify(){return fi}});!function(t){function e(t,e){const s=Math.pow(10,e||0);return E(t)?Math.round(j((t*s).toFixed(1)))/s:0}t.round=function(t){return E(t)?Math.round(t):0},t.floor=function(t){return E(t)?Math.floor(t):0},t.ceil=function(t){return E(t)?Math.ceil(t):0},t.conform=e,t.positive=function(t){return E(t)&&t>0?t:0},t.negative=function(t){return E(t)&&t<0?t:0},t.max=function(t,e){return E(t)&&E(e)?Math.max(t,e):E(t)?t:E(e)?e:0},t.maxL=function(...t){const e=B(t);let s=NaN;if(e>0)for(let n=0;n<e;n++){const e=t[n];E(e)&&(!E(s)||e>s)&&(s=e)}return E(s)?s:0},t.min=function(t,e){return E(t)&&E(e)?Math.min(t,e):E(t)?t:E(e)?e:0},t.minL=function(...t){const e=B(t);let s=NaN;if(e>0)for(let n=0;n<e;n++){const e=t[n];E(e)&&(!E(s)||e<s)&&(s=e)}return E(s)?s:0},t.range=function(t,e,s){return E(t)?(E(s)&&e>s&&(e=s),E(e)&&t<e?e:E(s)&&t>s?s:t):E(e)?e:E(s)?s:0},t.inRange=function(t,e,s,n=!0,i=!1){return E(t)&&(n?t>=e:t>e)&&(i?t<=s:t<s)},t.format=function(t,s=0,n=",",i=".",r="-"){let a,o,h,l="";if(-1!==`${t="auto"===s?q(t):e(q(t),s)}`.indexOf("e"))if(-1!==`${t}`.indexOf("e-")){const e=t;for(let s=20;s>=0&&(t=e.toFixed(s).replace(/(0*$)/g,"")||"0",parseFloat(t)!==e);s--);}else t=t<0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER;if(a=K(t).replace("-",r).split("."),o=a[0],h=B(a)>=2?a[1]:"",T(n))for(let t=M(o)-1,e=0;t>=0;t--)l=o.charAt(t)+(3===e&&o.charAt(t)!==r?n:"")+l,3===e&&(e=0),e++;else l=o;if(("auto"===s||s>0)&&((h||"auto"!==s)&&(l+=i+h),"auto"!==s))for(s-=M(h);s>0;)l+="0",s--;return l}}(t||(t={})),function(t){function e(t){return T(t)?t.toLowerCase():""}function s(t){return T(t)?t.replace(/(^\s*)|(\s*$)/g,""):""}function n(t){return T(t)?t.replace(/(\s*$)/g,""):""}function i(t){return T(t)?t.replace(/[^\S\r\n\.]{2,}/g," ").replace(/\n[^\S\r\n\.]/g,"\n"):""}function r(t){return i(s(t))}function a(t,e,s=""){return t=K(t),E(e)&&e>0&&e<M(t)?T(s)?n(t.substr(0,e))+s:t.substr(0,e):t}function o(t,s,n="",i=!1){let r="",a=0;return t=K(t),s=K(s),X(i?e(t).split(e(s)):t.split(s),(e=>{const i=M(e);r+=(a>0?n:"")+t.substr(a,i),a+=i+M(s)})),r}function h(t,e="",s,...n){let i="";if(t){let o,h;O(t)?o=t:F(t)||(h=Object.keys(t));const l=(h||o||t).length;for(let u=0;u<l;u++)i+=(""===i?"":e)+K(s?mt(s,...(r=h?h[u]:u,a=n.slice(0),w(r)?a.unshift(t[r]):o?a.unshift(o.item(r)):a.unshift(t[r]),a)):h?t[h[u]]:o?o.item(u):t[u])}var r,a;return i}t.lowercase=e,t.uppercase=function(t){return T(t)?t.toUpperCase():""},t.capitalize=function(t,s="first-character",n=!1){if(n&&(t=e(t)),T(t)){const e="each-sentence"===s?t.split("."):[t];return X(e,(t=>{let e="";if("each-word"!==s){let s=t.toString(),n=0;for(;n<M(s);){const t=s.charAt(n);if(" "!==t&&"\t"!==t&&"\r"!==t&&"\n"!==t&&"."!==t){s=s.substr(0,n)+s.substr(n,1).toUpperCase()+s.substr(n+1);break}n++}e+=(0===n?" ":"")+s}else e=t.replace(/(^|[\s`~!@#$%^&+\-*=_()[\]{};:'"\\|,<.>\/?])[^\s`~!@#$%^&+\-*=_()[\]{};:'"\\|,<.>\/?]/g,(t=>t.toUpperCase()));return e}),{replace:!0}),r(h(e,"."))}return""},t.trim=s,t.trimLeft=function(t){return T(t)?t.replace(/(^\s*)/g,""):""},t.trimRight=n,t.trimMultiple=i,t.sanitize=r,t.removeWhitespaces=function(t){return T(t)?t.replace(/\s/g,""):""},t.limit=a,t.replace=o,t.replaceMultiple=function(t,e,s,n){return t=K(t),X(e,(e=>{t=o(t,e,s,n)})),t},t.makeHTMLSafe=function(t){return K(t).replace(/[<>]/g,(t=>"<"===t?"&lt;":"&gt;"))},t.CRLFToHTML=function(t){return K(t).replace(/(\r\n|[\r\n])/g,"<br />")},t.iterateToString=h,t.extract=function(t,s){const n=K(s.left);if(t=K(t),T(n)){const i=(s.ignoreCase?e(t):t).indexOf(s.ignoreCase?e(n):n);if(-1!==i&&""!==(t=t.substr(i+M(n)))){const n=T(s.right)?s.fromEnd?(s.ignoreCase?e(t):t).lastIndexOf(s.ignoreCase?e(s.right):s.right):(s.ignoreCase?e(t):t).indexOf(s.ignoreCase?e(s.right):s.right):M(t);if(-1!==n)return t.substr(0,n)}}return""},t.fill=function(t,e){let s="";for(t=K(t),e=j(e);e>0;)s+=t,e--;return s},t.padLeft=function(t,e,s,n,i){let r=K(i||E(t)?j(t):t);if(w(e)&&E(s)&&M(e)>=1){let a,o="";if(a=(i||E(t))&&"-"===r.charAt(0),n&&M(r)>s)return r.substr(M(r)-s);if(M(r)>=s)return r;a&&(r=r.substr(1));do{o+=e}while(M(o)<s);return(a?"-":"")+(o+r).substr(M(o+r)+(a?1:0)-s)}return r},t.padRight=function(t,e,s,n){let i=K(t);if(w(e)&&E(s)&&M(e)>=1){if(i=K(i),n&&M(i)>s)return a(i,s);if(M(i)>=s)return i;for(;M(i)<s;)i=a(i+e,s)}return i},t.djb2Hash=function(t,e=""){const s=M(t);let n=0,i=5381;for(;n<s;)i=33*i^t.charCodeAt(n),n++;return e+(i>>>0).toString(36)}}(e||(e={}));class n{constructor(t){this.m_fnScheduler=t,this.m_pStack=[],this.m_nCall=0,this.m_nOffset=0}call(){const t=this.m_pStack.length;for(let e=0;e<t;e++){const t=this.m_pStack[e];t&&t.callee&&t.callee(...t.arguments)}this.m_pStack.splice(0,t),this.m_pStack.length>0?(this.m_nOffset=this.m_nCall-this.m_pStack.length+1,this.m_fnScheduler((()=>this.call()))):this.m_nOffset=0}schedule(t,...e){return t?(this.m_nCall++,this.m_pStack.push({callee:t,arguments:e}),0===this.m_nOffset&&(this.m_nOffset=this.m_nCall,this.m_fnScheduler((()=>this.call()))),this.m_nCall):0}cancel(t){this.m_nOffset>0&&t>=this.m_nOffset&&t<=this.m_nCall&&(this.m_pStack[t-this.m_nOffset]=void 0)}}class i{constructor(){this.m_nEnumerator=0}static get n(){return this.m_nEnumerator===Number.MAX_VALUE&&(this.m_nEnumerator=0),++this.m_nEnumerator}get n(){return this.m_nEnumerator===Number.MAX_VALUE&&(this.m_nEnumerator=0),++this.m_nEnumerator}set n(t){t>this.m_nEnumerator&&t<=Number.MAX_VALUE&&(this.m_nEnumerator=t)}static recycle(){this.m_nEnumerator=Number.MAX_VALUE}recycle(){this.m_nEnumerator=Number.MAX_VALUE}}i.m_nEnumerator=0;const r="undefined"!=typeof process&&process&&process.nextTick?t=>{process.nextTick(t)}:"undefined"!=typeof Promise&&Promise?t=>{Promise.resolve().then(t)}:t=>{setTimeout(t,0)},a="undefined"!=typeof Promise&&Promise?t=>{Promise.resolve().then(t)}:"undefined"!=typeof process&&process&&process.nextTick?t=>{process.nextTick(t)}:t=>{setTimeout(t,0)},o="undefined"!=typeof requestAnimationFrame?t=>requestAnimationFrame(t)||0:t=>setTimeout(t,1e3/60)||0,h=(t,e=0)=>setTimeout(t,e)||0,l=(t,e=0)=>setInterval(t,e)||0,u="undefined"!=typeof window,c="undefined"==typeof window&&"undefined"!=typeof process,m="undefined"!=typeof self&&"function"==typeof postMessage,p=new n(r),d=new n(o),g=new n(a),f={},_=new i;class b{static get now(){return Date.now()}static get precise(){return"undefined"!=typeof performance&&performance.now?performance.now():Date.now()}static get UTC(){return this.now-60*(new Date).getTimezoneOffset()*1e3}static get today(){const t=new Date;return t.setHours(0),t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0),t.getTime()}static get UTCToday(){const t=new Date,e=new Date;return e.setUTCFullYear(t.getFullYear()),e.setUTCMonth(t.getMonth()),e.setUTCDate(t.getDate()),e.setUTCHours(0),e.setUTCMinutes(0),e.setUTCSeconds(0),e.setUTCMilliseconds(0),e.getTime()}static isFuture(t){return this.now<t}static isPast(t){return this.now>=t}static elapsed(t,e=!1){return(W(e)?this.precise:this.now)-t}static timerReset(){const t=this.m_nStamp;return this.m_nStamp=this.precise,t}static get timerElapsed(){return this.precise-this.timerReset()}static get timerStamp(){return this.formatElapsed()}static format(t="dd-MM-yyyy HH:mm:ss.SSS",s=this.now,n=!1,i){const r=new Date(s);return e.sanitize(t.replace(/('[^']+')|('')|(HH)|(H)|(hh)|(h)|(mm)|(m)|(ss)|(s)|(SSS)|(S)|(zzzz)|(z)|(dd)|(d)|(MMMMM)|(MMMM)|(MMM)|(MM)|(M)|(LLLLL)|(LLLL)|(LLL)|(EEEEE)|(EEEE)|(EEE)|(EE)|(E)|(ccccc)|(cccc)|(ccc)|(cc)|(yyyy)|(yy)|(y)|(a)/g,(t=>{switch(t){case"HH":return e.padLeft(K(n?r.getUTCHours():r.getHours()),"0",2);case"H":return K(n?r.getUTCHours():r.getHours());case"hh":return e.padLeft(K(((n?r.getUTCHours():r.getHours())+11)%12+1),"0",2);case"h":return K(((n?r.getUTCHours():r.getHours())+11)%12+1);case"a":return i?K((n?r.getUTCHours():r.getHours())>=12?i.PM:i.AM):"";case"mm":return e.padLeft(K(n?r.getUTCMinutes():r.getMinutes()),"0",2);case"m":return K(n?r.getUTCMinutes():r.getMinutes());case"ss":return e.padLeft(K(n?r.getUTCSeconds():r.getSeconds()),"0",2);case"s":return K(n?r.getUTCSeconds():r.getSeconds());case"SSS":return e.padLeft(K(n?r.getUTCMilliseconds():r.getMilliseconds()),"0",3);case"S":return K(n?r.getUTCMilliseconds():r.getMilliseconds());case"z":case"zzzz":return"";case"dd":return e.padLeft(K(n?r.getUTCDate():r.getDate()),"0",2);case"d":return K(n?r.getUTCDate():r.getDate());case"yyyy":case"y":return K(n?r.getUTCFullYear():r.getFullYear());case"yy":return e.padLeft(K(n?r.getUTCFullYear():r.getFullYear()),"0",2,!0);case"MMMMM":return K(R(i?i.monthsFormattedNarrow:void 0,n?r.getUTCMonth():r.getMonth(),"?"));case"MMMM":return K(R(i?i.monthsFormattedWide:void 0,n?r.getUTCMonth():r.getMonth(),"?"));case"MMM":return K(R(i?i.monthsFormattedAbbreviated:void 0,n?r.getUTCMonth():r.getMonth(),"?"));case"MM":return e.padLeft(K((n?r.getUTCMonth():r.getMonth())+1),"0",2);case"M":return K((n?r.getUTCMonth():r.getMonth())+1);case"LLLLL":return K(R(i?i.monthsNominativeNarrow:void 0,n?r.getUTCMonth():r.getMonth(),"?"));case"LLLL":return K(R(i?i.monthsNominativeWide:void 0,n?r.getUTCMonth():r.getMonth(),"?"));case"LLL":return K(R(i?i.monthsNominativeAbbreviated:void 0,n?r.getUTCMonth():r.getMonth(),"?"));case"EEEEE":return K(R(i?i.weekdaysFormattedNarrow:void 0,n?r.getUTCDay():r.getDay(),"?"));case"EEEE":return K(R(i?i.weekdaysFormattedWide:void 0,n?r.getUTCDay():r.getDay(),"?"));case"EEE":return K(R(i?i.weekdaysFormattedAbbreviated:void 0,n?r.getUTCDay():r.getDay(),"?"));case"EE":return K(R(i?i.weekdaysFormattedShort:void 0,n?r.getUTCDay():r.getDay(),"?"));case"E":return K(n?r.getUTCDay():r.getDay());case"ccccc":return K(R(i?i.weekdaysNominativeNarrow:void 0,n?r.getUTCDay():r.getDay(),"?"));case"cccc":return K(R(i?i.weekdaysNominativeWide:void 0,n?r.getUTCDay():r.getDay(),"?"));case"ccc":return K(R(i?i.weekdaysNominativeAbbreviated:void 0,n?r.getUTCDay():r.getDay(),"?"));case"cc":return K(R(i?i.weekdaysNominativeShort:void 0,n?r.getUTCDay():r.getDay(),"?"));case"''":return"'"}return t.replace(/'/g,"")})))}static formatElapsed(s="H'h':mm'm':ss's'.SSS'ms'.uuu'µs'",n,i,r){let a,o,h,l,u,c;return n=t.conform(q(n,this.timerElapsed),3),a=Math.floor(n/36e5),o=Math.floor(n%36e5/6e4),h=Math.floor(n%36e5%6e4/1e3),c=K(t.conform(n%36e5%6e4%1e3,3)).split("."),l=c[0],u=B(c)>=2?c[1]:"0",e.sanitize(s.replace(/('[^']+')|('')|(HH)|(H)|(hh)|(h)|(mm)|(m)|(ss)|(s)|(SSS)|(S)|(uuu)|(u)|(zzzz)|(z)|(dd)|(d)|(MMMMM)|(MMMM)|(MMM)|(MM)|(M)|(LLLLL)|(LLLL)|(LLL)|(EEEEE)|(EEEE)|(EEE)|(EE)|(E)|(ccccc)|(cccc)|(ccc)|(cc)|(yyyy)|(yy)|(y)|(a)/g,(t=>{switch(t){case"HH":return e.padLeft(K(a),"0",2);case"H":return K(a);case"hh":return e.padLeft(K((a+11)%12+1),"0",2);case"h":return K((a+11)%12+1);case"a":return K(a>=12?r:i);case"mm":return e.padLeft(K(o),"0",2);case"m":return K(o);case"ss":return e.padLeft(K(h),"0",2);case"s":return K(h);case"SSS":return e.padLeft(l,"0",3);case"S":return l;case"uuu":return e.padLeft(u,"0",3);case"u":return u;case"z":case"zzzz":return"";case"''":return"'"}return t.replace(/'/g,"")})))}static get log(){return this.format("dd-MM-yyyy HH:mm:ss.SSS")}static get logTime(){return this.format("HH:mm:ss.SSS")}constructor(t=new Date){t instanceof b?this.m_pDate=new Date(t.time):N(t)?this.m_pDate=new Date(t.getTime()):this.m_pDate=new Date(t)}get date(){return this.m_pDate}get time(){return this.date.getTime()}set time(t){this.m_pDate=new Date(t)}}function y(){}function v(t){return void 0===t}function k(t){return!v(t)}function S(t){return v(t)||"object"==typeof t&&null===t}function C(t){return"object"==typeof t&&null!==t&&!F(t)}function x(t){return"function"==typeof t}function w(t){return"string"==typeof t}function M(t){return w(t)?t.length:0}function T(t){return M(t)>0}function I(t){return"number"==typeof t&&!isNaN(t)}function E(t,e,s){return"number"==typeof t&&isFinite(t)&&("number"!=typeof e||t>=e)&&("number"!=typeof s||t<=s)}function P(t,e,s){return"number"==typeof t&&isFinite(t)&&t%1!=0&&("number"!=typeof e||t>=e)&&("number"!=typeof s||t<=s)}function A(t){return"boolean"==typeof t}function F(t){return Array.isArray(t)}function O(t){return(C(t)||F(t)||x(t))&&"number"==typeof t.length&&"function"==typeof t.item}function L(t){return F(t)||O(t)}function B(t){return F(t)||O(t)?t.length:C(t)?B(Object.keys(t)):0}function R(t,e,s){if(e=j(e),t)if(F(t)){if(e>=0&&e<B(t))return t[e]}else if(O(t)){if(e>=0&&e<B(t))return t.item(e)}else if(C(t)){const s=Object.keys(t);if(e>=0&&e<B(s))return t[s[e]]}return k(s)?s:void 0}function H(t,e){if(t)if(F(t)){if(B(t)>0)return t[0]}else if(O(t)){if(B(t)>0)return t.item(0)}else if(C(t)){const e=Object.keys(t);if(B(e)>0)return t[e[0]]}return k(e)?e:void 0}function V(t,e){if(t)if(F(t)){const e=B(t);if(e>0)return t[e-1]}else if(O(t)){const e=B(t);if(e>0)return t.item(e-1)}else if(C(t)){const e=Object.keys(t),s=B(e);if(s>0)return t[e[s-1]]}return k(e)?e:void 0}function N(t){return C(t)&&"[object Date]"===Object.prototype.toString.call(t)}function D(t){return C(t)&&"[object RegExp]"===Object.prototype.toString.call(t)}function z(t){return t instanceof Error}function U(t){return t instanceof Promise||C(t)&&"function"==typeof t.then&&"function"==typeof t.catch&&"function"==typeof t.finally}function G(t,e){if(S(t))throw new Error(e||"Assert failed!");return t}function $(t){return t}function K(t,e){return w(t)?t:k(t)&&!S(t)&&x(t.toString)?t.toString():w(e)?e:""}function j(t,e){if(E(t))return Math.round(t);if(A(t))return t?1:0;if(k(t)&&!S(t)&&x(t.toString)){const e=parseFloat(t.toString().replace(/[^-e\d.]/g,""));if(E(e))return Math.round(e)}return E(e)?Math.round(e):0}function q(t,e){if(E(t))return parseFloat(`${t}`);if(A(t))return t?1:0;if(k(t)&&!S(t)&&x(t.toString)){const e=parseFloat(t.toString().replace(/[^-e\d.]/g,""));if(E(e))return e}return E(e)?e:0}function W(t,e){if(A(t))return t;if(E(t))return!!t;if(k(t)&&!S(t)&&x(t.toString)){const e=t.toString();return!("0"===e||"false"===e.toLowerCase())}return!!e}function J(t){return Object.create(t)}function Y(t,...e){const s=t;return X(e,(t=>{X(t,((t,e)=>{C(t)&&C(s[e])?Y(s[e],t):s[e]=t}),{keys:!0})})),s}function Z(...t){const e={};return X(t,(t=>{X(t,((t,s)=>{C(t)&&C(e[s])?e[s]=Z(e[s],t):e[s]=t}),{keys:!0})})),e}function Q(t,e,s){if(C(t)||F(t)){let n,i,r=!1,a=!1;if(C(t)!==C(e)||F(t)!==F(e))return!1;if(O(t)?r=!0:F(t)||(n=Object.keys(t)),O(e)?a=!0:F(e)||(i=Object.keys(e)),r!==a||F(n)!==F(i)||(n||t).length!==(i||e).length)return!1;const o=(n||t).length;for(let h=0;h<o;h++){const o=n?n[h]:h,l=i?i[h]:h;if(o!==l||!Q(r?t.item(o):t[o],a?e.item(l):e[l],s))return!1}return!0}return!(typeof t!=typeof e||S(t)!==S(e)||s&&t!==e)}function X(t,e,s){if(t&&e){const n=s&&s.arguments?s.arguments:void 0,i=!(!s||!s.replace);let r;if(r=s&&s.keys?n?(t,s)=>e(t,s,...n):(t,s)=>e(t,s):n?t=>e(t,...n):t=>e(t),F(t))t.forEach(((e,s)=>{const n=r(e,s);i&&(t[s]=n)}));else if(O(t)){const e=t,s=e.length;for(let t=0;t<s;t++)r(e.item(t),t)}else{Object.keys(t).forEach((e=>{const s=r(t[e],e);i&&(t[e]=s)}))}}return t}function tt(t,e,s){if(t){let r,a;O(t)?r=t:F(t)||(a=Object.keys(t));for(let o=(a||r||t).length-1;o>=0;o--){const h=mt(e,...(n=a?a[o]:o,i=s&&s.arguments?s.arguments.slice(0):[],s&&s.keys&&i.unshift(n),w(n)?i.unshift(t[n]):r?i.unshift(r.item(n)):i.unshift(t[n]),i));s&&s.replace&&!r&&(a?t[a[o]]=h:t[o]=h)}}var n,i;return t}function et(t,e,...s){const n=[];if(t){let a,o;O(t)?a=t:F(t)||(o=Object.keys(t));const h=(o||a||t).length;for(let l=0;l<h;l++)n.push(mt(e,...(i=o?o[l]:l,r=s.slice(0),w(i)?r.unshift(t[i]):a?r.unshift(a.item(i)):r.unshift(t[i]),r)))}var i,r;return n}function st(t,e,s,...n){if(t){let a,o;O(t)?a=t:F(t)||(o=Object.keys(t));const h=(o||a||t).length;for(let l=0;l<h;l++)s=mt(e,...(i=o?o[l]:l,r=n.slice(0),w(i)?r.unshift(t[i]):a?r.unshift(a.item(i)):r.unshift(t[i]),r.unshift(s),r))}var i,r;return s}function nt(t,e,s=!1){if(t){let n,i;O(t)?n=t:F(t)||(i=Object.keys(t));const r=(i||n||t).length;for(let a=0;a<r;a++){let r=!1;if(r=W(mt(e,i?t[i[a]]:n?n.item(a):t[a])),s===r)return s}return!s}return!1}function it(t,e){return nt(t,e,!1)}function rt(t,e){return nt(t,e,!0)}function at(t,e){let s=0;if(t){let n,i;O(t)?n=t:F(t)||(i=Object.keys(t));const r=(i||n||t).length;for(let a=0;a<r;a++){let r=!0;x(e)&&(r=W(mt(e,i?t[i[a]]:n?n.item(a):t[a]))),r&&s++}}return s}function ot(t,e,s){const n=!(!s||"first"!==s.return),i=!(!s||"last"!==s.return);let r;if(s&&s.return&&"matches"!==s.return||(r=[]),t){let h,l;O(t)?h=t:F(t)||(l=Object.keys(t));const u=(l||h||t).length;for(let c=i?u-1:0;i&&c>=0||!i&&c<u;i?c--:c++){let u=!0;if(u=W(mt(e,l?t[l[c]]:h?h.item(c):t[c])),u){if(s&&x(s.do)){const e=mt(s.do,...(a=l?l[c]:c,o=s&&s.arguments?s.arguments.slice(0):[],w(a)?o.unshift(t[a]):h?o.unshift(h.item(a)):o.unshift(t[a]),o));s&&s.replace&&!h&&(l?t[l[c]]=e:t[c]=e)}if(n||i)return l?t[l[c]]:h?h.item(c):t[c];r&&(l?r.push(t[l[c]]):h?r.push(h.item(c)):r.push(t[c]))}}}var a,o;return r}function ht(t,e){return ot(t,e)}function lt(t,e){return ot(t,e,{return:"first"})}function ut(t,e){return ot(t,e,{return:"last"})}function ct(t,e){if(t){let s,n;O(t)?s=t:F(t)||(n=Object.keys(t));const i=(n||s||t).length;for(let r=0;r<i;r++){let i=!0;if(i=W(mt(e,n?t[n[r]]:s?s.item(r):t[r])),i)return n?n[r]:r}}}function mt(t,...e){if(t)return t(...e)}function pt(t,...e){p.schedule(t,...e)}function dt(t,...e){g.schedule(t,...e)}function gt(t,e,...s){e?mt(t,...s):pt(t,...s)}function ft(t,e,...s){if(t&&e)return t.bind(e)(...s)}function _t(t,...e){if(x(t))return t(...e)}function bt(t,...e){return p.schedule(t,...e)}function yt(t,e,...s){return vt(e),bt(t,...s)}function vt(t){return p.cancel(t),0}function kt(t,...e){return g.schedule(t,...e)}function St(t,e,...s){return Ct(e),kt(t,...s)}function Ct(t){return g.cancel(t),0}function xt(t,...e){return d.schedule(t,...e)}function wt(t,e,...s){return Mt(e),xt(t,...s)}function Mt(t){return d.cancel(t),0}function Tt(t,e,...s){return h((()=>t(...s)),e)}function It(t){return 0!==t&&clearTimeout(t),0}function Et(t,e,...s){const n=_.n+1,i=K(n),r=b.precise,a=()=>{f[i]&&(b.elapsed(r,!0)>=e?(f[i](...s),qt(f,i)):xt(a))};return f[i]=t,xt(a),n}function Pt(t){return 0!==t&&qt(f,K(t)),0}function At(t,e,...s){return l((()=>t(...s)),e)}function Ft(t){return 0!==t&&clearInterval(t),0}function Ot(t,e,...s){const n=_.n+1,i=K(n);let r=b.precise;const a=()=>{f[i]&&(b.elapsed(r,!0)>=e&&(f[i](...s),r=b.precise),xt(a))};return f[i]=t,xt(a),n}function Lt(t){return 0!==t&&qt(f,K(t)),0}function Bt(t,e,...s){t&&(e>0?xt((()=>Bt(t,--e,...s))):t(...s))}function Rt(t,...e){Bt(t,2,...e)}function Ht(t,...e){Bt(t,2,...e)}function Vt(t,...e){Bt(t,5,...e)}function Nt(t,e,s){return t[e]=s}function Dt(t,e,s){return(C(t)||x(t))&&T(e)?t[e]=s:s}function zt(t,e){return t[e]}function Ut(t,e){if(t&&T(e))return t[e]}function Gt(t,e,s=!1){return W(Ut(t,e),s)}function $t(t,e,s=""){return K(Ut(t,e),s)}function Kt(t,e,s=0){return j(Ut(t,e),s)}function jt(t,e,s=0){return q(Ut(t,e),s)}function qt(t,e){return!!(t&&T(e)&&k(t[e]))&&delete t[e]}function Wt(t,...e){return new t(...e)}b.m_nStamp=0;var Jt,Yt;!function(t){function s(){return e.padRight(b.logTime," ",16,!0)}function n(t){return e.padRight(t," ",23,!0)}t.time=s,t.module=n,t.log=function(t,e){return s()+n(t)+e}}(Jt||(Jt={})),function(t){t.isBrowser=u,t.isNode=c,t.isWebWorker=m}(Yt||(Yt={}));class Zt{constructor(){this.m_nFlag=1}get flag(){const t=this.m_nFlag;return this.m_nFlag=this.m_nFlag<<1,t}static convert(...t){let e=1;return st(t,((t,s)=>(t|=s?e:0,e*=2,t)),0)||0}static has(t,e){let s=1;if(e>0)for(;--e;)s*=2;return W(t&s)}}class Qt{constructor(t,e,s){this.m_pArguments=[],this.m_nTime=0,this.m_nHandle=0,this.m_bPromise=!1,this.m_bFrame=!1,this.m_bDoubleFrame=!1,this.m_sHold=!1,this.m_bThrottle="debounce"!==t,this.m_bDelay="throttle-delay"===t,this.m_fnCallback=e,this.m_nTimeout="tick"!==s&&"promise"!==s&&"frame"!==s&&"double-frame"!==s&&s||0,this.m_bPromise="promise"===s,this.m_bFrame="frame"===s||"double-frame"===s,this.m_bDoubleFrame="double-frame"===s}call(){this.m_nHandle=0,this.m_fnCallback(...this.m_pArguments)}invoke(...t){if(!this.m_sHold&&this.m_bThrottle&&this.m_nTimeout>0){if(!this.m_bDelay)return void(b.elapsed(this.m_nTime,!0)>=this.m_nTimeout&&(this.m_pArguments=t,this.m_nTime=b.precise,this.call()));0!==this.m_nHandle&&b.elapsed(this.m_nTime,!0)>=this.m_nTimeout&&(this.cancel(),this.call())}this.m_pArguments=t,this.m_bThrottle||this.cancel(),this.m_sHold?this.m_sHold="hold":0===this.m_nHandle&&(this.m_nTime=b.precise,this.m_nTimeout>0?this.m_nHandle=Tt((()=>this.call()),this.m_nTimeout):this.m_bPromise?this.m_nHandle=kt((()=>this.call())):this.m_bFrame?this.m_nHandle=xt((()=>{this.m_bDoubleFrame?this.m_nHandle=xt((()=>this.call())):this.call()})):this.m_nHandle=bt((()=>this.call())))}cancel(){const t=this.m_nTimeout>0?It:this.m_bPromise?Ct:this.m_bFrame?Mt:vt;this.m_nHandle=t(this.m_nHandle)}flush(){this.m_sHold=!1,0!==this.m_nHandle&&(this.cancel(),this.call())}hold(){this.m_sHold=this.m_sHold||(0===this.m_nHandle?"catch":"hold"),this.cancel()}release(t=!1){if(this.m_sHold){const e="hold"===this.m_sHold;this.m_sHold=!1,e&&(t?this.call():this.invoke(...this.m_pArguments))}}}class Xt extends Qt{constructor(t,e="frame",s=!0){super(s?"throttle-delay":"throttle",t,e)}}class te extends Qt{constructor(t,e="frame"){super("debounce",t,e)}}let ee=class{constructor(){this.m_pStack=[]}add(t){this.m_pStack.push(t)}flush(){const t=this.m_pStack.length;for(let e=0;e<t;e++)this.m_pStack[e]()}clear(){this.m_pStack=[]}flushAndClear(){this.flush(),this.clear()}},se=!1;function ne(){se=!0}function ie(){se=!1}class re{constructor(){this.m_pHooks={},this.m_nHookTimeout=0,this.m_nHookFrame=0,this.m_nHookBuffer=0}get isHookBufferEnabled(){return this.m_nHookBuffer>0}getHooks(t){const e=this.m_pHooks[t];if(e)return e}prepareHookPayload(t,e,s){return t.hook={name:e,type:s},t}scheduleHook(t){"framed"===t?this.m_nHookFrame=wt((()=>this.invokeHook(t)),this.m_nHookFrame):this.m_nHookTimeout=yt((()=>this.invokeHook(t)),this.m_nHookTimeout)}invokeHook(t){const e=new ee;X(this.m_pHooks,((s,n)=>{X(s,(s=>{s.type===t&&X(s.payloads.splice(0,s.payloads.length),(t=>{e.add((()=>s.hook(this.prepareHookPayload(t,n,s.type))))}))}))}),{keys:!0}),e.flush()}attachHook(t,e,s,n,i){(this.getHooks(t)||(this.m_pHooks[t]=[])).push({hook:s,payloads:[],type:e,group:n,context:i})}hook(t,e,s,n){return this.attachHook(t,e,s,!1,n),this}groupedHook(t,e,s,n){return this.attachHook(t,e,s,!0,n),this}emitHook(t,e,s="fifo"){const n=this.getHooks(t);if(n){const i=new ee;return X(n,(n=>{"synchronous"!==n.type||this.isHookBufferEnabled?(n.group&&n.payloads.length>0?n.payloads[0]=e:"lifo"===s?n.payloads.splice(0,0,e):n.payloads.push(e),"synchronous"===n.type||this.isHookBufferEnabled||this.scheduleHook(n.type)):i.add((()=>n.hook(this.prepareHookPayload(e,t,"synchronous"))))})),i.flush(),!0}return!1}bufferHooks(){this.m_nHookTimeout=vt(this.m_nHookTimeout),this.m_nHookFrame=Mt(this.m_nHookFrame),this.m_nHookBuffer++}flushHooks(){if(this.m_nHookBuffer>0&&(this.m_nHookBuffer--,0===this.m_nHookBuffer)){const t=new ee;X(this.m_pHooks,((e,s)=>{X(e,(e=>{"synchronous"===e.type?X(e.payloads.splice(0,e.payloads.length),(n=>{t.add((()=>e.hook(this.prepareHookPayload(n,s,e.type))))})):this.scheduleHook(e.type)}))}),{keys:!0}),t.flush()}}unhook(t,e){const s=this.getHooks(t);if(s){let n=!1;if(e){let t=s.length;for(;t--;){const i=s[t];i.context!==e&&i.hook!==e||(s.splice(t,1),n=!0)}}return e&&0!==s.length?n:(qt(this.m_pHooks,t),!0)}return!1}unhookContext(t){let e=!1;return X(this.m_pHooks,((s,n)=>{let i=s.length;for(;i--;){s[i].context===t&&(s.splice(i,1),e=!0)}0===s.length&&qt(this.m_pHooks,n)}),{keys:!0}),e}destroy(){const t=new ee;this.m_nHookTimeout=vt(this.m_nHookTimeout),this.m_nHookFrame=Mt(this.m_nHookFrame),this.m_nHookBuffer=0,X(this.m_pHooks,((e,s)=>{X(e,(e=>{X(e.payloads.splice(0,e.payloads.length),(n=>{t.add((()=>e.hook(this.prepareHookPayload(n,s,e.type))))}))}))}),{keys:!0}),this.m_pHooks={},t.flush()}}function ae(t,e,s,n,i="multiple"){if(!n||!x(n.value))throw new Error(`The '@${t}' decorator can only be applied to a method but '${String(s)}' seems to be a property.`);const r=`@marker @${t}`,a=`@marker @${t} #${String(s)}`,o=Object.getOwnPropertyDescriptor(e,r);if(Object.getOwnPropertyDescriptor(e,a))throw new Error(`Decorator '@${t}' is already applied to the method '${String(s)}'.`);if("single"===i&&o)throw new Error(`Decorator '@${t}' is already used in this class, but can only be applied once.`);Object.defineProperty(e,a,{value:!0,writable:!1,enumerable:!1,configurable:!1}),o?o.value.push(n.value):Object.defineProperty(e,r,{value:[n.value],writable:!1,enumerable:!1,configurable:!1})}function oe(t,e,...s){const n=Ut(e,`@marker @${t}`);if(n){const t=n.length;if(1===t)return ft(n[0],e,...s);for(let i=0;i<t;i++)ft(n[i],e,...s)}}function he(t,e,s,n,i){const r={target:e,property:s,oldValue:n,newValue:i};X(Ut(e,t),(t=>{ft(t,e,r)}))}function le(t,e,s,n,i){const r=`@observers #${String(s)}`,a=Object.getOwnPropertyDescriptor(e,r),o=`@observers @${t} #${String(s)}`;if(Object.getOwnPropertyDescriptor(e,o))throw new Error(`Decorator '@${t}' is already applied to the property '${String(s)}'.`);if(Object.defineProperty(e,o,{value:!0,writable:!1,enumerable:!1,configurable:!1}),a&&F(a.value))a.value.push(i);else{if(n){if(n.configurable=!1,!n.set)throw new Error(`Decorator '@${t}' can only be used on writable properties, but '${String(s)}' seems to be a readonly property or a method.`);{const t=n.set;n.set=function(e){const n=Ut(this,s);n!==e&&(t.call(this,e),he(r,this,s,n,e))}}}else{const t=`@observable #${String(s)}`;Object.defineProperty(e,s,{get:function(){return Ut(this,t)},set:function(e){const n=Ut(this,t);n!==e&&(Dt(this,t,e),he(r,this,s,n,e))},enumerable:!0,configurable:!1})}Object.defineProperty(e,r,{value:[i],writable:!1,enumerable:!1,configurable:!1})}}function ue(t){return(e,s,n)=>{le("hookup",e,s,n,(e=>{e.target.emitHook(t,{property:e.property,value:e.newValue})}))}}let ce=class{constructor(){this.m_pStack=[]}push(t){this.m_pStack.push(t)}flush(){let t=this.m_pStack.shift();for(;t;)t(),t=this.m_pStack.shift()}};class me extends re{constructor(t=0,e=0,s=1){super(),this.m_nCurrentCount=0,this.m_pCursor={column:0,row:0,index:0},this.m_bSilent=!1,this.m_pItems=[],this.m_nUniqueId=me.enumerator.n,this.m_nType=t,this.m_nOrientation=e,this.m_nColumns=this.m_nCurrentColumns=0===this.type?Math.max(s,1):0,this.m_nRows=this.m_nCurrentRows=1===this.type?Math.max(s,1):0}get uniqueId(){return this.m_nUniqueId}get type(){return this.m_nType}set type(t){this.m_nType!==t&&(this.m_nType=t,this.recalculate(new ce,0,"change",-1,32).flush())}get orientation(){return this.m_nOrientation}set orientation(t){if(this.m_nOrientation!==t){const e=new ce;this.m_nOrientation=t,this.reindex(e,0,-1,"change",-1,32),e.flush()}}get columns(){return this.m_nColumns}set columns(t){this.m_nType=0,t!==this.m_nColumns&&(this.m_nColumns=Math.max(t,1),this.recalculate(new ce,0,"change",-1,32).flush())}get rows(){return this.m_nRows}set rows(t){this.m_nType=1,t!==this.m_nRows&&(this.m_nRows=Math.max(t,1),this.recalculate(new ce,0,"change",-1,32).flush())}get count(){return this.m_pItems.length}get all(){return this.m_pItems}get currentItem(){return this.itemAtIndex(this.safeCursor.index)}get firstItem(){return this.itemAtIndex(0)}get lastItem(){return this.itemAtIndex(this.count-1)}get lastItemInFirstRow(){return this.lastItemInRow(0)}get lastItemInFirstColumn(){return this.lastItemInColumn(0)}get cursor(){return this.m_pCursor}set cursor(t){const e=this.m_pCursor.column,s=this.m_pCursor.row;this.m_pCursor=this.getSafeCursor(t),this.m_pCursor.column===e&&this.m_pCursor.row===s||this.isSilent||this.onCursorChange({matrix:this,cursor:this.cursor})}get safeCursor(){return this.m_pCursor}get isCursorAtFirstColumn(){return 0===this.cursor.column}get isCursorAtLastColumn(){return this.cursor.column===this.columns-1}get isCursorAtEndColumn(){return this.cursor.column===this.columns}get isCursorAtFirstRow(){return 0===this.cursor.row}get isCursorAtLastRow(){return this.cursor.row===this.rows-1}get isCursorAtEndRow(){return this.cursor.row===this.rows}get isCursorAtFirst(){return 0===this.cursor.index}get isCursorAtLast(){return this.cursor.index===this.count-1}get isCursorAtEnd(){return this.cursor.index===this.count}get isSilent(){return x(this.m_bSilent)?this.m_bSilent():this.m_bSilent}set isSilent(t){this.m_bSilent=t}isValidIndex(t,e=!1){return E(t)&&t>=0&&t<this.count+(e?1:0)}reindex(e,s,n,i,r,a){let o=!1;for(s=t.max(s,0),n=this.isValidIndex(n)?n+1:this.count,r=this.isValidIndex(r)?r:-1,this.isSilent&&(i="nothing");s<n;)o=this.m_pItems[s].reindex(e,this,s,"nothing"!==i?r===s?i:"auto":"nothing",a)||o,s++;return o}recalculate(t,e,s,n,i){const r="nothing"!==s&&!this.isSilent,a=this.count;switch(this.m_nType){case 0:0===this.m_nColumns&&(this.m_nColumns=1),this.m_nRows=Math.max(Math.ceil(a/this.m_nColumns),a>0?1:0);break;case 1:0===this.m_nRows&&(this.m_nRows=1),this.m_nColumns=Math.max(Math.ceil(a/this.m_nRows),a>0?1:0);break;case 2:this.m_nColumns=this.m_nRows=Math.max(Math.ceil(Math.sqrt(a)),a>0?1:0);break;case 3:case 4:for(this.m_nColumns=this.m_nRows=Math.max(Math.floor(Math.sqrt(a)),a>0?1:0);this.m_nColumns*this.m_nRows<a;)for(3===this.m_nType?this.m_nColumns++:this.m_nRows++;this.m_nColumns*this.m_nRows<a;)4===this.m_nType?this.m_nColumns++:this.m_nRows++}return r&&(this.bufferHooks(),(1===this.m_nOrientation&&this.m_nColumns!==this.m_nCurrentColumns||0===this.m_nOrientation&&this.m_nRows!==this.m_nCurrentRows)&&(e=0),this.isValidIndex(e)&&this.reindex(t,e,a,s,n,i)),this.m_nColumns===this.m_nCurrentColumns&&this.m_nRows===this.m_nCurrentRows||((this.safeCursor.column>this.m_nColumns||this.safeCursor.row>this.m_nRows)&&(this.cursor={column:Math.min(this.safeCursor.column,this.m_nColumns),row:Math.min(this.safeCursor.row,this.m_nRows)}),r&&t.push((()=>{this.onDimensionChange({matrix:this,difference:this.m_nColumns*this.m_nRows-this.m_nCurrentColumns*this.m_nCurrentRows,columns:this.m_nColumns,rows:this.m_nRows,reason:i})})),this.m_nCurrentColumns=this.m_nColumns,this.m_nCurrentRows=this.m_nRows),a!==this.m_nCurrentCount&&(r&&t.push((()=>{this.onCountChange({matrix:this,difference:a-this.m_nCurrentCount,count:a,reason:i})})),this.m_nCurrentCount=a),r&&this.flushHooks(),t}getSafeCursor(t){if(!E(t.index)||t.index<0){const e=Math.min(Math.max(E(t.column)?t.column:this.columns,0),this.columns),s=Math.min(Math.max(E(t.row)?t.row:this.rows,0),this.rows);return{column:e,row:s,index:this.indexFromColumnRow(e,s)}}return this.cursorFromIndex(t.index)}onDimensionChange(t){this.emitHook("OnDimensionChange",t)}onCountChange(t){this.emitHook("OnCountChange",t)}onCursorChange(t){this.emitHook("OnCursorChange",t)}indexFromColumnRow(t,e){const s=t>=0&&t<this.columns&&e>=0&&e<this.rows?0===this.orientation?this.rows*t+e:this.columns*e+t:-1;return s>=0&&s<this.count?s:-1}cursorFromIndex(t){return{column:(t=Math.min(Math.max(t||0,0),this.count))<this.count?0===this.orientation?Math.floor(t/this.rows):t%this.columns:this.columns,row:t<this.count?0===this.orientation?t%this.rows:Math.floor(t/this.columns):this.rows,index:t}}pushToMatrix(t,e={index:void 0,recalculate:!0,emit:"push"}){const s=this.isSilent?"nothing":e.emit,n=W(e.recalculate,!0),i=new ce;let r,a;if(a=E(e.index)?e.index:t.index,!t.isPopped&&t.parent){if(this===t.parent)return this.isValidIndex(e.index,!0)&&t.moveToIndex(e.index),t;r=t.parent,t.popSilent()}if(this.isValidIndex(a)?this.m_pItems.splice(a,0,t):a=this.m_pItems.push(t)-1,"nothing"!==s&&this.bufferHooks(),n&&"nothing"!==s||t.reindex(i,this,a,s,1),n&&this.recalculate(i,a,s,a,1),"nothing"!==s){if(t.isFirst){const e=t.successorSibling;e&&(e.dispatch(i,{hook:"OnItemChange",payload:{matrix:this,matrixPrevious:r,item:e,reason:128}}),this.emitHook("OnItemChange",{matrix:this,matrixPrevious:r,item:e,reason:128}))}if(t.isLast){const e=t.predecessorSibling;e&&(e.dispatch(i,{hook:"OnItemChange",payload:{matrix:this,matrixPrevious:r,item:e,reason:64}}),this.emitHook("OnItemChange",{matrix:this,matrixPrevious:r,item:e,reason:64}))}}return i.flush(),"nothing"!==s&&this.flushHooks(),t}moveTo(t,e){return this.moveToIndex(t,this.getSafeCursor(e).index)}moveToIndex(t,e){if(this.isValidIndex(e,!0)&&t.index!==e){const s=new ce;return this.m_pItems.splice(e,0,this.m_pItems.splice(t.index,1)[0]),this.reindex(s,Math.min(t.index,e),Math.max(t.index,e),"change",-1,4),s.flush(),!0}return!1}moveToPosition(t,e,s){return this.moveToIndex(t,this.indexFromColumnRow(e,s))}moveToItem(t,e,s){return this.moveToIndex(t,e.index+(s?0:1)-(t.index<e.index?1:0))}moveUpOrDown(t,e){if(e&&!t.isFirstOfMatrix||!e&&!t.isLastOfMatrix){const s=new ce;return this.m_pItems[t.index]=this.m_pItems[t.index+(e?-1:1)],this.m_pItems[t.index+(e?-1:1)]=t,this.reindex(s,t.index-(e?1:0),t.index+(e?0:1),"change",-1,4),s.flush(),!0}return!1}swap(e,s){if(e.index!==s.index){const n=new ce;return this.m_pItems[e.index]=s,this.m_pItems[s.index]=e,this.reindex(n,t.min(e.index,s.index),t.max(e.index,s.index),"change",-1,8),n.flush(),!0}return!1}popFromMatrix(t,e=!0){let s=[],n=!1,i=!1;if(t||(t=this.itemAtIndex(this.count-1)),t&&(n=t.isFirst,i=t.isLast,this.isValidIndex(t.index)&&t===this.m_pItems[t.index]&&(s=this.m_pItems.splice(t.index,1))),1===s.length&&s[0]){const t=new ce,r=!!this.isSilent;if(s[0].dispatch(t,"Pop"),r||(this.bufferHooks(),e&&(s[0].dispatch(t,{hook:"OnItemPop",payload:{matrix:this,item:s[0]}}),this.emitHook("OnItemPop",{matrix:this,item:s[0]}))),this.recalculate(t,s[0].index,"change",-1,2),!r){if(n){const e=this.firstItem;e&&(e.dispatch(t,{hook:"OnItemChange",payload:{matrix:this,matrixPrevious:void 0,item:e,reason:128}}),this.emitHook("OnItemChange",{matrix:this,matrixPrevious:void 0,item:e,reason:128}))}if(i){const e=this.lastItem;e&&(e.dispatch(t,{hook:"OnItemChange",payload:{matrix:this,matrixPrevious:void 0,item:e,reason:64}}),this.emitHook("OnItemChange",{matrix:this,matrixPrevious:void 0,item:e,reason:64}))}}return t.flush(),r||this.flushHooks(),s[0]}}sort(t=((t,e)=>t.uniqueId-e.uniqueId)){this.m_pItems.sort(t);const e=new ce,s=this.reindex(e,0,-1,"change",-1,16);return e.flush(),s}clear(t="thorough"){const e=new ce;if("dirty"!==t){const s=this.count;for(let n=0;n<s;n++){const s=this.m_pItems[n];s.dispatch(e,"Pop"),this.isSilent||(s.dispatch(e,{hook:"OnItemPop",payload:{matrix:this,item:s}}),"thorough"===t&&this.emitHook("OnItemPop",{matrix:this,item:s})),s.dispatch(e,"Detach")}}this.m_pItems=[],"dirty"!==t&&("thorough"===t&&this.recalculate(e,0,"change",-1,2),e.flush())}invalidateMatrix(){this.onDimensionChange({matrix:this,difference:this.m_nColumns*this.m_nRows-this.m_nCurrentColumns*this.m_nCurrentRows,columns:this.columns,rows:this.rows,reason:32})}recalculateMatrix(){this.recalculate(new ce,0,"change",-1,32).flush()}each(t,e,s){const n=this.m_pItems.slice(e,E(s)&&s>=0?s+1:s),i=n.length;for(let e=0;e<i;e++){const s=t(n[e]);if(A(s)&&s)return!0}return!1}reverseEach(t,e,s){const n=this.m_pItems.slice(e,E(s)&&s>=0?s+1:s);for(let e=n.length-1;e>=0;e--){const s=t(n[e]);if(A(s)&&s)return!0}return!1}itemAtIndex(t){return this.isValidIndex(t)?this.m_pItems[t]:void 0}itemAtPosition(t,e){return this.itemAtIndex(this.indexFromColumnRow(t,e))}itemAtCursor(t){return this.itemAtIndex(this.getSafeCursor(t).index)}itemFromId(t){return lt(this.m_pItems,(e=>e.uniqueId===t))}lastItemInRow(t){let e,s=this.columns;for(;!e&&s>0;)e=this.itemAtPosition(--s,t);return e}lastItemInColumn(t){let e,s=this.rows;for(;!e&&s>0;)e=this.itemAtPosition(t,--s);return e}moveCursorToFirstColumn(t=!1){return this.cursor={column:0,row:t?0:this.safeCursor.row,index:-1}}moveCursorToSuccessorColumn(t=!1){return this.cursor={column:this.cursor.column+1,row:t?0:this.safeCursor.row,index:-1}}moveCursorToPredecessorColumn(t=!1){return this.cursor={column:this.cursor.column-1,row:t?0:this.safeCursor.row,index:-1}}moveCursorToLastColumn(t=!1){return this.cursor={column:this.columns-1,row:t?0:this.safeCursor.row,index:-1}}moveCursorToFirstRow(t=!1){return this.cursor={column:t?0:this.safeCursor.column,row:0,index:-1}}moveCursorToSuccessorRow(t=!1){return this.cursor={column:t?0:this.safeCursor.column,row:this.cursor.row+1,index:-1}}moveCursorToPredecessorRow(t=!1){return this.cursor={column:t?0:this.safeCursor.column,row:this.cursor.row-1,index:-1}}moveCursorToLastRow(t=!1){return this.cursor={column:t?0:this.safeCursor.column,row:this.rows-1,index:-1}}moveCursorToFirst(){return this.cursor={column:-1,row:-1,index:0}}moveCursorToSuccessor(){return this.cursor={column:-1,row:-1,index:this.safeCursor.index+1}}moveCursorToPredecessor(){return this.cursor={column:-1,row:-1,index:this.safeCursor.index-1}}moveCursorToLast(){return this.cursor={column:-1,row:-1,index:this.count-1}}moveCursorToEnd(){return this.cursor={column:-1,row:-1,index:this.count}}}me.enumerator=new i;const pe=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428],de=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],ge=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428],fe=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],_e=[2352822216,424955298,1944164710,2312950998,502970286,855612546,1738396948,1479516111,258812777,2077511080,2011393907,79989058,1067287976,1780299464,286451373,2446758561],be=[573645204,4230739756,2673172387,3360449730,596883563,1867755857,2520282905,1497426621,2519219938,2827943907,3193839141,1401305490,721525244,746961066,246885852,2177182882],ye=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],ve=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],ke="0123456789abcdef";function Se(t,e){return t>>>e|t<<32-e}function Ce(t,e,s,n){return Se(t,e)^Se(t,s)^t>>>n}function xe(t,e){return t[15&e]+=Ce(t[e+14&15],17,19,10)+t[e+9&15]+Ce(t[e+1&15],7,18,3)}function we(t,e){const s=(65535&t)+(65535&e);return(e=(t>>16)+(e>>16)+(s>>16))<<16|65535&s}function Me(t,e,...s){let n=0,i=0,r=0,a=0;for(;n<s.length/2;n++)i=s[n],r+=65535&i,a+=i>>>16;for(a+=r>>>16,t[e+1]=a<<16|65535&r,r=a>>>16,a=0;n<s.length;n++)i=s[n],r+=65535&i,a+=i>>>16;a+=r>>>16,t[e]=a<<16|65535&r}function Te(t,e){let s=0;const n=[],i=[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];for(;s<16;)n[s]=e[3+(s<<2)]|e[2+(s<<2)]<<8|e[1+(s<<2)]<<16|e[s<<2]<<24,s++;for(s=0;s<64;s++){const t=i[0],e=i[1],r=i[2],a=i[4],o=i[7]+(Se(a,6)^Se(a,11)^Se(a,25))+(a&i[5]^~a&i[6])+ye[s]+(s<16?n[s]:xe(n,s));for(let s=7;s>=0;s--)i[s]=4===s?we(i[3],o):0===s?we(o,(Se(t,2)^Se(t,13)^Se(t,22))+(t&e^t&r^e&r)):i[s-1]}for(s=0;s<8;s++)t[s]+=i[s]}function Ie(t,e,s){let n;try{n=unescape(encodeURIComponent(t))}catch(e){n=function(t){const e=t.length;let s="";for(let n=0;n<e;n++){const e=t.charCodeAt(n);if(e<128)s+=String.fromCharCode(e);else if(e<2048)s+=String.fromCharCode(192|e>>>6,128|63&e);else if(e<55296||e>=57344)s+=String.fromCharCode(224|e>>>12,128|e>>>6&63,128|63&e);else{const i=65536+((1023&e)<<10|1023&t.charCodeAt(++n));s+=String.fromCharCode(240|i>>>18,128|i>>>12&63,128|i>>>6&63,128|63&i)}}return s}(t)}const i=(e?224===s?_e:256===s?be:384===s?ge:fe:224===s?pe:de).slice(),r=n.length,a=[];let o,h,l="",u=0,c=!0,m=0,p=0,d=0,g=0,f=0;if(e){const t=[0,0,0,0,0,0,0,0],e=[24,16,8,0];let s;do{for(a[0]=u,o=1;o<=32;o++)a[o]=0;for(o=d;m<r&&o<128;++m){const t=n.charCodeAt(m);t<128?a[o>>2]|=t<<e[3&o++]:(a[o>>2]|=(192|t>>6)<<e[3&o++],a[o>>2]|=(128|63&t)<<e[3&o++])}for(p+=o-d,d=o-128,m===r&&(a[o>>2]|=[-2147483648,8388608,32768,128][3&o],++m),u=a[32],m>r&&o<112&&(a[31]=p<<3,c=!1),h=32;h<160;h+=2){const t=a[h-30],e=a[h-29],s=a[h-4],n=a[h-3];Me(a,h,a[h-13],a[h-31],(e>>>1|t<<31)^(e>>>8|t<<24)^(e>>>7|t<<25),(n>>>19|s<<13)^(s>>>29|n<<3)^(n>>>6|s<<26),a[h-14],a[h-32],(t>>>1|e<<31)^(t>>>8|e<<24)^t>>>7,(s>>>19|n<<13)^(n>>>29|s<<3)^s>>>6)}for(s=i.slice(),t[6]=s[2]&s[4],t[7]=s[3]&s[5],o=0;o<160;o+=8)for(h=0;h<8;h+=2){const e=h>0?8-h:0,n=[0,0,0,0];Me(n,0,ve[o+h+1],a[o+h+1],s[9+e]&s[2===h?9:11+e]^~s[9+e]&s[6===h?15:13-h],(s[9+e]>>>14|s[8+e]<<18)^(s[9+e]>>>18|s[8+e]<<14)^(s[8+e]>>>9|s[9+e]<<23),s[15-h],ve[o+h],a[o+h],s[8+e]&s[2===h?8:10+e]^~s[8+e]&s[6===h?14:12-h],(s[8+e]>>>14|s[9+e]<<18)^(s[8+e]>>>18|s[9+e]<<14)^(s[9+e]>>>9|s[8+e]<<23),s[14-h]),Me(n,2,(t[h+1]=s[1+e]&s[2===h?1:3+e])^s[1+e]&s[(6===h?h:4-h)+1]^t[7-e],(s[1+e]>>>28|s[e]<<4)^(s[e]>>>2|s[1+e]<<30)^(s[e]>>>7|s[1+e]<<25),(t[h]=s[e]&s[2===h?0:2+e])^s[e]&s[6===h?h:4-h]^t[6-e],(s[e]>>>28|s[1+e]<<4)^(s[1+e]>>>2|s[e]<<30)^(s[1+e]>>>7|s[e]<<25)),Me(s,14-h,s[7-h],n[1],s[6-h],n[0]),Me(s,6-h,n[3],n[1],n[2],n[0])}for(o=0;o<16;o+=2)Me(i,o,i[o+1],s[o+1],i[o],s[o])}while(c)}else{for(d=63&r,g=r<<3,f=r>>29,o=0;o+63<r;o+=64){for(h=m;h<64;h++)a[h]=n.charCodeAt(p++);Te(i,a),m=0}for(o=0;o<d;o++)a[o]=n.charCodeAt(p++);for(m=g>>3&63,a[m++]=128,o=m;o<(m>56?64:56);o++)a[o]=0;if(m>56)for(Te(i,a),o=0;o<56;o++)a[o]=0;for(;o<64;)for(h=24;h>=0;h-=8,o++)a[o]=(o>=60?g:f)>>>h&255;Te(i,a)}for(o=0;o<(512===s?16:384===s?12:256===s?8:7);o++)for(h=28;h>=0;h-=4)l+=ke.charAt(i[o]>>>h&15);return l}function Ee(t){return Ie(t,!1,224)}function Pe(t){return Ie(t,!1,256)}function Ae(t){return Ie(t,!0,384)}function Fe(t){return Ie(t,!0,512)}function Oe(t){return Ie(t,!0,224)}function Le(t){return Ie(t,!0,256)}const Be={},Re={},He={},Ve={},Ne={},De={};function ze(t){const e=Re[t];return e||(Re[t]=Pe(t))}function Ue(t){const e=De[t];return e||(De[t]=Le(t))}var Ge,$e,Ke,je=Object.freeze({__proto__:null,CSHA2_224:function(t){const e=Be[t];return e||(Be[t]=Ee(t))},CSHA2_256:ze,CSHA2_384:function(t){const e=He[t];return e||(He[t]=Ae(t))},CSHA2_512:function(t){const e=Ve[t];return e||(Ve[t]=Fe(t))},CSHA2_512_224:function(t){const e=Ne[t];return e||(Ne[t]=Oe(t))},CSHA2_512_256:Ue,SHA2_224:Ee,SHA2_256:Pe,SHA2_384:Ae,SHA2_512:Fe,SHA2_512_224:Oe,SHA2_512_256:Le});class qe extends re{static pushToMatrix(t,e){return(e=e||t.parent)&&e.pushToMatrix(t,{index:-1,recalculate:!0,emit:"push"}),t}constructor(t){super(),this.m_nIndex=-1,this.m_nColumn=-1,this.m_nRow=-1,this.m_bPopped=!0,this.m_nUniqueId=qe.enumerator.n,this.m_pMatrix=t}get parent(){return this.matrix()}get uniqueId(){return this.m_nUniqueId}get hash(){return this.m_sHash||(this.m_sHash=Pe(`${b.now}${Math.random()}.${this.uniqueId}`))}set hash(t){T(t)&&/[A-Fa-f0-9]{64}/.test(t)&&(this.m_sHash=t)}get index(){return this.m_nIndex}set index(t){this.moveToIndex(t)}get columnIndex(){return this.m_nColumn}get rowIndex(){return this.m_nRow}get isPopped(){return this.m_bPopped}get isFirst(){return!!this.m_pMatrix&&(0===this.m_pMatrix.orientation?0===this.rowIndex:0===this.columnIndex)}get isLast(){return!!this.m_pMatrix&&(this.isLastOfMatrix||(0===this.m_pMatrix.orientation?this.rowIndex===this.m_pMatrix.rows-1:this.columnIndex===this.m_pMatrix.columns-1))}get isFirstColumn(){return 0===this.columnIndex}get isLastColumn(){return!!this.m_pMatrix&&(this.isLastOfMatrix||this.columnIndex===this.m_pMatrix.columns-1)}get isFirstRow(){return 0===this.rowIndex}get isLastRow(){return!!this.m_pMatrix&&(this.isLastOfMatrix||this.rowIndex===this.m_pMatrix.rows-1)}get isFirstOfMatrix(){return 0===this.index}get isLastOfMatrix(){return!!this.m_pMatrix&&this.index===this.m_pMatrix.count-(this.m_bPopped?0:1)}get predecessorSibling(){return this.m_pMatrix&&!this.isFirstOfMatrix?this.m_pMatrix.itemAtIndex(this.index-1):void 0}get successorSibling(){return this.m_pMatrix&&!this.isLastOfMatrix?this.m_pMatrix.itemAtIndex(this.index+(this.m_bPopped?0:1)):void 0}get predecessorInColumn(){return this.m_pMatrix?this.m_pMatrix.itemAtPosition(this.m_nColumn,this.m_nRow-1):void 0}get successorInColumn(){return this.m_pMatrix?this.m_pMatrix.itemAtPosition(this.m_nColumn,this.m_nRow+1):void 0}get predecessorInRow(){return this.m_pMatrix?this.m_pMatrix.itemAtPosition(this.m_nColumn-1,this.m_nRow):void 0}get successorInRow(){return this.m_pMatrix?this.m_pMatrix.itemAtPosition(this.m_nColumn+1,this.m_nRow):void 0}matrix(){return this.m_pMatrix}onPush(t){this.emitHook("OnItemPush",t,"lifo")}onChange(t){this.emitHook("OnItemChange",t)}onPop(t){this.emitHook("OnItemPop",t)}dispatch(t,e){if("Pop"!==e)if("Detach"!==e)switch(e.hook){case"OnItemChange":t.push((()=>{this.onChange(e.payload)}));break;case"OnItemPop":t.push((()=>{this.onPop(e.payload)}))}else this.m_pMatrix=void 0;else this.m_bPopped=!0}reindex(t,e,s,n,i){const r=this.m_nColumn,a=this.m_nRow;let o,h=!1;if(this.m_pMatrix!==e&&(o=this.m_pMatrix,this.m_pMatrix=e,h=!0),this.m_nIndex===s&&"change"!==n&&"push"!==n||(0!==s&&0!==this.m_nIndex||(i|=128),s+1!==e.count&&this.m_nIndex+1!==e.count||(i|=64),this.m_nIndex=s,h=!0),this.m_nColumn=0===this.m_pMatrix.orientation?Math.floor(this.m_nIndex/this.m_pMatrix.rows):this.m_nIndex%this.m_pMatrix.columns,this.m_nRow=0===this.m_pMatrix.orientation?this.m_nIndex%this.m_pMatrix.rows:Math.floor(this.m_nIndex/this.m_pMatrix.columns),this.isPopped){const t=this.m_pMatrix.itemAtIndex(s);t&&t===this&&(this.m_bPopped=!1,h=!0)}return!(!h&&this.m_nColumn===r&&this.m_nRow===a)&&("nothing"!==n&&("push"===n?(t.push((()=>{this.onPush({matrix:e,matrixPrevious:o,item:this,reason:i})})),this.m_pMatrix.emitHook("OnItemPush",{matrix:this.m_pMatrix,matrixPrevious:o,item:this,reason:i},"lifo")):(t.push((()=>{this.onChange({matrix:e,matrixPrevious:o,item:this,reason:i})})),this.m_pMatrix.emitHook("OnItemChange",{matrix:this.m_pMatrix,matrixPrevious:o,item:this,reason:i}))),!0)}moveTo(t){return!(!this.m_pMatrix||this.m_bPopped)&&this.m_pMatrix.moveTo(this,t)}moveToIndex(t){return!(!this.m_pMatrix||this.m_bPopped)&&this.m_pMatrix.moveToIndex(this,t)}moveToPosition(t,e){return!(!this.m_pMatrix||this.m_bPopped)&&this.m_pMatrix.moveToPosition(this,t,e)}moveToItem(t,e){return!(!this.m_pMatrix||this.m_bPopped)&&this.m_pMatrix.moveToItem(this,t,e)}moveUpOrDown(t){return!(!this.m_pMatrix||this.m_bPopped)&&this.m_pMatrix.moveUpOrDown(this,t)}swap(t){return!(!this.m_pMatrix||this.m_bPopped)&&this.m_pMatrix.swap(this,t)}pop(){return!(this.m_pMatrix&&!this.m_bPopped)||this.m_pMatrix.popFromMatrix(this,!0)instanceof qe}popSilent(){return!(this.m_pMatrix&&!this.m_bPopped)||this.m_pMatrix.popFromMatrix(this,!1)instanceof qe}unpop(t,e){return!(!this.m_bPopped||!t&&!this.m_pMatrix)&&(t||this.m_pMatrix).pushToMatrix(this,{index:e,recalculate:!0,emit:"change"})instanceof qe}unpopSilent(t,e){return t=t||this.m_pMatrix,!(!this.m_bPopped||!t)&&t.pushToMatrix(this,{index:e,recalculate:!0,emit:"nothing"})instanceof qe}}qe.enumerator=new i;class We extends me{constructor(t,e=0,s=0,n=1){super(e,s,n),this.m_pItemConstructor=t}get itemConstructor(){return this.m_pItemConstructor}appendToMatrix(t){return this.pushToMatrix(this.onItemInstance(t),{index:-1,recalculate:!0,emit:"push"})}insertToMatrix(t){return this.pushToMatrix(this.onItemInstance(t),{index:0,recalculate:!0,emit:"push"})}insertToMatrixAtCursor(t,e){return this.pushToMatrix(this.onItemInstance(t),{index:this.getSafeCursor(e).index,recalculate:!0,emit:"push"})}insertToMatrixAtIndex(t,e){return this.pushToMatrix(this.onItemInstance(t),{index:e,recalculate:!0,emit:"push"})}insertToMatrixAtPosition(t,e,s){return this.pushToMatrix(this.onItemInstance(t),{index:this.indexFromColumnRow(e,s),recalculate:!0,emit:"push"})}onItemInstance(t){return new this.itemConstructor(this,t)}}class Je extends qe{constructor(t){super(t)}get parent(){return this.matrix()}matrix(){return super.matrix()}insertBefore(t){return this.parent.pushToMatrix(this.parent.onItemInstance(t),{index:this.index,recalculate:!0,emit:"push"})}insertAfter(t){return this.parent.pushToMatrix(this.parent.onItemInstance(t),{index:this.index+(this.isPopped?0:1),recalculate:!0,emit:"push"})}dispatch(t,e){"Detach"!==e&&super.dispatch(t,e)}}!function(t){t[t.Vertical=0]="Vertical",t[t.Horizontal=1]="Horizontal"}(Ge||(Ge={})),function(t){t[t.Push=1]="Push",t[t.Pop=2]="Pop",t[t.Move=4]="Move",t[t.Swap=8]="Swap",t[t.Sort=16]="Sort",t[t.Recalculation=32]="Recalculation",t[t.Last=64]="Last",t[t.First=128]="First"}($e||($e={})),function(t){t[t.Vertical=0]="Vertical",t[t.Horizontal=1]="Horizontal",t[t.Square=2]="Square",t[t.SquareHorizontal=3]="SquareHorizontal",t[t.SquareVertical=4]="SquareVertical"}(Ke||(Ke={}));class Ye extends Je{constructor(t,e){super(t),this.m_pSuccessors={live:{},preview:{}},this.hash=e}get ancestor(){return this.m_pAncestor}get branch(){return this.m_pBranch}get id(){return this.hash}selectSuccessor(t){return this.m_pSuccessors[t]}prepare(t,e=void 0){return this.m_pAncestor=t,this.m_pBranch=e,this}setSuccessor(t,e){const s=this.selectSuccessor(t);s.state=e,s.isSet=!0}successor(t){const e=this.selectSuccessor(t);if(!e.isSet){const s=this.branch||this.ancestor;s&&(e.state=s.successor(t),e.isSet=!0)}return e.state}}let Ze=class t extends Ye{static createContext(t){return ze(JSON.stringify(Z(t,{id:""})))}constructor(t,e){super(t,e.id),this.m_sContext="",this.m_pProps=e}get conditions(){return this.parent}get branch(){return this.conditions.branch}get state(){return this.branch.state}get context(){return this.m_sContext||(this.m_sContext=t.createContext(this.m_pProps))}get props(){return this.m_pProps}onApproved(t){}};class Qe extends We{constructor(t){super(t.state.ontology.constructors.condition),this.m_pBranch=t}get branch(){return this.m_pBranch}create(t){const e=Ze.createContext(t);if(!this.each((t=>t.context===e)))return this.appendToMatrix(t)}}class Xe extends We{constructor(t){super(t.ontology.constructors.branch),this.m_pState=t}get state(){return this.m_pState}create(t,e){return this.appendToMatrix(t).prepare(e)}}let ts=class extends Ye{constructor(t,e){super(t,e.id),this.m_pStates=[],this.m_pConditions=new Qe(this),this.m_pProps=e,this.m_sCulling="each"===e.culling||"all"===e.culling||"none"===e.culling?e.culling:"first",this.m_bSpawn=W(e.spawn)}get branches(){return this.parent}get states(){return this.m_pStates}get state(){return this.branches.state}get conditions(){return this.m_pConditions}get props(){return this.m_pProps}get culling(){return this.m_sCulling}get spawn(){return this.m_bSpawn}get isMain(){return this.state.isMain}get isFinish(){return this.isMain||"abort"===this.m_pProps.jump}entry(t){return this.m_pStates.length>0?this.m_pStates[0]:this.successor(t)}onReady(t){this.emitHook("OnReady",{branch:this,context:t})}onEnter(t){this.emitHook("OnEnter",{branch:this,context:t})}onSkip(t){this.emitHook("OnSkip",{branch:this,context:t})}onLeave(t){this.emitHook("OnLeave",{branch:this,context:t})}onCancel(t){this.emitHook("OnCancel",{branch:this,context:t})}};class es{static of(t){return new es(t)}constructor(t){let e;this.m_nPromises=0,this.m_bAsynchronous=!1,this.m_bCanceled=!1,this.m_fnPromise=t.promise,this.m_bContinuous=W(t.continuous),e=t.await(this),e!==this&&0===this.m_nPromises&&this.return(e),this.m_bAsynchronous=!0,this.m_bCondition=W(this.m_bCondition,!W(t.conditional))}get condition(){return W(this.m_bCondition,!0)}set condition(t){this.m_bCondition=t}get isAlive(){return x(this.m_fnPromise)}get promiseCount(){return this.m_nPromises}terminate(){return this.return(void 0),this.condition}cancel(){return this.m_bCanceled=!0,this.m_bCondition=!0,this.terminate()}return(t){return this.m_fnPromise&&this.condition&&(this.m_nPromises++,this.m_fnPromise({isAsynchronous:this.m_bAsynchronous,isCanceled:this.m_bCanceled,payload:t}),this.m_bContinuous||(this.m_fnPromise=void 0)),t}}class ss extends es{static for(t){return new ss(t)}constructor(t){super({await:t.await,promise:t.promise,conditional:t.conditional,continuous:t.continuous})}done(){return this.terminate()}}class ns extends We{constructor(t){super(t.ontology.constructors.transducer),this.m_pState=t}get state(){return this.m_pState}create(t){return this.appendToMatrix(t)}}class is extends Ye{constructor(t,e){super(t,e.id),this.m_nEvaluate=0,this.m_nEnumerator=0,this.m_pTransducers=new ns(this),this.m_pBranches=new Xe(this),this.m_pProps=e}get states(){return this.parent}get ontology(){return this.states.ontology}get transducers(){return this.m_pTransducers}get branches(){return this.m_pBranches}get isMain(){return this instanceof rs}get props(){return this.m_pProps}get isEvaluating(){return this.m_nEvaluate>0}get enumerator(){return this.m_nEnumerator}prepare(t,e,s=0){return this.m_nEnumerator=s,super.prepare(t,e)}evaluate(t,e,s){const n=this.m_nEvaluate;let i=!0;t instanceof es?t.isAlive&&this.m_nEvaluate++:(i=s(t),t.isAsynchronous&&this.m_nEvaluate>0&&this.m_nEvaluate--),i&&(0===this.m_nEvaluate&&n>0||this.m_nEvaluate>0&&0===n)&&this.onEvaluate(e,this.m_nEvaluate>0)}onSkip(t){this.emitHook("OnSkip",{state:this,context:t})}onLeave(t){this.emitHook("OnLeave",{state:this,context:t})}onLeaveError(t,e){}onCancel(t){this.emitHook("OnCancel",{state:this,context:t})}onValidated(t,e,s){this.emitHook("OnValidated",{state:this,context:t,result:e,type:s})}onEvaluate(t,e){this.emitHook("OnEvaluate",{state:this,context:t,evaluating:e})}}class rs extends is{constructor(t){super(t,{id:ze("*")})}onEnterCondition(){return!0}onEnter(){}onLeaveCondition(){return!0}onValidate(){return!0}}class as extends We{constructor(t){super(t.constructors.state),this.m_pOntology=t}get ontology(){return this.m_pOntology}main(){return this.pushToMatrix(new rs(this))}create(t,e,s,n){const i=this.appendToMatrix(t).prepare(s,e,n);return e.states.push(i),i}}function os(t){switch(t){case"meta":return 0;case"static":return 1;case"dynamic":return 2;case"feature":return 3}}function hs(t,e,s,n){var i,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,s):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,s,n);else for(var o=t.length-1;o>=0;o--)(i=t[o])&&(a=(r<3?i(a):r>3?i(e,s,a):i(e,s))||a);return r>3&&a&&Object.defineProperty(e,s,a),a}"function"==typeof SuppressedError&&SuppressedError;const ls="@serializer #properties",us="@serializer #proc",cs="@deserializer #properties",ms="@deserializer #proc";function ps(t,e,s){const n=Object.getOwnPropertyDescriptor(t,cs);if(s&&!s.set)throw new Error(`Decorator '@deserialize' can only be used on writable properties, but '${e}' seems to be a readonly property or a method.`);n&&F(n.value)?n.value.push(e):Object.defineProperty(t,cs,{value:[e],writable:!1,enumerable:!1,configurable:!1})}function ds(t,e,s){const n=Object.getOwnPropertyDescriptor(t,ls);if(s&&!s.get)throw new Error(`Decorator '@serialize' can only be used on readable properties, but '${e}' is not a property.`);n&&F(n.value)?n.value.push(e):Object.defineProperty(t,ls,{value:[e],writable:!1,enumerable:!1,configurable:!1})}function gs(t){return e=>{bs.register(e,t)}}function fs(t,e,s){le("property",t,e,s,(t=>t.target.propertyChange(t.property)))}class _s extends qe{static reciprocate(t,e){e.m_bReciprocate&&t.id&&(_s.m_pIds[`${t.id}:${e.reference}`]=e.id,0===t.count&&(_s.m_pIds[t.id]=`${t.id}:${e.reference}`))}static recover(t,e,s){if(t.id){const n=_s.m_pIds[`${t.id}:${e}`];if(n)return delete _s.m_pIds[`${t.id}:${e}`],n;if(s){const e=_s.m_pIds[`${t.id}`];if(e){const s=_s.m_pIds[e];if(delete _s.m_pIds[t.id],s)return delete _s.m_pIds[e],s}}}}constructor(t,e,s,n,i,r,a){if(super(),this.m_bReciprocate=!0,!T(s))throw new Error("Invalid slot reference supplied to slot constructor.");if(this.m_pType=t,this.m_sKind=e,this.m_sReference=s,this.m_nSequence=n,this.m_pExchangeables=r,a instanceof bs){if(a.id&&"static"===e){const t=ze(i?`${a.id}:${i}`:a.id);if(t&&!a.selectByIdentifier(t))return this.hash=t,void(this.m_bReciprocate=!1)}const t=_s.recover(a,s,"static"===e||"dynamic"===e);t&&!a.selectByIdentifier(t)&&(this.hash=t)}else a&&(this.hash=a)}get slots(){return this.parent}get id(){return this.hash}get type(){return this.m_pType.type}get kind(){return this.m_sKind}get sequence(){return this.m_nSequence}set sequence(t){this.m_nSequence=t,this.slots&&this.slots.sort()}get reference(){return this.m_sReference}get exchangeables(){const t=this;return et(this.m_pExchangeables,(e=>({property:e,get value(){return Ut(t,e)},set value(s){Dt(t,e,s)}})))}getPipe(t){if(A(t.pipeable))return t.pipeable;let e;if(t.pipeable)e=t.pipeable;else{if(A(t.pipable))return t.pipable;e=t.pipable}return e?e.group?{legacy:e.group,label:e.label,alias:e.alias,content:e.content||e.template}:e:void 0}onPop(t){return _s.reciprocate(t.matrix,this),super.onPop(t)}propertyChange(t){const e=this.slots;if(e&&!e.isDeserializing)switch(this.emitHook("OnSlotProperty",{slot:this,property:t}),e.emitHook("OnSlotProperty",{slot:this,property:t}),t){case"label":case"name":case"alias":case"placeholder":this.emitHook("OnSlotRename",{slot:this}),e.emitHook("OnSlotRename",{slot:this});break;case"required":this.emitHook("OnSlotRequired",{slot:this}),e.emitHook("OnSlotRequired",{slot:this})}}serialize(){return function(t,e){const s={};return X(e,((t,e)=>{k(t)&&Dt(s,e,t)}),{keys:!0}),X(Ut(t,ls),(e=>{const n=Ut(t,e);if(k(n)){const t=Ut(n,us);Dt(s,e,T(t)?ft(Ut(n,t),n):n)}})),s}(this,{id:this.id,type:this.type,kind:this.kind,reference:this.reference,sequence:this.sequence,label:this.label,name:this.name,placeholder:this.placeholder,alias:this.alias,required:this.required,pipeable:this.pipeable,default:this.default,exportable:this.exportable,actionable:this.actionable,protected:this.protected})}deserialize(t){return function(t,e,s){const n=s||new ee;X(Ut(t,cs),(s=>{const i=e[s];if(k(i)){const e=Ut(t,s),r=Ut(e,ms);if(e&&T(r))return void ft(Ut(e,r),e,i,n);Dt(t,s,i)}})),s||n.flush()}(this,t),this.hash=t.id,this.sequence=t.sequence,this.label=t.label,this.name=t.name,this.placeholder=t.placeholder,this.alias=t.alias,this.required=t.required,this.pipeable=this.getPipe(t),this.default=t.default,this.exportable=t.exportable,this.actionable=A(t.actionable)?t.actionable:t.volatile,this.protected=t.protected,this}deprecate(){return this.pop(),this}delete(){return this.pop(),this}pipe(t){const e=(null==t?void 0:t.id)||this.slots&&this.slots.id;return e&&this.pipeable&&!A(this.pipeable)?ze(this.pipeable.pipe?`${e}:${this.pipeable.pipe}`:e):""}legacyPipe(t){const e=(null==t?void 0:t.id)||this.slots&&this.slots.id;return e&&this.pipeable&&!A(this.pipeable)&&this.pipeable.legacy?ze(`${e}:${this.pipeable.legacy}`):void 0}isPipe(t){if(t&&this.slots&&this.slots.id&&this.pipeable&&!A(this.pipeable)){if(ze(this.pipeable.pipe?`${this.slots.id}:${this.pipeable.pipe}`:this.slots.id)===t)return!0;if(this.pipeable.legacy&&ze(`${this.slots.id}:${this.pipeable.legacy}`)===t)return!0}return!1}exchange(t){this.m_pExchangeables=t}}_s.m_pIds={},hs([fs],_s.prototype,"label",void 0),hs([fs],_s.prototype,"name",void 0),hs([fs],_s.prototype,"placeholder",void 0),hs([fs],_s.prototype,"alias",void 0),hs([fs],_s.prototype,"required",void 0),hs([fs],_s.prototype,"pipeable",void 0),hs([fs],_s.prototype,"default",void 0),hs([fs],_s.prototype,"exportable",void 0),hs([fs],_s.prototype,"actionable",void 0),hs([fs],_s.prototype,"protected",void 0),hs([fs],_s.prototype,"sequence",null),hs([function(t,e,s){if(!s||!x(s.value))throw new Error(`Decorator '@serializer' needs to be applied to a function, but '${e}' seems to be a property.`);if(Object.getOwnPropertyDescriptor(t,us))throw new Error("Decorator '@serializer' is applied multiple times, but can only be used once in a class.");Object.defineProperty(t,us,{value:e,writable:!1,enumerable:!1,configurable:!1})}],_s.prototype,"serialize",null),hs([function(t,e,s){if(!s||!x(s.value))throw new Error(`Decorator '@deserializer' needs to be applied to a function, but '${e}' seems to be a property.`);if(Object.getOwnPropertyDescriptor(t,ms))throw new Error("Decorator '@deserializer' is applied multiple times, but can only be used once in a class.");Object.defineProperty(t,ms,{value:e,writable:!1,enumerable:!1,configurable:!1})}],_s.prototype,"deserialize",null);class bs extends me{static register(t,e){if(this.m_pTypes[e])throw new Error(`Duplicate slot type '${e}' registered using the '@slot' decorator.`);this.m_pTypes[Nt(t,"type",e)]=t}static ofType(t){return this.m_pTypes[t]}constructor(t){super(),this.m_bDeserializing=!1,this.m_sId=null==t?void 0:t.id}get id(){return this.m_sId}get isDeserializing(){return this.m_bDeserializing}get hasMultiplePipeable(){if(this.count>1){let t,e=0;return this.each((s=>{const n=s.pipeable&&!A(s.pipeable)?s.pipeable.pipe||!0:void 0;return(n&&n!==t||!n&&!1!==s.pipeable)&&e++,t||(t=n),e>1}))}return!1}create(t,e){let s=this.select(e.reference,t);return s&&s.type===e.type.type?s.sequence!==e.sequence&&(s.sequence=e.sequence):(s&&s.delete(),s=this.pushToMatrix(new e.type(e.type,t,e.reference,e.sequence,e.pipe,e.exchange,(null==s?void 0:s.id)||this))),X(e,((t,e)=>{switch(e){case"type":case"reference":case"sequence":case"pipe":break;case"exchange":s.exchange(t);break;default:Nt(s,e,t)}}),{keys:!0}),s}onDimensionChange(t){super.onDimensionChange(t),this.isDeserializing||this.sort()}meta(t){return this.create("meta",t)}static(t){return this.create("static",t)}dynamic(t){return this.create("dynamic",t)}feature(t){return this.create("feature",t)}select(t,e){let s;return this.each((n=>!(e&&e!==n.kind||n.reference!==t&&n.id!==t)&&(s=n,!0))),s}selectByIdentifier(t){let e;if(t)return this.each((s=>!(s.id!==t&&!s.isPipe(t))&&(e=s,!0))),e}deprecate(t,e){const s=this.select(t,e);if(s)return s.deprecate()}delete(t,e){const s=this.select(t,e);if(s)return s.delete()}clean(t,...e){this.each((s=>{t&&s.kind!==t||lt(e,(t=>t instanceof _s&&t.id===s.id))||s.pop()}))}sort(){return!this.isDeserializing&&super.sort(((t,e)=>os(t.kind)-os(e.kind)||(t.sequence||0)-(e.sequence||0)||t.uniqueId-e.uniqueId))}serialize(){const t=[];return this.each((e=>{t.push(e.serialize())})),t}deserialize(t){return this.m_bDeserializing=!0,X(t,(t=>{const e=bs.ofType(t.type);if(!e)throw new Error(`No slot implementation found for type '${t.type}'`);{const s=this.select(t.reference,t.kind);s&&s.type===e.type?s.deserialize(t):(s&&s.pop(),this.pushToMatrix(new e(e,t.kind,t.reference,t.sequence)).deserialize(t))}})),this.m_bDeserializing=!1,this.sort(),this}destroy(){this.clear("dirty"),super.destroy()}}bs.m_pTypes={};let ys=class extends _s{toValue(t){return W(t,this.default)}toString(t){const e=this.toValue(t);return!e&&this.labelForFalse?this.labelForFalse:e&&this.labelForTrue?this.labelForTrue:e?"True":"False"}};hs([fs,ds,ps],ys.prototype,"labelForFalse",void 0),hs([fs,ds,ps],ys.prototype,"labelForTrue",void 0),ys=hs([gs("boolean")],ys);let vs=class extends _s{get supportsTime(){return"years"!==this.precision&&"months"!==this.precision&&"days"!==this.precision}fromString(t){const e=t.replace(" ","T").split("T"),s=e[0].split("-"),n=2===e.length&&e[1].split(":")||void 0;if(3===s.length&&(!n||3===n.length)){const t=new Date(0);if(t.setUTCDate(1),t.setUTCFullYear(j(s[0])),t.setUTCMonth(j(s[1])-1),t.setUTCDate(j(s[2])),n){t.setUTCHours(j(n[0])),t.setUTCMinutes(j(n[1]));const e=n[2].split(".");t.setUTCSeconds(j(2===e.length?e[0]:n[2])),t.setUTCMilliseconds(2===e.length?j(e[1]):0)}else t.setUTCHours(0),t.setUTCMinutes(0),t.setUTCSeconds(0),t.setUTCMilliseconds(0);return t.getTime()}return this.default||0}toValue(t,e){const s=t instanceof Date?new Date(t.getTime()-60*t.getTimezoneOffset()*1e3):new Date(w(t)?this.fromString(t):j(t,this.default)),n=!0===this.minimum?new Date:this.minimum,i=!0===this.maximum?new Date:this.maximum;if(N(n)||E(n)){const t=N(n)?n.getTime()-60*n.getTimezoneOffset()*1e3:n;s.getTime()<t&&s.setTime(t)}if(N(i)||E(i)){const t=N(i)?i.getTime()-60*i.getTimezoneOffset()*1e3:i;s.getTime()>t&&s.setTime(t)}switch(e||this.precision){case"years":s.setUTCMonth(0);case"months":s.setUTCDate(1);case"days":s.setUTCHours(0);case"hours":s.setUTCMinutes(0);case"minutes":s.setUTCSeconds(0);case"seconds":s.setUTCMilliseconds(0)}return s.getTime()}toDate(t,e){return new Date(this.toValue(t,e))}toString(t,s){const n=this.toDate(t,s);let i=!0;switch(s||this.precision){case"years":case"months":case"days":i=!1}return`${n.getUTCFullYear()}-${e.padLeft(n.getUTCMonth()+1,"0",2)}-${e.padLeft(n.getUTCDate(),"0",2)}`+(i&&` ${e.padLeft(n.getUTCHours(),"0",2)}:${e.padLeft(n.getUTCMinutes(),"0",2)}:${e.padLeft(n.getUTCSeconds(),"0",2)}.${e.padLeft(n.getUTCMilliseconds(),"0",3)}`||"")}};hs([fs,ds,ps],vs.prototype,"precision",void 0),hs([fs,ds,ps],vs.prototype,"minimum",void 0),hs([fs,ds,ps],vs.prototype,"maximum",void 0),vs=hs([gs("date")],vs);let ks=class extends _s{toValue(t){return j(t,this.default)}toString(t,e){return e?e(this.toValue(t)):K(this.toValue(t))}};ks=hs([gs("number")],ks);let Ss=class extends _s{get precision(){return this.m_nPrecision}set precision(e){this.m_nPrecision=E(e)?t.max(0,e):void 0}toValue(e){let s;return s=E(this.precision)&&this.precision>0?t.conform(q(e,this.default),this.precision):j(e,this.default),E(this.minimum)&&s<this.minimum&&(s=this.minimum),E(this.maximum)&&s>this.maximum&&(s=this.maximum),s}formatString(t,e){return(e&&w(this.prefixPlural)?this.prefixPlural:this.prefix||"")+t+(e&&w(this.suffixPlural)?this.suffixPlural:this.suffix||"")}toString(s,n){const i=this.toValue(s);return this.formatString(this.digits?e.padLeft(i,"0",this.digits,!1,!0):!n||this.separator||this.decimal||this.minus?t.format(i,this.precision,this.separator||"",this.decimal,this.minus):n(i,this.precision),1!==i)}};hs([fs,ds,ps],Ss.prototype,"minimum",void 0),hs([fs,ds,ps],Ss.prototype,"maximum",void 0),hs([fs,ds,ps],Ss.prototype,"separator",void 0),hs([fs,ds,ps],Ss.prototype,"decimal",void 0),hs([fs,ds,ps],Ss.prototype,"minus",void 0),hs([fs,ds,ps],Ss.prototype,"prefix",void 0),hs([fs,ds,ps],Ss.prototype,"prefixPlural",void 0),hs([fs,ds,ps],Ss.prototype,"suffix",void 0),hs([fs,ds,ps],Ss.prototype,"suffixPlural",void 0),hs([fs,ds,ps],Ss.prototype,"digits",void 0),hs([fs,ds,ps],Ss.prototype,"precision",null),Ss=hs([gs("numeric")],Ss);let Cs=class extends _s{toValue(t){return K(t,this.default)}toString(t){return this.toValue(t)}};Cs=hs([gs("string")],Cs);let xs=class extends _s{get maxLength(){return this.m_nMaxLength}set maxLength(e){this.m_nMaxLength=E(e)?t.max(0,e):void 0}toValue(t){const s=e.sanitize(K(t,this.default)).substr(0,this.maxLength||void 0);switch(this.transformation){case"capitalize":return e.capitalize(s,"first-character");case"capitalize-words":return e.capitalize(s,"each-word");case"capitalize-sentences":return e.capitalize(s,"each-sentence");case"uppercase":return e.uppercase(s);case"lowercase":return e.lowercase(s)}return s}toString(t){return this.toValue(t)}};hs([fs,ds,ps],xs.prototype,"maxLength",null),hs([fs,ds,ps],xs.prototype,"transformation",void 0),xs=hs([gs("text")],xs);var ws,Ms=Object.freeze({__proto__:null,get Boolean(){return ys},get Date(){return vs},get Number(){return ks},get Numeric(){return Ss},Slot:_s,Slots:bs,get String(){return Cs},get Text(){return xs},deserialize:ps,property:fs,serialize:ds,slot:gs});class Ts extends Ye{constructor(t,e){super(t,e.id),this.m_pProps=e,this.m_pSlots=new bs}get transducers(){return this.parent}get state(){return this.transducers.state}get slots(){return this.m_pSlots}get props(){return this.m_pProps}seal(t,e){this.slots.each((s=>{const n=t.mutableValueOf(s);n&&n.seal(e)}))}shouldVerifySeal(t){let e=!1;return this.slots.each((s=>{const n=t.mutableValueOf(s);n&&n.shouldVerifySeal&&(e=!0)})),e}isAwaiting(t){return this.slots.each((e=>{const s=t.mutableValueOf(e);return s&&s.isAwaiting||!1}))}onSkip(t){this.emitHook("OnSkip",{transducer:this,context:t})}onLeave(t){this.emitHook("OnLeave",{transducer:this,context:t})}onCancel(t){this.emitHook("OnCancel",{transducer:this,context:t})}onBeforeValidate(t){}onValidated(t,e,s){this.emitHook("OnValidated",{transducer:this,context:t,result:e,type:s})}onSideEffect(t,e){}}class Is{constructor(t){this.m_pValue=t}get key(){return this.m_pValue.key}get context(){return this.m_pValue.context}get slot(){return this.m_pValue.slot}get value(){return this.m_pValue.value}get string(){return this.m_pValue.string}get reference(){return this.m_pValue.reference}get display(){return this.m_pValue.display}get time(){return this.m_pValue.time}get hasValue(){return this.m_pValue.hasValue}get isModified(){return this.m_pValue.isModified}get isSealed(){return this.m_pValue.isSealed||this.m_pValue.isPreliminarily}get isLocked(){return this.m_pValue.isLocked}get isFrozen(){return this.m_pValue.isFrozen}subscribe(t,e){return this.m_pValue.subscribe((()=>t(this)),e),this}unsubscribe(t){return this.m_pValue.unsubscribe(t),this}}class Es{constructor(t,e){this.m_pMutables={},this.m_pImmutables={},this.m_nId=Es.m_nId++,this.m_pStack=t,this.m_pChain=e}get instance(){return this.m_pStack.instance}get l10n(){return this.instance.l10n}get id(){return this.m_nId}get key(){if(!this.m_sKey){let t=this.m_pStack,e="";for(;t;){const s=t.mutableContext;s&&(e+=s.context),t=t.ancestor}this.m_sKey=ze(e||"*")}return this.m_sKey}get index(){return this.m_pStack.branchIndex}getImmutableValue(t,e){const s=t instanceof _s?t.id:C(t)?t.slot.id:t,n=this.m_pImmutables[s];return n&&n.isSealed?n:(e||(e=this.instance.data.forSlot(t)),e&&Nt(this.m_pImmutables,s,e.immutableValue(this.m_pStack)))}validationOf(t){return this.m_pStack.validationOf(t)}isMutableContextOf(t){return t.state===this.m_pStack.state&&t.mutableContext===this.m_pStack.mutableContext}mutableValueOf(t){const e=t instanceof _s?t.id:C(t)?t.slot.id:t,s=this.m_pMutables[e];if(s)return s;const n=this.instance.data.forSlot(e);return n&&Nt(this.m_pMutables,e,n.mutableValue(this.m_pStack,!1,this))}immutableValueOf(t){return this.getImmutableValue(t)}contextualValueOf(t){const e=t instanceof _s?t.id:C(t)?t.slot.id:t,s=this.m_pMutables[e];if(s)return s;const n=this.instance.data.forSlot(e);return n&&Nt(this.m_pMutables,e,n.mutableValue(this.m_pStack,!0,this))}proxyValueOf(t,s,n,i,r){const a=this;let o;return{get context(){return o||(o=a.getImmutableValue(s,t)),null==o?void 0:o.context},get string(){if(o||(o=a.getImmutableValue(s,t)),o){if(n&&s.pipeable&&!A(s.pipeable)&&s.pipeable.content&&"value"!==s.pipeable.content){const t=s.pipeable.content;return("name"===t?s.name:"label"===t?s.label:t.string)||""}return o.hasValue&&o.isSealed&&(r&&r(o,a)||o.display||o.string)||""}return e.iterateToString(t.getString(a.m_pStack,a,n,r),i)},get content(){if(o||(o=a.getImmutableValue(s,t)),o){if(n&&s.pipeable&&!A(s.pipeable)&&s.pipeable.content&&"value"!==s.pipeable.content){const t=s.pipeable.content;return"name"===t?[{value:s.name||"",type:"string",separator:i}]:"label"===t?[{value:s.label||"",type:"string",separator:i}]:t.markdown?[{value:t.markdown,type:"markdown",separator:i}]:t.text?[{value:t.text,type:"text",separator:i}]:[{value:t.string,type:"string",separator:i}]}return[{value:o.hasValue&&o.isSealed&&(r&&r(o,a)||o.display||o.string)||"",type:"string",separator:i}]}return t.getContent(a.m_pStack,a,n,i,r)},get value(){return o||(o=a.getImmutableValue(s,t)),o?o.isSealed?o.value:void 0:t.getValue(a.m_pStack)},get reference(){if(o||(o=a.getImmutableValue(s,t)),o&&o.isSealed)return o.reference},get hasValue(){return o||(o=a.getImmutableValue(s,t)),o?o.hasValue&&o.isSealed:t.hasValue(a.m_pStack)},get refs(){return o||(o=a.getImmutableValue(s,t)),o?[o.hasValue&&o.isSealed&&o.reference||s.reference]:t.getRefs(a.m_pStack,n)},update:t=>{o=t}}}variableFor(t,e,s,n,i=", ",r=!1){if(n&&t===n){const t=this.instance;return{id:n,get string(){return t.finishReference},get content(){return[{value:t.finishReference,type:"string",separator:i}]},get reference(){return t.finishReference},hasValue:!0,refs:[n],subscribe:y,unsubscribe:y}}const a=t instanceof _s?t.id:C(t)?t.slot.id:t,o=t instanceof _s?t:C(t)?t.slot:this.m_pChain.slot(a);if(o instanceof _s){const t=this.instance.data.forSlot(o);if(t){let e;const n=this,h=o,l={slot:o,id:a,get hasValue(){return(e||(e=n.proxyValueOf(t,h,r,i,s))).hasValue},get value(){return(e||(e=n.proxyValueOf(t,h,r,i,s))).value},get reference(){return(e||(e=n.proxyValueOf(t,h,r,i,s))).reference},get string(){return(e||(e=n.proxyValueOf(t,h,r,i,s))).string},get display(){return(e||(e=n.proxyValueOf(t,h,r,i,s))).display},get content(){return(e||(e=n.proxyValueOf(t,h,r,i,s))).content},get refs(){return(e||(e=n.proxyValueOf(t,h,r,i,s))).refs},subscribe:(n,a)=>{const o=a=>{if(e&&e.context===a.context)e.update(a.value),n(l);else{const a=this.proxyValueOf(t,h,r,i,s);!a||e&&e.context===a.context||(e=a,n(l))}};t.groupedHook("OnValueChange","synchronous",(t=>o(t)),a),t.groupedHook("OnSealChange","synchronous",(t=>o(t)),a)},unsubscribe:e=>t.unhook("OnValueChange",e)};return l}}else if(o&&o.length>0){const t=[];if(e){let t=this.m_pStack;for(;t;){const r=t.immutableContext;if(r){const t=e(r,this);if(t){const e=lt(o,(e=>e.id===t));if(e&&e.pipeable&&!A(e.pipeable)){const t=this.variableFor(e,void 0,s,n,i,!0);if(t)return Nt(t,"id",a),t}}}t=t.ancestor}}X(o,(e=>{if(e.pipeable&&!A(e.pipeable)){const r=this.variableFor(e,void 0,s,n,i,!0);r&&t.push(r)}}));const r={id:a,get string(){let e,s,n="";return X(t,(t=>{if(t.slot){const r=t.slot;if(!(r instanceof ys)||!0===t.value)if(!(t.slot instanceof ks||t.slot instanceof Ss)||r.pipeable&&!A(r.pipeable)&&"value"!==r.pipeable.content){const e=t.string;e&&(n+=(""===n?"":i)+e)}else s=t.slot,t.hasValue&&E(t.value)&&(e=(e||0)+t.value)}})),s&&E(e)&&(n+=(""===n?"":i)+s.toString(e)),n},get display(){let e,s,n="";return X(t,(t=>{if(t.slot){const r=t.slot;if(!(r instanceof ys)||!0===t.value)if(!(t.slot instanceof ks||t.slot instanceof Ss)||r.pipeable&&!A(r.pipeable)&&"value"!==r.pipeable.content){const e=t.display||t.string;e&&(n+=(""===n?"":i)+e)}else s=t.slot,t.hasValue&&E(t.value)&&(e=(e||0)+t.value)}})),s&&E(e)&&(n+=(""===n?"":i)+s.toString(e)),n},get content(){const e=[];let s,n;return X(t,(t=>{if(t.slot){const i=t.slot;i instanceof ys&&!0!==t.value||(!(t.slot instanceof ks||t.slot instanceof Ss)||i.pipeable&&!A(i.pipeable)&&"value"!==i.pipeable.content?e.push(...t.content):(n=t.slot,t.hasValue&&E(t.value)&&(s=(s||0)+t.value)))}})),n&&E(s)&&e.push({value:n.toString(s),type:"string",separator:i}),e},get hasValue(){return!!lt(t,(t=>{if(t.slot){const e=t.slot;if(e.pipeable&&!A(e.pipeable))return t.hasValue}return!1}))},get refs(){const e=[];return X(t,(t=>{!t.slot||t.slot instanceof ys&&!0!==t.value||e.push(...t.refs)})),e},subscribe:(e,s)=>X(t,(t=>t.subscribe((()=>e(r)),s))),unsubscribe:e=>X(t,(t=>t.unsubscribe(e)))};return r}}}Es.m_nId=0;class Ps{constructor(t,e,s,n,i,r,a,o,h,l=!1,u=!1){this.m_pSubscriptions=new re,this.m_bImport=!1,this.m_bVerifySeal=!1,this.m_bAwaiting=!1,this.m_bAllowPrefill=!0,this.m_bDefault=!1,this.m_bFrozen=!1,this.m_nEmitter=0,this.m_bOperation=!1,this.m_nId=Ps.m_pEnumerator.n,this.m_pTransducer=t,this.m_pSlot=e,this.m_sContext=s,this.m_fnChange=i,this.m_pValue=r,this.m_sReference=a,this.m_sDisplay=o,this.m_bSealed=l,this.m_bLocked=u,this.attachContext(n),this.setTime(h)}get id(){return this.m_nId}get key(){return this.m_sKey||(this.m_sKey="_"+ze(`${this.slot.id}/${this.id}`))}get context(){return this.m_sContext}get contextRef(){return this.m_pContext}get slot(){return this.m_pSlot}get pristine(){return this.m_pValue}set pristine(t){this.isFrozen||this.isLocked||t===this.m_pValue||(this.m_pValue=t,this.m_bVerifySeal=!0,this.m_bAwaiting=!1,this.setTime(),this.emitChange("value"))}get value(){return this.slot.toValue(this.pristine)}set value(t){this.pristine=t}get string(){return this.slot.toString(this.value)}get reference(){return this.m_sReference}get display(){return this.m_sDisplay}get hasValue(){return!!E(this.m_nTime)}get isModified(){return this.m_bImport?this.isDirty||this.m_pInitialValue!==this.m_pValue:!this.isDirty&&!v(this.m_pValue)}get isPreliminarily(){var t;return(null===(t=this.m_pContext)||void 0===t?void 0:t.instance.isTransducerPresent(this.m_pTransducer))||!1}get isSealed(){var t;return(null===(t=this.m_pContext)||void 0===t?void 0:t.instance.isPreview)||this.m_bSealed}get isDirty(){return!this.isSealed||!this.hasValue}get shouldVerifySeal(){return!!this.m_bVerifySeal&&(this.m_bVerifySeal=!1,!0)}get isFrozen(){return this.m_bFrozen}get isLocked(){return this.m_bLocked}get isAwaiting(){return this.m_bAwaiting}get allowPrefill(){return this.m_bAllowPrefill}get time(){return this.m_nTime}get immutable(){return new Is(this)}emitChange(t,e=!0,s=!1){if(0!==this.m_nEmitter&&(this.m_nEmitter=Ct(this.m_nEmitter)),"value"===t){const t=this.m_fnModifier&&this.m_fnModifier(this);t&&(this.m_pValue=t.value,this.m_sReference=t.reference,this.m_sDisplay=t.display,this.setTime()),this.m_fnListener&&this.m_fnListener(this)}if(e){const e=()=>{this.m_nEmitter=0,this.m_fnChange(this,t),this.m_pSubscriptions.emitHook("OnChange",{})};s?this.m_nEmitter=kt((()=>e())):e()}}setTime(t){this.m_nTime=v(this.m_pValue)?void 0:E(t)?t:b.now,E(this.m_nTime)&&(this.m_bAllowPrefill=!1),this.m_bOperation||(this.m_pOperations=void 0)}makeDirty(t){if(!this.isFrozen&&!this.isLocked){const e=this.m_nTime;t?this.m_nTime=void 0:this.hasValue||(this.m_nTime=b.now),e!==this.m_nTime&&(this.m_bVerifySeal=!0,this.m_bAwaiting=!1,this.emitChange("value",!0,!0))}}precursor(){this.m_pInitialValue=this.m_pValue,this.m_sInitialReference=this.m_sReference,this.m_sInitialDisplay=this.m_sDisplay}set(t,e,s){return this.isFrozen||this.isLocked||!(t!==this.m_pValue||this.m_sReference!==e||this.hasValue&&v(this.m_pValue)&&v(this.m_sReference)||this.m_bAwaiting)||(this.m_pValue=t,this.m_sReference=e,this.m_sDisplay=s,this.m_bVerifySeal=!0,this.m_bAwaiting=!1,this.setTime(),this.emitChange("value")),this.value}concatenate(t,e,s){if(!lt(this.m_pOperations,(s=>s===(e||t)))){const n=this.string;(this.m_pOperations||(this.m_pOperations=[])).push(e||t),this.m_bOperation=!0,this.set(n+(n&&t&&s||"")+t),this.m_bOperation=!1}return this.string}operation(t,e){return e&&lt(this.m_pOperations,(t=>t===e))||((this.m_pOperations||(this.m_pOperations=[])).push(e),this.m_bOperation=!0,this.set(t),this.m_bOperation=!1),this}reset(t,e,s){let n=this.m_pInitialValue,i=this.m_sInitialReference,r=this.m_sInitialDisplay;return v(n)&&(n=t,i=e,r=s),this.set(n,i,r),this.m_bAllowPrefill=!this.hasValue,this.value}default(t,e,s){return this.m_bDefault||(this.m_bDefault=!0,this.set(t,e,s)),this.value}await(){return this.isFrozen||this.isLocked||this.m_bAwaiting||(this.m_bAwaiting=!0,this.m_bVerifySeal=!0,this.emitChange("value")),this}cancelAwait(){return this.m_bAwaiting&&(this.m_bAwaiting=!1,this.m_bVerifySeal=!0,this.emitChange("value")),this}seal(t){this.m_bSealed!==t&&(this.m_bSealed=t,this.m_pContext&&this.m_pContext.instance.isPreview||this.emitChange("seal"))}freeze(){var t;this.m_bFrozen||(this.m_bFrozen=!0,null===(t=this.contextRef)||void 0===t||t.instance.markAsChanged(this.slot,!0))}unfreeze(){var t;this.m_bFrozen&&(this.m_bFrozen=!1,null===(t=this.contextRef)||void 0===t||t.instance.markAsChanged(this.slot,!0))}lock(){var t;this.m_bLocked||(this.m_bLocked=!0,null===(t=this.contextRef)||void 0===t||t.instance.markAsChanged(this.slot,!0))}unlock(){var t;this.m_bLocked&&(this.m_bLocked=!1,null===(t=this.contextRef)||void 0===t||t.instance.markAsChanged(this.slot,!0))}clear(){return this.set(void 0)}import(t,e,s,n,i=!1){return this.isFrozen||this.isLocked||v(t)||(this.m_bImport=!0,this.m_pInitialValue=t,this.m_sInitialReference=e,this.m_sInitialDisplay=s,(t!==this.m_pValue||e!==this.m_sReference||this.m_bAwaiting)&&(this.m_pValue=t,this.m_sReference=e,this.m_sDisplay=s,this.m_bAwaiting=!1,this.m_bVerifySeal=!0,this.setTime(n),this.emitChange("value",!i))),this.value}confirm(t=!1){return t?this.isFrozen||this.isLocked||this.hasValue||(this.m_nTime=b.now):this.makeDirty(!1),this}dirty(){return this.makeDirty(!0),this}subscribe(t,e,s="asynchronous"){return this.m_pSubscriptions.hook("OnChange",s,(()=>t(this)),e),this}unsubscribe(t){return this.m_pSubscriptions.unhook("OnChange",t),this}useListener(t){const e=!!this.m_fnListener;return this.m_fnListener=t,!e&&this.hasValue&&t(this),this}useModifier(t){const e=!!this.m_fnModifier;if(this.m_fnModifier=t,t&&!e&&this.hasValue){const e=t(this);e&&this.set(e.value,e.reference,e.display)}return this}attachContext(t){return this.m_pContext||(this.m_pContext=t),this}useContext(t){return this.m_fnContext=t,this}mountContext(t){return this.m_fnContext&&this.m_fnContext(this,t),this}}Ps.m_pEnumerator=new i;class As extends qe{static getContextHash(t){return As.m_pContexts[t]||(As.m_pContexts[t]=ze(t))}constructor(t,e,s,n,i){super(),this.m_pValues={},this.m_pMutables={},this.m_pImmutables={},this.m_pReferences={},this.m_pTransducer=t,this.m_pSlot=e,this.m_pInstance=s,this.m_pOrchestrator=n,this.m_fnUpdate=i}get data(){return this.parent}get transducer(){return this.m_pTransducer}get slot(){return this.m_pSlot}get values(){const t={};return X(this.m_pValues,((e,s)=>{e&&!e.isDirty&&Nt(t,s,{value:e.value,reference:e.reference,display:e.display,time:e.time||0})}),{keys:!0}),t}get hasSealedValues(){return!!lt(this.m_pValues,(t=>t&&t.isSealed&&(W(t.slot.exportable,!0)||t.slot.actionable)||!1))}storeContextReference(t,e){const s=this.m_pReferences[t||"*"]||Nt(this.m_pReferences,t||"*",{});return s[e]||Nt(s,e,!0),e}isSlotInBranch(t,e){return lt(t.states,(t=>t.transducers.each((t=>t.slots.each((t=>t.id===this.m_pSlot.id))))||t.branches.each((t=>(e||"each"!==t.culling)&&this.isSlotInBranch(t,e)))))instanceof is}create(t,e,s,n){return Nt(this.m_pValues,t,new Ps(this.transducer,this.slot,t,s,((t,e)=>{const s={transducer:this.transducer,slot:this.slot,data:this.data,id:t.id,context:t.context,get value(){return t.immutable}};switch(e){case"value":this.m_fnUpdate({transducer:this.transducer,slot:this.slot,data:this.data,id:t.id,key:t.context,context:t.contextRef,isSealed:t.isSealed,get value(){return t.immutable}}),this.emitHook("OnValueChange",s),this.data.emitHook("OnValueChange",s);break;case"seal":if(this.emitHook("OnSealChange",s),this.data.emitHook("OnSealChange",s),t.contextRef&&t.isSealed){const e=this.m_pOrchestrator.dependencies(this.slot);this.transducer.parent.each((n=>{!1===e[n.id]&&n!==this.transducer&&n.onSideEffect(t.contextRef,s.transducer)}))}}}),n&&n.b,n&&n.c,n&&n.f,n&&n.e,e||Zt.has(n&&n.d||0,1),Zt.has(n&&n.d||0,2)))}assert(t,e,s){const n=this.m_pValues[t];return n?n.attachContext(s):this.create(t,e,s)}mutableContext(t,e){const s=(null==t?void 0:t.trace)||"";if(!s)return[];const n=this.m_pMutables[s];if(n)return n;const i=[];let r=!1;for(;t;){const s=t.mutableContext;s&&(r=r||e||this.isSlotInBranch(s.branch,!0),r&&i.push({condition:s,context:s.context})),t=t.ancestor}const a=i.length;if(a>0){let t="",e="";for(let s=a-1;s>=0;s--){const n=i[s],r=t&&As.getContextHash(t+n.context)||n.context;t+=n.context,Nt(n,"context",this.storeContextReference(e,r)),e=r}}return Nt(this.m_pMutables,s,i)}immutableContext(t){const e=(null==t?void 0:t.trace)||"";if(!e)return[];const s=this.m_pImmutables[e];if(s)return s;const n=[];for(;t;){const e=t.immutableContext;e&&n.push(e),t=t.ancestor}const i=n.length;if(i>0){const t=[];for(let e=i-1;e>=0;e--){let s="",i="",r=0;for(let a=e;a>=0;a--){const e=n[a],o=s&&As.getContextHash(s+e.context)||e.context;t.push({condition:e,context:this.storeContextReference(i,o),relevance:r++}),s+=e.context,i=o}}return t.sort(((t,e)=>e.relevance-t.relevance)),Nt(this.m_pImmutables,e,t)}return[]}getValues(t){const e=[];return X(this.m_pReferences[t],((t,s)=>{const n=this.m_pValues[s];n?n.isSealed&&n.hasValue&&e.push(n.immutable):e.push(...this.getValues(s))}),{keys:!0}),e}mutableValue(t,e,s){const n=this.mutableContext(t,e);return this.assert(n.length>0?n[0].context:"*",e,s)}immutableValue(t){const e=this.immutableContext(t),s=e.length;for(let t=0;t<s;t++){const s=this.m_pValues[e[t].context];if(s)return(s.isSealed||s.isPreliminarily)&&s.immutable||void 0}const n=this.m_pValues["*"];return n&&(n.isSealed||n.isPreliminarily)&&n.immutable||void 0}immutableValues(t){const e=this.immutableContext(t),s=e.length;for(let t=0;t<s;t++){const s=e[t],n=this.getValues(s.context);if(n.length>0||this.isSlotInBranch(s.condition.branch,!1))return n}return this.getValues("*")}isModified(t){const e=this.m_pValues[t];return e&&e.isModified||!1}snapshot(){const t=[];if(X(this.m_pValues,(e=>{if(e){let s=!1;const n=Zt.convert(e.isSealed,e.isLocked),i={a:e.context};k(e.pristine)&&(Nt(i,"b",e.pristine),s=!0),w(e.reference)&&(Nt(i,"c",e.reference),s=!0),n>0&&(Nt(i,"d",n),s=!0),E(e.time)&&(Nt(i,"e",e.time),s=!0),w(e.display)&&(Nt(i,"f",e.display),s=!0),s&&t.push(i)}})),t.length>0)return{a:this.slot.id,b:t}}restore(t){t.a===this.slot.id&&X(t.b,(t=>{this.create(t.a,!1,void 0,t)}))}freeze(){X(this.m_pValues,(t=>{t&&t.freeze()}))}unfreeze(){X(this.m_pValues,(t=>{t&&t.unfreeze()}))}importValue(t,e){this.assert(t,!0).import(e.value,e.reference,e.display,e.time,!this.m_pInstance.isInitialized)}import(t){X(t,((t,e)=>this.importValue(e,t)),{keys:!0})}hasValue(t){return this.immutableValues(t).length>0}getValue(t){const e=this.immutableValues(t);if(e.length>0){const t=e[0].slot;if(t instanceof ys)return!!lt(e,(t=>!0===t.value));if(t instanceof ks||t instanceof Ss){let t;return X(e,(e=>{E(e.value)&&(t=(t||0)+e.value)})),t}}}getString(t,e,s,n){const i=[];let r,a;return X(this.immutableValues(t),(t=>{if(!(s&&t.slot instanceof ys&&!0!==t.value))if(s&&t.slot.pipeable&&!A(t.slot.pipeable)&&t.slot.pipeable.content&&"value"!==t.slot.pipeable.content){const e=t.slot.pipeable.content;i.push(("name"===e?t.slot.name:"label"===e?t.slot.label:e.string)||"")}else if(t.slot instanceof ks||t.slot instanceof Ss)a=t.slot,E(t.value)&&(r=(r||0)+t.value);else{const s=n&&n(t,e)||t.display||t.string||"";s&&i.push(s)}})),a&&E(r)&&i.push(a.toString(r)),i}getContent(t,e,s,n,i){const r=[];let a,o;return X(this.immutableValues(t),(t=>{if(!(s&&t.slot instanceof ys&&!0!==t.value))if(s&&t.slot.pipeable&&!A(t.slot.pipeable)&&t.slot.pipeable.content&&"value"!==t.slot.pipeable.content){const e=t.slot.pipeable.content;"name"===e?r.push({value:t.slot.name||"",type:"string",separator:n}):"label"===e?r.push({value:t.slot.label||"",type:"string",separator:n}):e.markdown?r.push({value:e.markdown,type:"markdown",separator:n}):e.text&&r.push({value:e.text,type:"text",separator:n})}else t.slot instanceof ks||t.slot instanceof Ss?(o=t.slot,E(t.value)&&(a=(a||0)+t.value)):r.push({value:i&&i(t,e)||t.display||t.string||"",type:"string",separator:n})})),o&&E(a)&&r.push({value:o.toString(a),type:"string",separator:n}),r}getRefs(t,e){const s=[];return X(this.immutableValues(t),(t=>{e&&t.slot instanceof ys&&!0!==t.value||s.push(t.hasValue&&t.reference||t.slot.reference)})),s}inherit(t){X(this.m_pValues,((e,s)=>{e&&e.subscribe((n=>{t.data.each((t=>{if(t.slot.id===this.slot.id){const i=t.m_pValues[s];return i&&(i.set(n.pristine,n.reference),e.unsubscribe(this)),!0}return!1}))}),this,"synchronous")}),{keys:!0})}}As.m_pContexts={};class Fs extends me{constructor(t,e,s){super(),this.m_pValues={},e.states.each((n=>{n.transducers.each((n=>{n.slots.each((i=>{this.forSlot(i)||As.pushToMatrix(new As(n,i,t,e,s),this)}))}))}))}get exportables(){const t=[];return this.each((e=>{W(e.slot.exportable,!e.slot.actionable)&&t.push(e)})),t}get hasSealedValues(){return this.each((t=>t.hasSealedValues))}forSlot(t){const e=t instanceof _s?t.id:C(t)?t.slot.id:t;if(e){let t=this.m_pValues[e];return t||(this.each((s=>s.slot.id===e&&(t=s,!0))),Nt(this.m_pValues,e,t)),t}}freeze(){this.each((t=>t.freeze()))}unfreeze(){this.each((t=>t.unfreeze()))}}!function(t){t[t.None=0]="None",t[t.OntologyInvalidState=1]="OntologyInvalidState",t[t.OntologyInvalidTransducer=2]="OntologyInvalidTransducer",t[t.OntologyInvalidBranch=4]="OntologyInvalidBranch",t[t.OntologyInvalidCondition=8]="OntologyInvalidCondition",t[t.OntologyInvalidJump=16]="OntologyInvalidJump",t[t.ResumeInvalidHash=32]="ResumeInvalidHash",t[t.ResumeInvalidData=64]="ResumeInvalidData",t[t.ResumeInvalidStack=128]="ResumeInvalidStack"}(ws||(ws={}));class Os extends qe{constructor(t,e,s,n){super(),this.m_pTransducer=t,this.m_pContext=e,this.m_bEnabled=s,this.m_nValidates=0,this.m_bPass=n}get transducer(){return this.m_pTransducer}get isEnabled(){return this.m_bEnabled}get isPassed(){return!0===this.m_bPass}get isFailed(){return!1===this.m_bPass}validate(t,e,s,n,i){const r=++this.m_nValidates;if(t&&this.isEnabled){const a=A(this.m_bPass),o=this.transducer.shouldVerifySeal(this.m_pContext);if(!a||o)return t.evaluate(es.of({await:t=>{if(this.m_pGuard&&this.m_pGuard.cancel(),this.m_pGuard=t,this.transducer.isAwaiting(this.m_pContext))return t;this.transducer.onBeforeValidate(this.m_pContext);const e=s||this.transducer.onValidate(this.m_pContext,!0===this.m_bPass?"pass":!1===this.m_bPass?"fail":"unknown",t);return e instanceof es&&e.isAlive?this.transducer.seal(this.m_pContext,!1):this.m_pGuard=void 0,e},promise:s=>{this.m_pGuard=void 0,r===this.m_nValidates&&n(s)&&(this.m_bPass=W(s.payload),this.transducer.seal(this.m_pContext,this.m_bPass),this.transducer.onValidated(this.m_pContext,this.m_bPass?"pass":"fail",a?"revalidate":e),i()),t.evaluate(s,this.m_pContext,n)}}),this.m_pContext,n),!0;this.transducer.seal(this.m_pContext,this.m_bPass||!1)}return!1}invalidate(){this.m_bPass=void 0,this.transducer.seal(this.m_pContext,!1)}cancel(){this.m_nValidates++,this.transducer.await=void 0,this.transducer.seal(this.m_pContext,!1)}snapshot(){const t=Zt.convert(this.isEnabled,A(this.m_bPass),this.m_bPass||!1);if(t>0)return{a:this.transducer.id,b:t}}}class Ls extends me{constructor(){super(...arguments),this.m_pCache=[]}get transducers(){const t=[];return this.each((e=>{e.isEnabled&&t.push(e.transducer)})),t}get isEnabled(){return this.each((t=>t.isEnabled))}get isPassed(){return!this.each((t=>t.isEnabled&&!t.isPassed))}create(t,e,s){return this.pushToMatrix(new Os(t,e,s))}resume(t,e,s){return this.pushToMatrix(new Os(t,e,Zt.has(s.b,1),Zt.has(s.b,2)?Zt.has(s.b,3):void 0))}forTransducer(t){let e;return this.each((s=>s.transducer===t&&(e=s,!0))),e||ut(this.m_pCache,(e=>e.transducer===t))}clear(){this.each((t=>{this.m_pCache.push(t)})),super.clear()}}class Bs extends qe{static create(t,e,s,n=void 0,i=void 0,r=void 0,a=void 0,o=void 0,h=0,l=0,u=!1,c=!1,m=void 0,p=!1,d=void 0){return t.pushToMatrix(new Bs(e,n,s,i,r,a,o,h,l,u,c,m,p,d))}constructor(t,e,s,n,r,a,o,h,l,u,c,m,p,d,g){super(),this.m_pChecksum=new i,this.m_nChecksum=0,this.m_bCanceled=!1,this.m_pOrchestrator=t,this.m_pAncestor=e,this.m_pState=s,this.m_pBranch=n,this.m_pBranched=a,this.m_bBranching=p,this.m_nBranch=d,this.m_fnBranch=g,this.m_pCondition=r,this.m_pValidators=o||new Ls,this.m_nOpcode=h,this.m_nCounter=l,this.m_nSize=0,this.m_bReturn=u,this.m_bReturnOverride=c,this.m_pReturn=m,this.m_bValidated=!1,this.m_nValidations=0,this.m_bPass=!1,this.m_bEntered=!1,this.m_sChecksum=(s&&s.id||"")+(n&&r&&"each"===n.culling?r.id:"")}get orchestrator(){return this.m_pOrchestrator}get assertPromise(){return t=>this.assert(t)}get stack(){return this.matrix()}get successorMode(){return this.orchestrator.preview?"preview":"live"}get id(){return this.hash}get instance(){return this.orchestrator.instance}get ancestor(){return this.m_pAncestor}get trace(){var t;return((null===(t=this.ancestor)||void 0===t?void 0:t.trace)||"")+this.id}get state(){return this.m_pState}get transducers(){return this.m_pValidators.transducers}get branch(){return this.m_pBranch}get branchIndex(){return this.m_nBranch||1}get condition(){return this.m_pCondition}get mutableContext(){return this.condition&&"each"===this.condition.branch.culling&&this.condition.branch.conditions.count>1&&this.condition||void 0}get immutableContext(){return this.condition}get checksum(){return this.m_sChecksum+this.m_nChecksum}get isBranch(){return this.m_bBranching}get isScheduled(){return 9===this.m_nOpcode}get isAtFinish(){return this.isPopped||9===this.m_nOpcode&&this.m_bReturn&&!this.m_pReturn}get isEvaluating(){return 2===this.m_nOpcode||5===this.m_nOpcode||(3===this.m_nOpcode||9===this.m_nOpcode)&&this.m_nCounter>0||8===this.m_nOpcode}create(t,e,s,n,i){return this.stack.pushToMatrix(new Bs(this.orchestrator,t,e,s,n,void 0,void 0,0,0,!1,!1,void 0,!1,void 0,i),{index:this.index+(this.isPopped?0:1),recalculate:!0,emit:"push"})}assert(t){return t.isAsynchronous&&(this.m_nSize=0),!this.isPopped&&!this.m_bCanceled}validate(t){const e=++this.m_nValidations;if(t||this.m_pValidators.clear(),this.state){const s=this.state,n=new Es(this,this.orchestrator.chain);if(this.orchestrator.validate(s,n,this.m_pValidators.isPassed))s.evaluate(es.of({await:t=>this.orchestrator.preview||s.onValidate(n,this.m_bValidated?this.m_bPass?"pass":"fail":"unknown",t),promise:i=>{if(e===this.m_nValidations&&this.assert(i)){const e=i.payload||!1,s=!this.m_bValidated||this.m_bPass!==e,r=this.m_bValidated;this.m_bValidated=!0,this.m_bPass=e,t&&(t.condition=e),s&&this.state&&(this.state.onValidated(n,e?"pass":"fail",r?"revalidate":"initial"),e&&this.orchestrator.validated(this.state)),t||this.step(e?7:3)}s.evaluate(i,n,this.assertPromise)}}),n,this.assertPromise);else{const e=!this.m_bValidated||this.m_bPass,s=this.m_bValidated;this.m_bValidated=!0,this.m_bPass=!1,t&&(t.condition=!1),e&&this.state.onValidated(n,"fail",s?"revalidate":"initial")}}}return(t,e){this.m_nCounter--,!t||this.m_bReturnOverride&&!this.m_bReturn||(this.m_bReturn=!this.m_bReturnOverride||e===this.m_pReturn,this.m_pReturn=e,this.m_bReturnOverride=!0),this.step()}step(t){if(!this.isPopped){const e=new Es(this,this.orchestrator.chain);if(this.m_nSize>1024)return this.m_nSize=0,this.orchestrator.cycle(!0),void dt((()=>{this.orchestrator.cycle(!1),this.step(t)}));switch(this.m_nSize++,this.m_nChecksum=this.m_pChecksum.n,this.m_nOpcode=I(t)?t:this.m_nOpcode,this.m_nOpcode){case 0:if(this.m_bReturnOverride=!1,this.branch){const t=this.branch,s=this.state,n=t=>{s&&s.evaluate(t,e,this.assertPromise)};this.m_nOpcode=1,n(es.of({await:s=>this.orchestrator.preview||t.onCondition(e,s),promise:s=>{if(this.assert(s))if(this.m_nOpcode=2,this.m_nCounter=0,s.payload)if(this.m_nCounter="each"!==t.culling?t.conditions.count:this.condition?1:0,1===this.m_nCounter&&"each"===t.culling&&this.condition){const s=this.condition;n(es.of({await:t=>this.orchestrator.preview?!this.orchestrator.previewCompact||0===s.index:s.onCondition(e,t),promise:i=>{this.assert(i)&&(this.m_nCounter=0,this.m_bReturn=this.m_bReturn||i.payload||!1,i.payload&&(this.m_fnBranch&&!this.m_nBranch&&(this.m_nBranch=this.m_fnBranch()),s.onApproved(e),t.onReady(e)),this.step()),n(i)}}))}else this.m_nCounter>0?t.conditions.each((s=>(n(es.of({await:t=>this.orchestrator.preview||s.onCondition(e,t),promise:i=>{this.assert(i)&&this.m_nCounter>0&&("all"!==t.culling&&"none"!==t.culling&&i.payload?(this.m_pCondition=s,this.m_bReturn=!0,this.m_nCounter=0,s.onApproved(e),t.onReady(e)):this.m_nCounter--,"all"!==t.culling&&"none"!==t.culling||(("none"!==t.culling||this.orchestrator.preview?!i.payload:i.payload)?(this.m_bReturn=!1,this.m_nCounter=0):0===this.m_nCounter&&(this.m_bReturn=!0,s.onApproved(e),t.onReady(e))),this.step()),n(i)}})),0===this.m_nCounter))):(t.onReady(e),this.m_bReturn=!0,this.step());else this.step();n(s)}}))}else this.state?this.step(4):this.step(10);break;case 1:case 5:case 6:case 8:break;case 2:if(0===this.m_nCounter){if(this.branch)if(this.m_bReturn){if(this.m_pReturn=this.branch.entry(this.successorMode),!this.branch.spawn){this.step(9);break}this.m_bReturn=!1,this.m_pReturn&&this.orchestrator.spawn(this.m_pReturn)}else this.branch.onSkip(e);this.step(10)}break;case 4:if(this.state){const t=this.state;this.m_nOpcode=5,this.m_pReturn=this.state.successor(this.successorMode),this.m_bReturn=!0,t.transducers.each((t=>t.seal(e,!1))),t.evaluate(es.of({await:s=>this.orchestrator.preview||t.onEnterCondition(e,s),promise:s=>{this.assert(s)&&(s.payload?(this.m_nOpcode=3,this.m_nCounter=t.transducers.count,this.m_pValidators.clear(),this.m_nCounter>0?t.transducers.each((s=>{t.evaluate(es.of({await:t=>this.orchestrator.preview||s.onEnterCondition(e,t),promise:n=>{this.assert(n)&&(this.m_pValidators.create(s,e,n.payload||!1),this.m_nCounter--,this.step()),t.evaluate(n,e,this.assertPromise)}}),e,this.assertPromise)})):this.step()):(t.onSkip(e),this.step(9))),t.evaluate(s,e,this.assertPromise)}}),e,this.assertPromise)}else this.step(10);break;case 3:if(this.state){if(0===this.m_nCounter)if(this.m_nOpcode=6,this.state.isMain)this.step(7);else{let t=!1;this.m_bValidated=!1,this.m_bPass=!1,this.m_bEntered=!0;const s=ss.for({await:t=>{if(this.state)return this.orchestrator.snapshot.push(),this.state.await=t,this.state.emitHook("OnEnter",{state:this.state,context:e}),this.state.onEnter(e,t)},promise:e=>{this.assert(e)&&(this.state&&(this.state.await=void 0),e.isCanceled?(this.m_nValidations++,this.m_pValidators.each((t=>t.cancel())),this.orchestrator.cancel()):t?this.step(7):this.validate())},conditional:!0});s.isAlive&&(this.m_pValidators.each((n=>{n.isEnabled?(ss.for({await:t=>(n.transducer.emitHook("OnEnter",{transducer:n.transducer,context:e}),n.transducer.await=t,n.transducer.onEnter(e,t)),promise:t=>{this.assert(t)&&t.isAsynchronous&&n.validate(this.state,"revalidate",this.orchestrator.preview,this.assertPromise,(()=>this.validate(s)))},continuous:!0}),t=n.validate(this.state,"initial",this.orchestrator.preview,this.assertPromise,(()=>this.validate(s)))||t):n.transducer.onSkip(e)})),t||(this.validate(s),t=!0))}}else this.step(10);break;case 7:if(this.state){const t=this.state;this.m_nOpcode=8,t.evaluate(es.of({await:s=>!!t.isMain||t.onLeaveCondition(e,s),promise:s=>{if(this.assert(s))if(s.payload)if(t.isMain||(this.m_pValidators.count>0&&this.orchestrator.snapshot.make(),this.m_bEntered=!1,this.m_pValidators.each((t=>{t.isEnabled&&t.transducer.onLeave(e)})),t.onLeave(e)),this.m_nOpcode=9,t.branches.count>0){if(t.branches.each((t=>{this.m_nCounter+="each"===t.culling&&t.conditions.count>0?t.conditions.count:1})),this.m_nCounter>0){const e=this.orchestrator.pointer.get();t.branches.each((t=>{if(this.m_bBranching=!t.isLast,e&&e===this.orchestrator.pointer.get()&&this.orchestrator.pointer.release(),"each"===t.culling&&t.conditions.count>0){const e=[],s=()=>++n;let n=0;t.conditions.each((n=>{e.push(this.create(this,this.state,t,n,s))})),X(e,(t=>t.step()))}else this.create(this,this.state,t).step()}))}}else this.step();else this.m_nOpcode=6,ss.for({await:t=>this.state&&this.state.onLeaveError(e,t),promise:t=>{this.assert(t)&&this.step(7)}});t.evaluate(s,e,this.assertPromise)}}),e,this.assertPromise)}else this.step(10);break;case 9:if(0===this.m_nCounter&&this.orchestrator.pointer.assure(this)===this){if(this.branch&&(this.m_pBranched=this.branch,this.branch.onEnter(e)),this.m_pReturn){const t=this.ancestor&&this.ancestor.state,e=t&&t.successor(this.successorMode);if(!t||this.m_pReturn.uniqueId>t.uniqueId&&(!e||this.m_pReturn.uniqueId<e.uniqueId)){this.m_pState=this.m_pReturn,this.m_pBranch=void 0,this.m_sChecksum+=this.m_pReturn.id,this.step(0);break}}this.step(10)}break;case 10:this.m_pBranched&&(this.m_pBranched.onLeave(e),this.m_pBranched=void 0),this.orchestrator.logger(this,this.ancestor,this.state,this.branch,this.condition,this.m_bReturn?this.m_pReturn||!0:void 0),this.pop(),this.orchestrator.pointer.get()===this&&this.orchestrator.pointer.release(),this.ancestor&&this.ancestor.return(this.m_bReturn,this.m_pReturn)}}}invalidate(t){const e=this.m_pValidators.forTransducer(t);e&&e.invalidate()}validationOf(t){const e=this.m_pValidators.forTransducer(t);if(e){if(e.isPassed)return"pass";if(e.isFailed)return"fail"}return"unknown"}cancel(){this.m_bCanceled=!0}destroy(){if(this.isPopped&&this.state&&!this.state.isMain){const t=new Es(this,this.orchestrator.chain);this.m_bEntered&&(this.m_pValidators.each((e=>{e.isEnabled&&e.transducer.onCancel(t)})),this.state&&this.state.onCancel(t)),this.m_pBranched&&this.m_pBranched.onCancel(t)}}snapshot(){const t={a:this.id},e=Zt.convert(this.m_bReturn,this.m_bReturnOverride,this.m_bBranching);let s=0;switch(this.m_nOpcode){case 2:0===this.m_nCounter&&(s=2);break;case 4:case 5:s=4;break;case 3:s=0===this.m_nCounter?3:4;break;case 6:case 7:case 8:s=3;break;case 9:s=9,this.m_nCounter>0&&Nt(t,"b",this.m_nCounter);break;case 10:s=10}if(s>0&&Nt(t,"c",s),e>0&&Nt(t,"d",e),this.ancestor&&Nt(t,"e",this.ancestor.id),this.state&&Nt(t,"f",this.state.id),this.branch&&Nt(t,"g",this.branch.id),this.m_pBranched&&Nt(t,"h",this.m_pBranched.id),this.condition&&Nt(t,"i",this.condition.id),this.m_pReturn&&Nt(t,"j",this.m_pReturn.id),this.m_pValidators.count>0){const e=[];this.m_pValidators.each((t=>{const s=t.snapshot();s&&e.push(s)})),e.length>0&&Nt(t,"k",e)}return this.m_nBranch&&Nt(t,"l",this.m_nBranch),t}}class Rs extends me{constructor(){super(),this.m_sChecksum="0",this.isParsing=!1,this.hook("OnItemPop","synchronous",(t=>{const e=t.item;this.m_sChecksum+="/"+e.checksum,e.destroy()}))}get checksum(){let t=this.m_sChecksum;return this.each((e=>{t+="/"+e.checksum})),t}clear(){super.clear(),this.m_sChecksum=""}}class Hs{constructor(t,e,s){this.m_pTransducers=[];const n=s||new Rs,i={};let r=!1;this.m_pOrchestrator=t,Nt(n,"isParsing",!0),n.clear(),X(e.a,(e=>{const s=new Ls,a=t.chain.state(e.f||""),o=t.chain.branch(e.g||""),h=t.chain.branch(e.h||""),l=t.chain.condition(e.i||""),u=t.chain.state(e.j||"");let c;e.e&&(c=i[e.e],r=r||!(c instanceof Bs));const m=e.d||0,p=new Es(Nt(i,e.a,Bs.create(n,t,a,c,o,l,h,s,e.c,e.b,Zt.has(m,1),Zt.has(m,2),u,Zt.has(m,3),e.l)),t.chain);X(e.k,(e=>{const n=t.chain.transducer(e.a);n&&s.resume(n,p,e).isEnabled&&this.m_pTransducers.push(n)})),r=r||s.count!==B(e.k)})),Nt(n,"isParsing",!1),r||(e.b?this.m_pPointer=i[e.b]:this.m_pPointer=n.firstItem)}get pointer(){return this.m_pPointer}get context(){return this.pointer&&new Es(this.pointer,this.m_pOrchestrator.chain)}get state(){return this.pointer&&this.pointer.state}get transducers(){const t=this.state;return t?ht(this.m_pTransducers,(e=>e.state.id===t.id)):[]}}class Vs extends qe{constructor(s,n,i,r,a){if(super(),this.m_pStack=new Rs,this.m_pMomentsCache={},this.m_pChecksums={},this.m_pCache={},this.m_nChecksum=0,this.m_pHistory=[],this.m_pSnapshots=[],this.m_nSnapshots=0,this.m_nSnapshot=0,this.m_pChanges={},this.m_pChangesBuffer={},this.m_pFailed={},this.m_nEvents=0,this.m_bInitialized=!1,this.m_bRunning=!1,this.m_bProcessing=!1,this.m_bIsAtFinish=!1,this.m_bStopped=!0,this.m_bPaused=!1,this.m_nErrors=ws.None,this.m_nTransaction=0,this.m_nAutoPushForward=0,this.m_pOrchestrator=s,this.m_bAllowConcurrency="multi"===n,this.m_bAutoPushForward=s.autoPushForward,this.m_bIgnoreValidation=s.ignoreValidation,this.m_sPreviewMode=s.preview,this.m_pStackOrchestrator={instance:this,get preview(){return"disabled"!==s.preview},get previewCompact(){return"compact"===s.preview},spawn:t=>s.spawn(new Vs(s,"multi",t),this.index+(this.isPopped?0:1)).start(),validate:(t,e,n)=>{const i=t.id,r=e.key,a=i+r;return n?delete this.m_pFailed[a]:this.m_pFailed[a]={state:i,context:r},s.ignoreValidation||n},validated:t=>{(s.autoPushForward||this.isPreview||this.m_pOrchestrator.events.onInstanceStepForward(this,t))&&(this.m_bProcessing=!0,this.m_pOrchestrator.events.onInstanceProcessing(this,!0),this.pushForward())},cycle:t=>{this.m_bProcessing=t,this.m_pOrchestrator.events.onInstanceProcessing(this,t)},cancel:()=>{!this.isRunning||s.autoPushForward||this.isPreview||this.stepBackward()||this.stop()},snapshot:{push:()=>{this.m_pSnapshot&&(this.m_pSnapshots.length>this.m_nSnapshots&&this.m_pSnapshots.splice(this.m_nSnapshots),this.m_pSnapshots.push(this.m_pSnapshot),this.m_nSnapshots++,this.m_pSnapshot=void 0,this.map(!0))},make:()=>{const t={a:this.stackSnapshots(),b:this.m_pPointer&&this.m_pPointer.id};this.m_pSnapshot={moment:t,stack:new Hs(this.m_pStackOrchestrator,t)}}},pointer:{get:()=>this.m_pPointer,assure:t=>(this.m_pPointer||this.bind(t),this.m_pPointer),release:()=>this.release()},chain:s.chain,logger:(t,n,i,r,a,o)=>{if(s.logger&&n){const s=o instanceof is?e.padLeft(o.uniqueId,"0",4):o?"End":"-";this.logger(`Return<${s}> to Stack<${e.padLeft(n.uniqueId,"0",4)}>`,i,r,a,t)}}},this.m_pData=new Fs(this,s,(t=>{var e,s;const n=this.m_pOrchestrator.dependencies(t.slot);if(this.m_pEvents||(this.m_pEvents={},this.m_nEvents=kt((()=>{this.isPreview?this.m_pOrchestrator.events.onInstanceUpdate(this):X(et(this.m_pEvents,(t=>({id:t.id,transducer:t.transducer}))).sort(((t,e)=>t.id-e.id)),(t=>this.goto(t.id,t.transducer))),this.m_pEvents=void 0,this.m_pSideEffects=void 0}))),X(n,((t,e)=>{this.setChanged(e)}),{keys:!0}),this.m_pTransaction&&this.m_pTransaction.state.id!==t.transducer.state.id)this.m_pTransaction&&this.m_pTransaction.state.index<t.transducer.state.index&&(null===(s=null===(e=t.context)||void 0===e?void 0:e.mutableValueOf(t.slot))||void 0===s||s.precursor());else if(this.m_pEvents[t.key+t.id]=t,t.context){const e=t.context;t.transducer.parent.each((s=>{if(!(!1!==n[s.id]||s===t.transducer||this.m_pSideEffects&&this.m_pSideEffects[t.transducer.id]&&this.m_pSideEffects[t.transducer.id][s.id])){const n=this.m_pSideEffects||(this.m_pSideEffects={});(n[t.transducer.id]||(n[t.transducer.id]={}))[s.id]=!0,s.onSideEffect(e,t.transducer)}}))}this.m_pOrchestrator.events.onInstanceData(this,t)})),this.m_pStack.hook("OnItemPush","synchronous",(t=>{this.m_bIsAtFinish=!1,this.m_bInitialized||(a&&a(this),this.m_bInitialized=!0,this.emitHook("OnCreate",{instance:this}),this.m_pOrchestrator.events.onInstanceCreate(this),this.logger("Created")),this.logger("Push",t.item.state,t.item.branch,t.item.condition,t.item)})),this.m_pStack.hook("OnItemPop","synchronous",(t=>{if(this.logger("Pop",t.item.state,t.item.branch,t.item.condition,t.item),t.item.destroy(),!this.m_pStack.isParsing)if(this.m_pStack.count>0){if(this.m_pPointer===t.item&&this.isRunning){let t;this.release(),this.m_pStack.reverseEach((e=>(t&&t!==e.ancestor||(t=e.ancestor,e.isScheduled&&this.bind(e).step()),this.m_pPointer instanceof Bs)))}}else this.m_bIsAtFinish=!0,this.map(!1),s.autoPushForward||this.isPreview||this.finish()})),this.hook("OnItemPop","synchronous",(()=>{if(this.m_bRunning){const t=this.presentMoment,e=this.isPaused?"paused":this.isStopped?"stopped":"finished";this.m_bRunning=!1,"finished"!==e&&t&&t.state.await&&t.state.await.cancel(),this.release(),this.m_pStack.clear(),this.m_pSnapshots.splice(0),this.m_pHistory.splice(0),this.m_nSnapshots=0,this.m_nSnapshot=0,this.m_pSnapshot=void 0,this.isPaused?(this.emitHook("OnPause",{instance:this}),this.m_pOrchestrator.events.onInstancePause(this),this.logger("Pause")):this.isStopped?(this.emitHook("OnStop",{instance:this}),this.m_pOrchestrator.events.onInstanceStop(this),this.logger("Stop")):(this.emitHook("OnFinish",{instance:this}),this.m_pOrchestrator.events.onInstanceFinish(this),this.logger("Finish")),this.emitHook("OnEnd",{instance:this,type:e}),this.m_pOrchestrator.events.onInstanceEnd(this,e),this.logger("End")}})),i&&(Bs.create(this.m_pStack,this.m_pStackOrchestrator,i),this.m_pInitial={a:this.stackSnapshots()},r))if(r.a===this.fingerprint){const e=B(r.b);if(e>0){const s=t.range(j(r.d,e-1),0,e-1);let n=0;X(r.c,(t=>{const e=this.data.forSlot(t.a);e?e.restore(t):this.m_nErrors|=ws.ResumeInvalidData})),X(r.b,(t=>{const e=new Hs(this.m_pStackOrchestrator,t),i=e.state,r=e.context;i&&r&&(this.m_pSnapshots.push({moment:t,stack:e}),this.m_nSnapshots+=this.addMoment(this.m_pHistory,t,i,e.transducers,r,n<s?"past":n>s?"future":"present")),n++})),this.revert(s)}else this.m_nErrors|=ws.ResumeInvalidStack}else this.m_nErrors|=ws.ResumeInvalidHash}get successorMode(){return this.isPreview?"preview":"live"}get id(){return this.hash}get l10n(){return this.m_pOrchestrator.l10n}get fingerprint(){return this.m_pOrchestrator.fingerprint}get allowConcurrency(){return this.m_bAllowConcurrency}get isPreview(){return"disabled"!==this.m_pOrchestrator.preview}get isInitialized(){return this.m_bInitialized}get isRunning(){return this.m_bRunning}get isStopped(){return this.m_bStopped}get isPausing(){return this.m_pOrchestrator.states.ontology.isPausing}get isPaused(){return this.m_bPaused}get isAtStart(){return 0===this.m_nSnapshots}get isAtHead(){const t=this.history,e=R(t,t.length-1);return e&&"present"===e.tense||!1}get isAtFinish(){return!!this.m_bIsAtFinish||!this.m_pOrchestrator.autoPushForward&&!this.isPreview&&(this.m_pPointer instanceof Bs&&(!this.m_pPointer.state||!this.m_pPointer.state.successor(this.successorMode)&&!this.m_pPointer.state.branches.each((t=>t.entry(this.successorMode)instanceof is)))&&!this.m_pStack.reverseEach((t=>this.m_pPointer!==t&&(t.isBranch||!t.isAtFinish))))}get isFinishable(){return!this.isPreview&&this.isRunning&&this.isAtFinish&&!lt(this.m_pFailed,(t=>!!lt(this.m_pHistory,(e=>e.state.id===t.state&&e.context.key===t.context))))}get isFinishing(){return!!this.m_fnFinishing}get isFinished(){return!this.isRunning&&!this.isPaused&&!this.isStopped}get finishReference(){return this.m_sFinishReference||""}get hasDataCollected(){return this.data.hasSealedValues}get lookup(){return this.m_pOrchestrator.chain}get data(){return this.m_pData}get history(){return this.map(!1)}get checksum(){const t=`${this.m_nChecksum}/${this.m_pStack.checksum}`;return this.m_pChecksums[t]||(this.m_pChecksums[t]=ze(t))}get presentMoment(){return ut(this.history,(t=>"present"===t.tense))}get snapshot(){const t=this.history,e={a:this.fingerprint,b:[]};if(X(t,(s=>{"present"===s.tense&&e.b.length+1<t.length&&Nt(e,"d",e.b.length),e.b.push(s.snapshot)})),this.data.count>0){const t=[];this.data.each((e=>{const s=e.snapshot();s&&t.push(s)})),t.length>0&&Nt(e,"c",t)}return this.allowConcurrency&&Nt(e,"e",!0),e}get errors(){return this.m_nErrors}setChanged(t){this.m_pChanges[t]=!0,this.m_pChangesBuffer[t]&&delete this.m_pChangesBuffer[t]}logger(t,s,n,i,r){if(this.m_pOrchestrator.logger){const a=s?e.padLeft(s.uniqueId,"0",4):"----",o=n?e.padLeft(n.uniqueId,"0",4):"----",h=i?e.padLeft(i.uniqueId,"0",4):"----",l=r?e.padLeft(r.uniqueId,"0",4):"----";this.m_pOrchestrator.logger(`Instance<${e.padLeft(this.uniqueId,"0",4)}> | State<${a}> Branch<${o}> Condition<${h}> | Stack<${l}> | ${t}`)}}cancelPromises(){this.m_bProcessing&&(this.m_pOrchestrator.events.onInstanceProcessing(this,!1),this.m_bProcessing=!1),this.m_nAutoPushForward=Ct(this.m_nAutoPushForward),this.m_nEvents=Ct(this.m_nEvents),this.m_pEvents=void 0,this.m_fnFinishing&&(this.m_fnFinishing(),this.m_fnFinishing=void 0)}bind(t){return this.m_pPointer=t,this.m_pPointer}release(){this.m_pPointer=void 0}restore(t,e){this.m_pSnapshot=void 0;const s=new Hs(this.m_pStackOrchestrator,t,this.m_pStack);return this.m_pPointer&&this.m_pPointer.cancel(),s.pointer?(this.bind(s.pointer),e&&s.pointer.invalidate(e),this.isRunning&&s.pointer.step(),!0):(this.release(),this.isRunning&&this.pop(),!1)}revert(e,s){const n=this.m_pHistory.length;if(0===n)return;this.m_nSnapshots=t.range(e,0,n-1),this.m_nSnapshot=this.m_nSnapshots>0&&n>0?this.m_nSnapshots-1:0;for(let t=n-1;t>=0&&!(t<this.m_nSnapshots&&"past"===this.m_pHistory[t].tense);t--)this.m_pHistory[t].tense=t===this.m_nSnapshots?"present":t<this.m_nSnapshots?"past":"future";const i=this.m_pHistory[this.m_nSnapshots].snapshot,r=s?this.invalidateHistory(this.m_nSnapshots):this.m_pHistory.slice(0,this.m_nSnapshots);this.restore(i,s)&&this.addPointer(r)}goto(t,e){const s=this.getMoment(t);if(s&&this.isRunning){let t="present"===s.tense&&this.m_pPointer&&!s.context.isMutableContextOf(this.m_pPointer)&&this.m_pPointer.isEvaluating;if(!t)if("present"!==s.tense){const e=ut(this.m_pHistory,(t=>"present"===t.tense));(!e||s.index<e.index)&&(t=!0)}else t=this.m_bIsAtFinish;t?this.revert(s.index,e):s.index+1<this.m_pHistory.length&&(this.m_nChecksum++,this.invalidateHistory(s.index+1))}}map(t){if(!this.isRunning)return[];const e=this.m_pHistory.splice(this.m_nSnapshot),s=e.length;let n=0;for(let t=this.m_nSnapshot;t<this.m_nSnapshots;t++){const e=this.m_pSnapshots[t],s=e.stack.state,i=e.stack.context;s&&i&&(n+=this.addMoment(this.m_pHistory,e.moment,s,e.stack.transducers,i,"past"))}if(this.m_pSnapshot){const t=this.m_pSnapshot.stack.state,e=this.m_pSnapshot.stack.context;t&&e&&(n+=this.addMoment(this.m_pHistory,this.m_pSnapshot.moment,t,this.m_pSnapshot.stack.transducers,e,"past"))}let i=this.m_pHistory.length;if(n>0&&(this.m_nSnapshot=i-1),this.m_bIsAtFinish?i>0&&(this.m_pHistory[i-1].tense="present",this.m_nSnapshot=i>1?i-2:0):this.addPointer(this.m_pHistory)&&(n++,i++),n<s)if(!t&&i>0)for(;n<s;){const t=e[n];t.transducers.length>0&&(t.tense="future",this.m_pHistory.push(t)),n++}else{for(;n>0;)e.shift(),n--;this.invalidateMoments(e)}return this.m_pHistory}addPointer(t){var e,s;if(this.m_pPointer){const n=this.m_pPointer;if(n.state)return!(n.isLast&&(null===(s=null===(e=n.ancestor)||void 0===e?void 0:e.state)||void 0===s?void 0:s.isMain)&&lt(t,(t=>t.state===n.state)))&&(this.addMoment(t,{a:this.stackSnapshots(),b:n.id},n.state,n.transducers,new Es(n,this.m_pOrchestrator.chain),"present"),!0)}return!1}addMoment(t,e,s,n,i,r){const a=t.length,o={get checksum(){return Ut(this,"$checksum")||Dt(this,"$checksum",ze(`${i.instance.uniqueId}/${a}/${s.hash}/${i.key}`))},index:a,snapshot:e,state:s,transducers:n,context:i,tense:r,restore:()=>this.isRunning&&this.revert(a)};this.m_pMoments||(this.m_pMoments={});return(this.m_pMoments[s.id]||(this.m_pMoments[s.id]={state:s,moments:{}})).moments[i.id]=o,t.push(o),1}getMoment(t){if(this.m_pMoments){let e;if(X(this.m_pMoments,(s=>{s.state.transducers.each((n=>{n.slots.each((n=>{X(s.moments,(s=>{const i=s.context.mutableValueOf(n);i&&(Nt(this.m_pMomentsCache,i.id,s),i.id===t&&(e=s))}))}))}))})),this.m_pMoments=void 0,e)return e}return this.m_pMomentsCache[t]}invalidateMoments(t){X(t,(t=>{t.state.transducers.each((e=>e.seal(t.context,!1)))}))}invalidateHistory(t){for(this.invalidateMoments(this.m_pHistory.splice(t)),this.m_nSnapshot=this.m_pHistory.length;this.m_nSnapshot&&(this.m_nSnapshot--,"past"!==this.m_pHistory[this.m_nSnapshot].tense););return this.m_pHistory}pushForward(){this.m_nAutoPushForward||(this.m_nAutoPushForward=kt((()=>{var t,e,s,n;const i=!this.m_bIsAtFinish&&!(null===(e=null===(t=this.m_pPointer)||void 0===t?void 0:t.state)||void 0===e?void 0:e.isLast)&&(null===(s=this.m_pPointer)||void 0===s?void 0:s.state)||(null===(n=this.presentMoment)||void 0===n?void 0:n.state);this.m_nAutoPushForward=0,(i&&this.m_pOrchestrator.events.onInstanceStepForward(this,i)||!this.isAtFinish&&(this.m_pOrchestrator.autoPushForward||this.isPreview))&&(this.m_pOrchestrator.events.onInstanceProcessing(this,!1),i&&i.await&&i.await.done())})))}stackSnapshots(){const t=[];return this.m_pStack.each((e=>{t.push(e.snapshot())})),t}closeTransaction(){this.m_nTransaction>0&&(this.m_nTransaction--,0===this.m_nTransaction&&(this.m_pTransaction=void 0))}createTransaction(t,e){this.m_nTransaction++,1===this.m_nTransaction&&(this.m_pTransaction=t);const s=e();return this.closeTransaction(),s}readFromCache(t){return this.m_pCache[t]}writeToCache(t,e){return this.m_pCache[t]=e,e}stencil(t="exportables"){return this.m_pOrchestrator.stencil(t)}start(){if(this.cancelPromises(),!this.isRunning){const t=this.m_pPointer||this.m_pStack.firstItem;if(this.errors===ws.None&&t)return this.m_bRunning=!0,this.m_bStopped=!1,this.m_bPaused=!1,this.emitHook("OnStart",{instance:this}),this.m_pOrchestrator.events.onInstanceStart(this),this.logger("Start"),t.step(),!0;this.pop()}return!1}restart(){const t=this.m_bAutoPushForward!==this.m_pOrchestrator.autoPushForward,e=this.m_bIgnoreValidation!==this.m_pOrchestrator.ignoreValidation,s=this.m_sPreviewMode!==this.m_pOrchestrator.preview;this.cancelPromises(),t||e||s?(this.m_nChecksum++,(t||e)&&(this.m_bAutoPushForward=this.m_pOrchestrator.autoPushForward,this.m_bIgnoreValidation=this.m_pOrchestrator.ignoreValidation,(this.m_pOrchestrator.autoPushForward||this.m_bIsAtFinish)&&this.stepToHead()),s&&(this.m_sPreviewMode=this.m_pOrchestrator.preview,this.isRunning&&this.m_pInitial&&(this.m_pSnapshots.splice(0),this.m_pHistory.splice(0),this.m_nSnapshots=0,this.m_nSnapshot=0,this.restore(this.m_pInitial)))):this.start()||this.stepToStart()}stop(){return this.cancelPromises(),!this.m_bStopped&&(this.m_bStopped=!0,this.pop())}pause(){if(this.isPreview||this.isFinishing||this.isPausing||this.isPaused||!this.isRunning)return;const t=this.snapshot;return this.m_bPaused=!0,this.pop(),t}stepForward(){if(this.isRunning){const t=this.presentMoment;if(t&&t.state.await)return t.state.await.done();if(this.isFinishable)return this.finish(),!1}return!1}stepBackward(){if(this.isRunning){const t=this.presentMoment;if(t&&t.index>0&&t.index<=this.m_pHistory.length)return this.m_pHistory[t.index-1].restore(),!0}return!1}stepToStart(){if(this.isRunning){const t=R(this.history,0);if(t)return t.restore(),!0}return!1}stepToHead(){if(this.isInitialized&&this.isRunning){const t=this.history,e=R(t,t.length-1);if(e)return e.restore(),!0}return!1}finish(){return new Promise(((t,e)=>{if(this.isFinishable&&!this.m_fnFinishing){const s=(s,n)=>{this.m_fnFinishing&&(this.m_fnFinishing=void 0,s&&this.pop()?(this.m_sFinishReference=n,t()):(this.data.unfreeze(),e()))};this.m_fnFinishing=e,this.m_sFinishReference=void 0,this.data.freeze(),this.m_pOrchestrator.events.onInstanceFinishing(this,s)&&s(!0)}else e()})).catch((t=>{this.m_pOrchestrator.logger&&this.m_pOrchestrator.logger(t||"Finish error!")}))}transducers(t){this.m_pOrchestrator.iterate(t)}isTransducerPresent(t){const e=ut(this.m_pHistory,(t=>"present"===t.tense));return!(!e||!lt(e.transducers,(e=>e===t)))}markAsChanged(t,e=!1){X(this.m_pOrchestrator.dependencies(t),((t,s)=>{e&&!t||this.setChanged(s)}),{keys:!0})}hasChanged(t,e=!0){const s=this.m_pOrchestrator.hasChanged(t,e),n=this.m_pChanges[t]||!1;return n&&e&&(0===B(this.m_pChangesBuffer)&&kt((()=>{X(this.m_pChangesBuffer,((t,e)=>{this.m_pChanges[e]=!1,delete this.m_pChangesBuffer[e]}),{keys:!0})})),this.m_pChangesBuffer[t]=!0),s||n}inherit(t){return t.data.each((t=>t.inherit(this))),this}}const Ns={aa:["Afar","Afar"],"aa-DJ":["Afar (Djibouti)","Afar (Djibouti)"],"aa-ER":["Afar (Eritrea)","Afar (Eritrea)"],ab:["Abkhazian","Аԥсшәа"],af:["Afrikaans","Afrikaans"],"af-NA":["Afrikaans (Namibia)","Afrikaans (Namibië)"],agq:["Aghem","Aghem"],ak:["Akan","Akan"],am:["Amharic","አማርኛ"],an:["Aragonese","aragonés"],ann:["Obolo","Obolo"],ar:["Arabic","العربية"],"ar-AE":["Arabic (United Arab Emirates)","العربية (الإمارات العربية المتحدة)"],"ar-BH":["Arabic (Bahrain)","العربية (البحرين)"],"ar-DJ":["Arabic (Djibouti)","العربية (جيبوتي)"],"ar-DZ":["Arabic (Algeria)","العربية (الجزائر)"],"ar-EG":["Arabic (Egypt)","العربية (مصر)"],"ar-EH":["Arabic (Western Sahara)","العربية (الصحراء الغربية)"],"ar-ER":["Arabic (Eritrea)","العربية (إريتريا)"],"ar-IL":["Arabic (Israel)","العربية (إسرائيل)"],"ar-IQ":["Arabic (Iraq)","العربية (العراق)"],"ar-JO":["Arabic (Jordan)","العربية (الأردن)"],"ar-KM":["Arabic (Comoros)","العربية (جزر القمر)"],"ar-KW":["Arabic (Kuwait)","العربية (الكويت)"],"ar-LB":["Arabic (Lebanon)","العربية (لبنان)"],"ar-LY":["Arabic (Libya)","العربية (ليبيا)"],"ar-MA":["Arabic (Morocco)","العربية (المغرب)"],"ar-MR":["Arabic (Mauritania)","العربية (موريتانيا)"],"ar-OM":["Arabic (Oman)","العربية (عُمان)"],"ar-PS":["Arabic (Palestinian Territories)","العربية (الأراضي الفلسطينية)"],"ar-QA":["Arabic (Qatar)","العربية (قطر)"],"ar-SA":["Arabic (Saudi Arabia)","العربية (المملكة العربية السعودية)"],"ar-SD":["Arabic (Sudan)","العربية (السودان)"],"ar-SO":["Arabic (Somalia)","العربية (الصومال)"],"ar-SS":["Arabic (South Sudan)","العربية (جنوب السودان)"],"ar-SY":["Arabic (Syria)","العربية (سوريا)"],"ar-TD":["Arabic (Chad)","العربية (تشاد)"],"ar-TN":["Arabic (Tunisia)","العربية (تونس)"],"ar-YE":["Arabic (Yemen)","العربية (اليمن)"],arn:["Mapuche","Mapudungun"],as:["Assamese","অসমীয়া"],asa:["Asu","Kipare"],ast:["Asturian","asturianu"],az:["Azerbaijani","azərbaycan"],"az-Arab":["Azerbaijani (Arabic)","آذربایجان تۆرکجه‌سی (عربجه)"],"az-Arab-IQ":["Azerbaijani (Arabic, Iraq)","آذربایجان تۆرکجه‌سی (عربجه)"],"az-Arab-TR":["Azerbaijani (Arabic, Türkiye)","آذربایجان تۆرکجه‌سی (عربجه)"],"az-Cyrl":["Azerbaijani (Cyrillic)","азәрбајҹан (Кирил)"],"az-Latn":["Azerbaijani (Latin)","azərbaycan (latın)"],ba:["Bashkir","башҡорт теле"],bal:["Baluchi","بلۆچی"],"bal-Arab":["Baluchi (Arabic)","بلۆچی"],"bal-Latn":["Baluchi (Latin)","بلۆچی"],bas:["Basaa","Ɓàsàa"],be:["Belarusian","беларуская"],"be-tarask":["Belarusian","беларуская"],bem:["Bemba","Ichibemba"],bez:["Bena","Hibena"],bg:["Bulgarian","български"],bgc:["Haryanvi","हरियाणवी"],bgn:["Western Balochi","بلوچی (رخشانی)"],"bgn-AE":["Western Balochi (United Arab Emirates)","بلوچی (رخشانی) (متحدین عربین امارات)"],"bgn-AF":["Western Balochi (Afghanistan)","بلوچی (رخشانی)"],"bgn-IR":["Western Balochi (Iran)","بلوچی (رخشانی)"],"bgn-OM":["Western Balochi (Oman)","بلوچی (رخشانی) (ئومان)"],bho:["Bhojpuri","भोजपुरी"],blt:["Tai Dam","ꪼꪕꪒꪾ"],bm:["Bambara","bamanakan"],"bm-Nkoo":["Bambara (N’Ko)","Bambara (N’Ko)"],bn:["Bangla","বাংলা"],"bn-IN":["Bangla (India)","বাংলা (ভারত)"],bo:["Tibetan","བོད་སྐད་"],"bo-IN":["Tibetan (India)","བོད་སྐད་ (རྒྱ་གར་)"],br:["Breton","brezhoneg"],brx:["Bodo","बर’"],bs:["Bosnian","bosanski"],"bs-Cyrl":["Bosnian (Cyrillic)","босански (ћирилица)"],"bs-Latn":["Bosnian (Latin)","bosanski (latinica)"],bss:["Akoose","Akoose"],byn:["Blin","Blin"],ca:["Catalan","català"],"ca-AD":["Catalan (Andorra)","català (Andorra)"],"ca-ES-valencia":["Catalan (Spain)","català (Espanya)"],"ca-FR":["Catalan (France)","català (França)"],"ca-IT":["Catalan (Italy)","català (Itàlia)"],cad:["Caddo","Caddo"],cch:["Atsam","Atsam"],ccp:["Chakma","𑄌𑄋𑄴𑄟𑄳𑄦"],"ccp-IN":["Chakma (India)","𑄌𑄋𑄴𑄟𑄳𑄦 (𑄞𑄢𑄧𑄖𑄴)"],ce:["Chechen","нохчийн"],ceb:["Cebuano","Cebuano"],cgg:["Chiga","Rukiga"],cho:["Choctaw","Chahta"],chr:["Cherokee","ᏣᎳᎩ"],cic:["Chickasaw","Chikashshanompaʼ"],ckb:["Central Kurdish","کوردیی ناوەندی"],"ckb-IR":["Central Kurdish (Iran)","کوردیی ناوەندی (ئێران)"],co:["Corsican","corsu"],cs:["Czech","čeština"],cu:["Church Slavic","Church Slavic"],cv:["Chuvash","чӑваш"],cy:["Welsh","Cymraeg"],da:["Danish","dansk"],"da-GL":["Danish (Greenland)","dansk (Grønland)"],dav:["Taita","Kitaita"],de:["German","Deutsch"],"de-AT":["German (Austria)","Deutsch (Österreich)"],"de-BE":["German (Belgium)","Deutsch (Belgien)"],"de-CH":["German (Switzerland)","Deutsch (Schweiz)"],"de-IT":["German (Italy)","Deutsch (Italien)"],"de-LI":["German (Liechtenstein)","Deutsch (Liechtenstein)"],"de-LU":["German (Luxembourg)","Deutsch (Luxemburg)"],dje:["Zarma","Zarmaciine"],doi:["Dogri","डोगरी"],dsb:["Lower Sorbian","dolnoserbšćina"],dua:["Duala","duálá"],dv:["Divehi","Divehi"],dyo:["Jola-Fonyi","joola"],dz:["Dzongkha","རྫོང་ཁ"],ebu:["Embu","Kĩembu"],ee:["Ewe","Eʋegbe"],"ee-TG":["Ewe (Togo)","Eʋegbe (Togo nutome)"],el:["Greek","Ελληνικά"],"el-CY":["Greek (Cyprus)","Ελληνικά (Κύπρος)"],"el-polyton":["Greek","Ἑλληνικά"],en:["English","English"],"en-001":["English (world)","English (world)"],"en-150":["English (Europe)","English (Europe)"],"en-AE":["English (United Arab Emirates)","English (United Arab Emirates)"],"en-AG":["English (Antigua & Barbuda)","English (Antigua & Barbuda)"],"en-AI":["English (Anguilla)","English (Anguilla)"],"en-AS":["English (American Samoa)","English (American Samoa)"],"en-AT":["English (Austria)","English (Austria)"],"en-AU":["English (Australia)","English (Australia)"],"en-BB":["English (Barbados)","English (Barbados)"],"en-BE":["English (Belgium)","English (Belgium)"],"en-BI":["English (Burundi)","English (Burundi)"],"en-BM":["English (Bermuda)","English (Bermuda)"],"en-BS":["English (Bahamas)","English (Bahamas)"],"en-BW":["English (Botswana)","English (Botswana)"],"en-BZ":["English (Belize)","English (Belize)"],"en-CA":["English (Canada)","English (Canada)"],"en-CC":["English (Cocos (Keeling) Islands)","English (Cocos (Keeling) Islands)"],"en-CH":["English (Switzerland)","English (Switzerland)"],"en-CK":["English (Cook Islands)","English (Cook Islands)"],"en-CM":["English (Cameroon)","English (Cameroon)"],"en-CX":["English (Christmas Island)","English (Christmas Island)"],"en-CY":["English (Cyprus)","English (Cyprus)"],"en-DE":["English (Germany)","English (Germany)"],"en-DG":["English (Diego Garcia)","English (Diego Garcia)"],"en-DK":["English (Denmark)","English (Denmark)"],"en-DM":["English (Dominica)","English (Dominica)"],"en-Dsrt":["English (Deseret)","𐐀𐑍𐑊𐐮𐑇 (𐐔𐐯𐑆𐐲𐑉𐐯𐐻)"],"en-ER":["English (Eritrea)","English (Eritrea)"],"en-FI":["English (Finland)","English (Finland)"],"en-FJ":["English (Fiji)","English (Fiji)"],"en-FK":["English (Falkland Islands)","English (Falkland Islands)"],"en-FM":["English (Micronesia)","English (Micronesia)"],"en-GB":["English (United Kingdom)","English (United Kingdom)"],"en-GD":["English (Grenada)","English (Grenada)"],"en-GG":["English (Guernsey)","English (Guernsey)"],"en-GH":["English (Ghana)","English (Ghana)"],"en-GI":["English (Gibraltar)","English (Gibraltar)"],"en-GM":["English (Gambia)","English (Gambia)"],"en-GU":["English (Guam)","English (Guam)"],"en-GY":["English (Guyana)","English (Guyana)"],"en-HK":["English (Hong Kong SAR China)","English (Hong Kong SAR China)"],"en-IE":["English (Ireland)","English (Ireland)"],"en-IL":["English (Israel)","English (Israel)"],"en-IM":["English (Isle of Man)","English (Isle of Man)"],"en-IN":["English (India)","English (India)"],"en-IO":["English (British Indian Ocean Territory)","English (British Indian Ocean Territory)"],"en-JE":["English (Jersey)","English (Jersey)"],"en-JM":["English (Jamaica)","English (Jamaica)"],"en-KE":["English (Kenya)","English (Kenya)"],"en-KI":["English (Kiribati)","English (Kiribati)"],"en-KN":["English (St. Kitts & Nevis)","English (St Kitts & Nevis)"],"en-KY":["English (Cayman Islands)","English (Cayman Islands)"],"en-LC":["English (St. Lucia)","English (St Lucia)"],"en-LR":["English (Liberia)","English (Liberia)"],"en-LS":["English (Lesotho)","English (Lesotho)"],"en-MG":["English (Madagascar)","English (Madagascar)"],"en-MH":["English (Marshall Islands)","English (Marshall Islands)"],"en-MO":["English (Macao SAR China)","English (Macao SAR China)"],"en-MP":["English (Northern Mariana Islands)","English (Northern Mariana Islands)"],"en-MS":["English (Montserrat)","English (Montserrat)"],"en-MT":["English (Malta)","English (Malta)"],"en-MU":["English (Mauritius)","English (Mauritius)"],"en-MV":["English (Maldives)","English (Maldives)"],"en-MW":["English (Malawi)","English (Malawi)"],"en-MY":["English (Malaysia)","English (Malaysia)"],"en-NA":["English (Namibia)","English (Namibia)"],"en-NF":["English (Norfolk Island)","English (Norfolk Island)"],"en-NG":["English (Nigeria)","English (Nigeria)"],"en-NL":["English (Netherlands)","English (Netherlands)"],"en-NR":["English (Nauru)","English (Nauru)"],"en-NU":["English (Niue)","English (Niue)"],"en-NZ":["English (New Zealand)","English (New Zealand)"],"en-PG":["English (Papua New Guinea)","English (Papua New Guinea)"],"en-PH":["English (Philippines)","English (Philippines)"],"en-PK":["English (Pakistan)","English (Pakistan)"],"en-PN":["English (Pitcairn Islands)","English (Pitcairn Islands)"],"en-PR":["English (Puerto Rico)","English (Puerto Rico)"],"en-PW":["English (Palau)","English (Palau)"],"en-RW":["English (Rwanda)","English (Rwanda)"],"en-SB":["English (Solomon Islands)","English (Solomon Islands)"],"en-SC":["English (Seychelles)","English (Seychelles)"],"en-SD":["English (Sudan)","English (Sudan)"],"en-SE":["English (Sweden)","English (Sweden)"],"en-SG":["English (Singapore)","English (Singapore)"],"en-SH":["English (St. Helena)","English (St Helena)"],"en-Shaw":["English (Shavian)","English (Shavian)"],"en-SI":["English (Slovenia)","English (Slovenia)"],"en-SL":["English (Sierra Leone)","English (Sierra Leone)"],"en-SS":["English (South Sudan)","English (South Sudan)"],"en-SX":["English (Sint Maarten)","English (Sint Maarten)"],"en-SZ":["English (Eswatini)","English (Eswatini)"],"en-TC":["English (Turks & Caicos Islands)","English (Turks & Caicos Islands)"],"en-TK":["English (Tokelau)","English (Tokelau)"],"en-TO":["English (Tonga)","English (Tonga)"],"en-TT":["English (Trinidad & Tobago)","English (Trinidad & Tobago)"],"en-TV":["English (Tuvalu)","English (Tuvalu)"],"en-TZ":["English (Tanzania)","English (Tanzania)"],"en-UG":["English (Uganda)","English (Uganda)"],"en-UM":["English (U.S. Outlying Islands)","English (U.S. Outlying Islands)"],"en-VC":["English (St. Vincent & Grenadines)","English (St Vincent & the Grenadines)"],"en-VG":["English (British Virgin Islands)","English (British Virgin Islands)"],"en-VI":["English (U.S. Virgin Islands)","English (U.S. Virgin Islands)"],"en-VU":["English (Vanuatu)","English (Vanuatu)"],"en-WS":["English (Samoa)","English (Samoa)"],"en-ZA":["English (South Africa)","English (South Africa)"],"en-ZM":["English (Zambia)","English (Zambia)"],"en-ZW":["English (Zimbabwe)","English (Zimbabwe)"],eo:["Esperanto","esperanto"],es:["Spanish","español"],"es-419":["Spanish (Latin America)","español (Latinoamérica)"],"es-AR":["Spanish (Argentina)","español (Argentina)"],"es-BO":["Spanish (Bolivia)","español (Bolivia)"],"es-BR":["Spanish (Brazil)","español (Brasil)"],"es-BZ":["Spanish (Belize)","español (Belice)"],"es-CL":["Spanish (Chile)","español (Chile)"],"es-CO":["Spanish (Colombia)","español (Colombia)"],"es-CR":["Spanish (Costa Rica)","español (Costa Rica)"],"es-CU":["Spanish (Cuba)","español (Cuba)"],"es-DO":["Spanish (Dominican Republic)","español (República Dominicana)"],"es-EA":["Spanish (Ceuta & Melilla)","español (Ceuta y Melilla)"],"es-EC":["Spanish (Ecuador)","español (Ecuador)"],"es-GQ":["Spanish (Equatorial Guinea)","español (Guinea Ecuatorial)"],"es-GT":["Spanish (Guatemala)","español (Guatemala)"],"es-HN":["Spanish (Honduras)","español (Honduras)"],"es-IC":["Spanish (Canary Islands)","español (Canarias)"],"es-MX":["Spanish (Mexico)","español (México)"],"es-NI":["Spanish (Nicaragua)","español (Nicaragua)"],"es-PA":["Spanish (Panama)","español (Panamá)"],"es-PE":["Spanish (Peru)","español (Perú)"],"es-PH":["Spanish (Philippines)","español (Filipinas)"],"es-PR":["Spanish (Puerto Rico)","español (Puerto Rico)"],"es-PY":["Spanish (Paraguay)","español (Paraguay)"],"es-SV":["Spanish (El Salvador)","español (El Salvador)"],"es-US":["Spanish (United States)","español (Estados Unidos)"],"es-UY":["Spanish (Uruguay)","español (Uruguay)"],"es-VE":["Spanish (Venezuela)","español (Venezuela)"],et:["Estonian","eesti"],eu:["Basque","euskara"],ewo:["Ewondo","ewondo"],fa:["Persian","فارسی"],"fa-AF":["Persian (Afghanistan)","فارسی (افغانستان)"],ff:["Fula","Pulaar"],"ff-Adlm":["Fula (Adlam)","𞤆𞤵𞤤𞤢𞤪 (𞤀𞤁𞤂𞤢𞤃)"],"ff-Adlm-BF":["Fula (Adlam, Burkina Faso)","𞤆𞤵𞤤𞤢𞤪 (𞤀𞤁𞤂𞤢𞤃⹁ 𞤄𞤵𞤪𞤳𞤭𞤲𞤢 𞤊𞤢𞤧𞤮𞥅)"],"ff-Adlm-CM":["Fula (Adlam, Cameroon)","𞤆𞤵𞤤𞤢𞤪 (𞤀𞤁𞤂𞤢𞤃⹁ 𞤑𞤢𞤥𞤢𞤪𞤵𞥅𞤲)"],"ff-Adlm-GH":["Fula (Adlam, Ghana)","𞤆𞤵𞤤𞤢𞤪 (𞤀𞤁𞤂𞤢𞤃⹁ 𞤘𞤢𞤲𞤢)"],"ff-Adlm-GM":["Fula (Adlam, Gambia)","𞤆𞤵𞤤𞤢𞤪 (𞤀𞤁𞤂𞤢𞤃⹁ 𞤘𞤢𞤥𞤦𞤭𞤴𞤢)"],"ff-Adlm-GW":["Fula (Adlam, Guinea-Bissau)","𞤆𞤵𞤤𞤢𞤪 (𞤀𞤁𞤂𞤢𞤃⹁ 𞤘𞤭𞤲𞤫-𞤄𞤭𞤧𞤢𞤱𞤮𞥅)"],"ff-Adlm-LR":["Fula (Adlam, Liberia)","𞤆𞤵𞤤𞤢𞤪 (𞤀𞤁𞤂𞤢𞤃⹁ 𞤂𞤢𞤦𞤭𞤪𞤭𞤴𞤢𞥄)"],"ff-Adlm-MR":["Fula (Adlam, Mauritania)","𞤆𞤵𞤤𞤢𞤪 (𞤀𞤁𞤂𞤢𞤃⹁ 𞤃𞤮𞤪𞤼𞤢𞤲𞤭𞥅)"],"ff-Adlm-NE":["Fula (Adlam, Niger)","𞤆𞤵𞤤𞤢𞤪 (𞤀𞤁𞤂𞤢𞤃⹁ 𞤐𞤭𞥅𞤶𞤫𞤪)"],"ff-Adlm-NG":["Fula (Adlam, Nigeria)","𞤆𞤵𞤤𞤢𞤪 (𞤀𞤁𞤂𞤢𞤃⹁ 𞤐𞤢𞤶𞤫𞤪𞤭𞤴𞤢𞥄)"],"ff-Adlm-SL":["Fula (Adlam, Sierra Leone)","𞤆𞤵𞤤𞤢𞤪 (𞤀𞤁𞤂𞤢𞤃⹁ 𞤅𞤢𞤪𞤢𞤤𞤮𞤲)"],"ff-Adlm-SN":["Fula (Adlam, Senegal)","𞤆𞤵𞤤𞤢𞤪 (𞤀𞤁𞤂𞤢𞤃⹁ 𞤅𞤫𞤲𞤫𞤺𞤢𞥄𞤤)"],"ff-Latn":["Fula (Latin)","Pulaar"],"ff-Latn-BF":["Fula (Latin, Burkina Faso)","Pulaar (Burkibaa Faaso)"],"ff-Latn-CM":["Fula (Latin, Cameroon)","Pulaar (Kameruun)"],"ff-Latn-GH":["Fula (Latin, Ghana)","Pulaar (Ganaa)"],"ff-Latn-GM":["Fula (Latin, Gambia)","Pulaar (Gammbi)"],"ff-Latn-GN":["Fula (Latin, Guinea)","Pulaar (Gine)"],"ff-Latn-GW":["Fula (Latin, Guinea-Bissau)","Pulaar (Gine-Bisaawo)"],"ff-Latn-LR":["Fula (Latin, Liberia)","Pulaar (Liberiyaa)"],"ff-Latn-MR":["Fula (Latin, Mauritania)","Pulaar (Muritani)"],"ff-Latn-NE":["Fula (Latin, Niger)","Pulaar (Nijeer)"],"ff-Latn-NG":["Fula (Latin, Nigeria)","Pulaar (Nijeriyaa)"],"ff-Latn-SL":["Fula (Latin, Sierra Leone)","Pulaar (Seraa liyon)"],fi:["Finnish","suomi"],fil:["Filipino","Filipino"],fo:["Faroese","føroyskt"],"fo-DK":["Faroese (Denmark)","føroyskt (Danmark)"],fr:["French","français"],"fr-BE":["French (Belgium)","français (Belgique)"],"fr-BF":["French (Burkina Faso)","français (Burkina Faso)"],"fr-BI":["French (Burundi)","français (Burundi)"],"fr-BJ":["French (Benin)","français (Bénin)"],"fr-BL":["French (St. Barthélemy)","français (Saint-Barthélemy)"],"fr-CA":["French (Canada)","français (Canada)"],"fr-CD":["French (Congo - Kinshasa)","français (Congo-Kinshasa)"],"fr-CF":["French (Central African Republic)","français (République centrafricaine)"],"fr-CG":["French (Congo - Brazzaville)","français (Congo-Brazzaville)"],"fr-CH":["French (Switzerland)","français (Suisse)"],"fr-CI":["French (Côte d’Ivoire)","français (Côte d’Ivoire)"],"fr-CM":["French (Cameroon)","français (Cameroun)"],"fr-DJ":["French (Djibouti)","français (Djibouti)"],"fr-DZ":["French (Algeria)","français (Algérie)"],"fr-GA":["French (Gabon)","français (Gabon)"],"fr-GF":["French (French Guiana)","français (Guyane française)"],"fr-GN":["French (Guinea)","français (Guinée)"],"fr-GP":["French (Guadeloupe)","français (Guadeloupe)"],"fr-GQ":["French (Equatorial Guinea)","français (Guinée équatoriale)"],"fr-HT":["French (Haiti)","français (Haïti)"],"fr-KM":["French (Comoros)","français (Comores)"],"fr-LU":["French (Luxembourg)","français (Luxembourg)"],"fr-MA":["French (Morocco)","français (Maroc)"],"fr-MC":["French (Monaco)","français (Monaco)"],"fr-MF":["French (St. Martin)","français (Saint-Martin)"],"fr-MG":["French (Madagascar)","français (Madagascar)"],"fr-ML":["French (Mali)","français (Mali)"],"fr-MQ":["French (Martinique)","français (Martinique)"],"fr-MR":["French (Mauritania)","français (Mauritanie)"],"fr-MU":["French (Mauritius)","français (Maurice)"],"fr-NC":["French (New Caledonia)","français (Nouvelle-Calédonie)"],"fr-NE":["French (Niger)","français (Niger)"],"fr-PF":["French (French Polynesia)","français (Polynésie française)"],"fr-PM":["French (St. Pierre & Miquelon)","français (Saint-Pierre-et-Miquelon)"],"fr-RE":["French (Réunion)","français (La Réunion)"],"fr-RW":["French (Rwanda)","français (Rwanda)"],"fr-SC":["French (Seychelles)","français (Seychelles)"],"fr-SN":["French (Senegal)","français (Sénégal)"],"fr-SY":["French (Syria)","français (Syrie)"],"fr-TD":["French (Chad)","français (Tchad)"],"fr-TG":["French (Togo)","français (Togo)"],"fr-TN":["French (Tunisia)","français (Tunisie)"],"fr-VU":["French (Vanuatu)","français (Vanuatu)"],"fr-WF":["French (Wallis & Futuna)","français (Wallis-et-Futuna)"],"fr-YT":["French (Mayotte)","français (Mayotte)"],frr:["Northern Frisian","Nordfriisk"],fur:["Friulian","furlan"],fy:["Western Frisian","Frysk"],ga:["Irish","Gaeilge"],"ga-GB":["Irish (United Kingdom)","Gaeilge (an Ríocht Aontaithe)"],gaa:["Ga","Gã"],gd:["Scottish Gaelic","Gàidhlig"],gez:["Geez","Geez"],"gez-ER":["Geez (Eritrea)","Geez (Eritrea)"],gl:["Galician","galego"],gn:["Guarani","avañe’ẽ"],gsw:["Swiss German","Schwiizertüütsch"],"gsw-FR":["Swiss German (France)","Schwiizertüütsch (Frankriich)"],"gsw-LI":["Swiss German (Liechtenstein)","Schwiizertüütsch (Liächteschtäi)"],gu:["Gujarati","ગુજરાતી"],guz:["Gusii","Ekegusii"],gv:["Manx","Gaelg"],ha:["Hausa","Hausa"],"ha-Arab":["Hausa (Arabic)","Hausa (Arabic)"],"ha-Arab-SD":["Hausa (Arabic, Sudan)","Hausa (Arabic, Sudan)"],"ha-GH":["Hausa (Ghana)","Hausa (Gana)"],"ha-NE":["Hausa (Niger)","Hausa (Nijar)"],haw:["Hawaiian","ʻŌlelo Hawaiʻi"],he:["Hebrew","עברית"],hi:["Hindi","हिन्दी"],"hi-Latn":["Hindi (Latin)","Hindi (Latin)"],hnj:["Hmong Njua","𞄀𞄄𞄰𞄩𞄍𞄜𞄰"],"hnj-Hmnp":["Hmong Njua (Nyiakeng Puachue Hmong)","𞄀𞄄𞄰𞄩𞄍𞄜𞄰"],hr:["Croatian","hrvatski"],"hr-BA":["Croatian (Bosnia & Herzegovina)","hrvatski (Bosna i Hercegovina)"],hsb:["Upper Sorbian","hornjoserbšćina"],hu:["Hungarian","magyar"],hy:["Armenian","հայերեն"],ia:["Interlingua","interlingua"],id:["Indonesian","Indonesia"],ig:["Igbo","Igbo"],ii:["Sichuan Yi","ꆈꌠꉙ"],io:["Ido","Ido"],is:["Icelandic","íslenska"],it:["Italian","italiano"],"it-CH":["Italian (Switzerland)","italiano (Svizzera)"],"it-SM":["Italian (San Marino)","italiano (San Marino)"],"it-VA":["Italian (Vatican City)","italiano (Città del Vaticano)"],iu:["Inuktitut","Inuktitut"],"iu-Latn":["Inuktitut (Latin)","Inuktitut (Latin)"],ja:["Japanese","日本語"],jbo:["Lojban","la .lojban."],jgo:["Ngomba","Ndaꞌa"],jmc:["Machame","Kimachame"],jv:["Javanese","Jawa"],ka:["Georgian","ქართული"],kab:["Kabyle","Taqbaylit"],kaj:["Jju","Kaje"],kam:["Kamba","Kikamba"],kcg:["Tyap","Katab"],kde:["Makonde","Chimakonde"],kea:["Kabuverdianu","kabuverdianu"],ken:["Kenyang","Kɛnyaŋ"],kgp:["Kaingang","kanhgág"],khq:["Koyra Chiini","Koyra ciini"],ki:["Kikuyu","Gikuyu"],kk:["Kazakh","қазақ тілі"],kkj:["Kako","kakɔ"],kl:["Kalaallisut","kalaallisut"],kln:["Kalenjin","Kalenjin"],km:["Khmer","ខ្មែរ"],kn:["Kannada","ಕನ್ನಡ"],ko:["Korean","한국어"],"ko-KP":["Korean (North Korea)","한국어(조선민주주의인민공화국)"],kok:["Konkani","कोंकणी"],kpe:["Kpelle","Kpɛlɛɛ"],"kpe-GN":["Kpelle (Guinea)","Kpɛlɛɛ"],ks:["Kashmiri","کٲشُر"],"ks-Arab":["Kashmiri (Arabic)","کٲشُر (عربی)"],"ks-Deva":["Kashmiri (Devanagari)","कॉशुर (देवनागरी)"],ksb:["Shambala","Kishambaa"],ksf:["Bafia","rikpa"],ksh:["Colognian","Kölsch"],ku:["Kurdish","kurdî"],kw:["Cornish","kernewek"],ky:["Kyrgyz","кыргызча"],la:["Latin","Latin"],lag:["Langi","Kɨlaangi"],lb:["Luxembourgish","Lëtzebuergesch"],lg:["Ganda","Luganda"],lij:["Ligurian","ligure"],lkt:["Lakota","Lakȟólʼiyapi"],lmo:["Lombard","Lombard"],ln:["Lingala","lingála"],"ln-AO":["Lingala (Angola)","lingála (Angóla)"],"ln-CF":["Lingala (Central African Republic)","lingála (Repibiki ya Afríka ya Káti)"],"ln-CG":["Lingala (Congo - Brazzaville)","lingála (Kongo)"],lo:["Lao","ລາວ"],lrc:["Northern Luri","لۊری شومالی"],"lrc-IQ":["Northern Luri (Iraq)","لۊری شومالی"],lt:["Lithuanian","lietuvių"],lu:["Luba-Katanga","Tshiluba"],luo:["Luo","Dholuo"],luy:["Luyia","Luluhia"],lv:["Latvian","latviešu"],mai:["Maithili","मैथिली"],mas:["Masai","Maa"],"mas-TZ":["Masai (Tanzania)","Maa (Tansania)"],mdf:["Moksha","мокшень кяль"],mer:["Meru","Kĩmĩrũ"],mfe:["Morisyen","kreol morisien"],mg:["Malagasy","Malagasy"],mgh:["Makhuwa-Meetto","Makua"],mgo:["Metaʼ","metaʼ"],mi:["Māori","Māori"],mk:["Macedonian","македонски"],ml:["Malayalam","മലയാളം"],mn:["Mongolian","монгол"],"mn-Mong":["Mongolian (Mongolian)","Mongolian (Mongolian)"],"mn-Mong-MN":["Mongolian (Mongolian, Mongolia)","ᠮᠣᠩᠭᠣᠯ (ᠮᠣᠩᠭᠣᠯ ᠪᠢᠴᠢᠭ᠌, ᠮᠣᠩᠭᠣᠯ)"],mni:["Manipuri","মৈতৈলোন্"],"mni-Beng":["Manipuri (Bangla)","মৈতৈলোন্ (বাংলা)"],"mni-Mtei":["Manipuri (Meitei Mayek)","ꯃꯤꯇꯩꯂꯣꯟ (ꯃꯤꯇꯩ ꯃꯌꯦꯛ)"],moh:["Mohawk","Kanienʼkéha"],mr:["Marathi","मराठी"],ms:["Malay","Melayu"],"ms-Arab":["Malay (Arabic)","Malay (Arabic)"],"ms-Arab-BN":["Malay (Arabic, Brunei)","Malay (Arabic, Brunei)"],"ms-BN":["Malay (Brunei)","Melayu (Brunei)"],"ms-ID":["Malay (Indonesia)","Melayu (Indonesia)"],"ms-SG":["Malay (Singapore)","Melayu (Singapura)"],mt:["Maltese","Malti"],mua:["Mundang","MUNDAŊ"],mus:["Muscogee","Mvskoke"],my:["Burmese","မြန်မာ"],myv:["Erzya","эрзянь кель"],mzn:["Mazanderani","مازرونی"],naq:["Nama","Khoekhoegowab"],nb:["Norwegian Bokmål","norsk bokmål"],"nb-SJ":["Norwegian Bokmål (Svalbard & Jan Mayen)","norsk bokmål (Svalbard og Jan Mayen)"],nd:["North Ndebele","isiNdebele"],nds:["Low German","Low German"],"nds-NL":["Low German (Netherlands)","Low German (Netherlands)"],ne:["Nepali","नेपाली"],"ne-IN":["Nepali (India)","नेपाली (भारत)"],nl:["Dutch","Nederlands"],"nl-AW":["Dutch (Aruba)","Nederlands (Aruba)"],"nl-BE":["Dutch (Belgium)","Nederlands (België)"],"nl-BQ":["Dutch (Caribbean Netherlands)","Nederlands (Caribisch Nederland)"],"nl-CW":["Dutch (Curaçao)","Nederlands (Curaçao)"],"nl-SR":["Dutch (Suriname)","Nederlands (Suriname)"],"nl-SX":["Dutch (Sint Maarten)","Nederlands (Sint-Maarten)"],nmg:["Kwasio","Kwasio"],nn:["Norwegian Nynorsk","norsk nynorsk"],nnh:["Ngiemboon","Shwóŋò ngiembɔɔn"],no:["Norwegian","norsk"],nqo:["N’Ko","ߒߞߏ"],nr:["South Ndebele","South Ndebele"],nso:["Northern Sotho","Northern Sotho"],nus:["Nuer","Thok Nath"],nv:["Navajo","Diné Bizaad"],ny:["Nyanja","Nyanja"],nyn:["Nyankole","Runyankore"],oc:["Occitan","Occitan"],"oc-ES":["Occitan (Spain)","Occitan (Spain)"],om:["Oromo","Oromoo"],"om-KE":["Oromo (Kenya)","Oromoo (Keeniyaa)"],or:["Odia","ଓଡ଼ିଆ"],os:["Ossetic","ирон"],"os-RU":["Ossetic (Russia)","ирон (Уӕрӕсе)"],osa:["Osage","𐓏𐓘𐓻𐓘𐓻𐓟"],pa:["Punjabi","ਪੰਜਾਬੀ"],"pa-Arab":["Punjabi (Arabic)","پنجابی (عربی)"],"pa-Guru":["Punjabi (Gurmukhi)","ਪੰਜਾਬੀ (ਗੁਰਮੁਖੀ)"],pap:["Papiamento","Papiamentu"],"pap-AW":["Papiamento (Aruba)","Papiamentu"],pcm:["Nigerian Pidgin","Naijíriá Píjin"],pis:["Pijin","Pijin"],pl:["Polish","polski"],prg:["Prussian","prūsiskan"],ps:["Pashto","پښتو"],"ps-PK":["Pashto (Pakistan)","پښتو (پاکستان)"],pt:["Portuguese","português"],"pt-AO":["Portuguese (Angola)","português (Angola)"],"pt-CH":["Portuguese (Switzerland)","português (Suíça)"],"pt-CV":["Portuguese (Cape Verde)","português (Cabo Verde)"],"pt-GQ":["Portuguese (Equatorial Guinea)","português (Guiné Equatorial)"],"pt-GW":["Portuguese (Guinea-Bissau)","português (Guiné-Bissau)"],"pt-LU":["Portuguese (Luxembourg)","português (Luxemburgo)"],"pt-MO":["Portuguese (Macao SAR China)","português (Macau, RAE da China)"],"pt-MZ":["Portuguese (Mozambique)","português (Moçambique)"],"pt-PT":["Portuguese (Portugal)","português (Portugal)"],"pt-ST":["Portuguese (São Tomé & Príncipe)","português (São Tomé e Príncipe)"],"pt-TL":["Portuguese (Timor-Leste)","português (Timor-Leste)"],qu:["Quechua","Runasimi"],"qu-BO":["Quechua (Bolivia)","Runasimi (Bolivia)"],"qu-EC":["Quechua (Ecuador)","Runasimi (Ecuador)"],quc:["Kʼicheʼ","Kʼicheʼ"],raj:["Rajasthani","राजस्थानी"],rhg:["Rohingya","𐴌𐴗𐴥𐴝𐴙𐴚𐴒𐴙𐴝"],"rhg-Rohg":["Rohingya (Hanifi)","𐴌𐴗𐴥𐴝𐴙𐴚𐴒𐴙𐴝"],"rhg-Rohg-BD":["Rohingya (Hanifi, Bangladesh)","𐴌𐴗𐴥𐴝𐴙𐴚𐴒𐴙𐴝"],rif:["Riffian","Tarifit"],rm:["Romansh","rumantsch"],rn:["Rundi","Ikirundi"],ro:["Romanian","română"],"ro-MD":["Romanian (Moldova)","română (Republica Moldova)"],rof:["Rombo","Kihorombo"],ru:["Russian","русский"],"ru-BY":["Russian (Belarus)","русский (Беларусь)"],"ru-KG":["Russian (Kyrgyzstan)","русский (Киргизия)"],"ru-KZ":["Russian (Kazakhstan)","русский (Казахстан)"],"ru-MD":["Russian (Moldova)","русский (Молдова)"],"ru-UA":["Russian (Ukraine)","русский (Украина)"],rw:["Kinyarwanda","Kinyarwanda"],rwk:["Rwa","Kiruwa"],sa:["Sanskrit","संस्कृत भाषा"],sah:["Yakut","саха тыла"],saq:["Samburu","Kisampur"],sat:["Santali","ᱥᱟᱱᱛᱟᱲᱤ"],"sat-Deva":["Santali (Devanagari)","सानताड़ी (देवानागारी)"],"sat-Olck":["Santali (Ol Chiki)","ᱥᱟᱱᱛᱟᱲᱤ (ᱚᱞ ᱪᱤᱠᱤ)"],sbp:["Sangu","Ishisangu"],sc:["Sardinian","sardu"],scn:["Sicilian","sicilianu"],sd:["Sindhi","سنڌي"],"sd-Arab":["Sindhi (Arabic)","سنڌي (عربي)"],"sd-Deva":["Sindhi (Devanagari)","सिन्धी (देवनागिरी)"],sdh:["Southern Kurdish","کوردی خوارگ"],"sdh-IQ":["Southern Kurdish (Iraq)","کوردی خوارگ"],se:["Northern Sami","davvisámegiella"],"se-FI":["Northern Sami (Finland)","davvisámegiella (Suopma)"],"se-SE":["Northern Sami (Sweden)","davvisámegiella (Ruoŧŧa)"],seh:["Sena","sena"],ses:["Koyraboro Senni","Koyraboro senni"],sg:["Sango","Sängö"],shi:["Tachelhit","ⵜⴰⵛⵍⵃⵉⵜ"],"shi-Latn":["Tachelhit (Latin)","Tashelḥiyt"],"shi-Tfng":["Tachelhit (Tifinagh)","ⵜⴰⵛⵍⵃⵉⵜ"],shn:["Shan","တႆး"],"shn-TH":["Shan (Thailand)","တႆး (မိူင်းထႆး)"],si:["Sinhala","සිංහල"],sid:["Sidamo","Sidamo"],sk:["Slovak","slovenčina"],sl:["Slovenian","slovenščina"],sma:["Southern Sami","Åarjelsaemien gïele"],"sma-NO":["Southern Sami (Norway)","Åarjelsaemien gïele"],smj:["Lule Sami","julevsámegiella"],"smj-NO":["Lule Sami (Norway)","julevsámegiella"],smn:["Inari Sami","anarâškielâ"],sms:["Skolt Sami","sääʹmǩiõll"],sn:["Shona","chiShona"],so:["Somali","Soomaali"],"so-DJ":["Somali (Djibouti)","Soomaali (Jabuuti)"],"so-ET":["Somali (Ethiopia)","Soomaali (Itoobiya)"],"so-KE":["Somali (Kenya)","Soomaali (Kenya)"],sq:["Albanian","shqip"],"sq-MK":["Albanian (North Macedonia)","shqip (Maqedonia e Veriut)"],"sq-XK":["Albanian (Kosovo)","shqip (Kosovë)"],sr:["Serbian","српски"],"sr-Cyrl":["Serbian (Cyrillic)","српски (ћирилица)"],"sr-Cyrl-BA":["Serbian (Cyrillic, Bosnia & Herzegovina)","српски (ћирилица, Босна и Херцеговина)"],"sr-Cyrl-ME":["Serbian (Cyrillic, Montenegro)","српски (ћирилица, Црна Гора)"],"sr-Cyrl-XK":["Serbian (Cyrillic, Kosovo)","српски (ћирилица, Косово)"],"sr-Latn":["Serbian (Latin)","srpski (latinica)"],"sr-Latn-BA":["Serbian (Latin, Bosnia & Herzegovina)","srpski (latinica, Bosna i Hercegovina)"],"sr-Latn-ME":["Serbian (Latin, Montenegro)","srpski (latinica, Crna Gora)"],"sr-Latn-XK":["Serbian (Latin, Kosovo)","srpski (latinica, Kosovo)"],ss:["Swati","siSwati"],"ss-SZ":["Swati (Eswatini)","siSwati (eSwatini)"],ssy:["Saho","Saho"],st:["Southern Sotho","Sesotho"],"st-LS":["Southern Sotho (Lesotho)","Sesotho"],su:["Sundanese","Basa Sunda"],"su-Latn":["Sundanese (Latin)","Basa Sunda (Latin)"],sv:["Swedish","svenska"],"sv-AX":["Swedish (Åland Islands)","svenska (Åland)"],"sv-FI":["Swedish (Finland)","svenska (Finland)"],sw:["Swahili","Kiswahili"],"sw-CD":["Swahili (Congo - Kinshasa)","Kiswahili (Jamhuri ya Kidemokrasia ya Kongo)"],"sw-KE":["Swahili (Kenya)","Kiswahili (Kenya)"],"sw-UG":["Swahili (Uganda)","Kiswahili (Uganda)"],syr:["Syriac","ܣܘܪܝܝܐ"],"syr-SY":["Syriac (Syria)","ܣܘܪܝܝܐ (ܣܘܪܝܐ)"],szl:["Silesian","ślōnski"],ta:["Tamil","தமிழ்"],"ta-LK":["Tamil (Sri Lanka)","தமிழ் (இலங்கை)"],"ta-MY":["Tamil (Malaysia)","தமிழ் (மலேசியா)"],"ta-SG":["Tamil (Singapore)","தமிழ் (சிங்கப்பூர்)"],te:["Telugu","తెలుగు"],teo:["Teso","Kiteso"],"teo-KE":["Teso (Kenya)","Kiteso (Kenia)"],tg:["Tajik","тоҷикӣ"],th:["Thai","ไทย"],ti:["Tigrinya","ትግርኛ"],"ti-ER":["Tigrinya (Eritrea)","ትግርኛ (ኤርትራ)"],tig:["Tigre","Tigre"],tk:["Turkmen","türkmen dili"],tn:["Tswana","Tswana"],"tn-BW":["Tswana (Botswana)","Tswana (Botswana)"],to:["Tongan","lea fakatonga"],tok:["Toki Pona","Toki Pona"],tpi:["Tok Pisin","Tok Pisin"],tr:["Turkish","Türkçe"],"tr-CY":["Turkish (Cyprus)","Türkçe (Kıbrıs)"],trv:["Taroko","patas Taroko"],trw:["Torwali","توروالی"],ts:["Tsonga","Tsonga"],tt:["Tatar","татар"],twq:["Tasawaq","Tasawaq senni"],tzm:["Central Atlas Tamazight","Tamaziɣt n laṭlaṣ"],ug:["Uyghur","ئۇيغۇرچە"],uk:["Ukrainian","українська"],und:["Unknown language","Unknown language"],ur:["Urdu","اردو"],"ur-IN":["Urdu (India)","اردو (بھارت)"],uz:["Uzbek","o‘zbek"],"uz-Arab":["Uzbek (Arabic)","اوزبیک (عربی)"],"uz-Cyrl":["Uzbek (Cyrillic)","ўзбекча (Кирил)"],"uz-Latn":["Uzbek (Latin)","o‘zbek (lotin)"],vai:["Vai","ꕙꔤ"],"vai-Latn":["Vai (Latin)","Vai"],"vai-Vaii":["Vai (Vai)","ꕙꔤ"],ve:["Venda","Venda"],vec:["Venetian","Veneto"],vi:["Vietnamese","Tiếng Việt"],vo:["Volapük","Volapük"],vun:["Vunjo","Kyivunjo"],wa:["Walloon","walon"],wae:["Walser","Walser"],wal:["Wolaytta","Wolaytta"],wbp:["Warlpiri","Warlpiri"],wo:["Wolof","Wolof"],xh:["Xhosa","IsiXhosa"],xog:["Soga","Olusoga"],yav:["Yangben","nuasue"],yi:["Yiddish","ייִדיש"],yo:["Yoruba","Èdè Yorùbá"],"yo-BJ":["Yoruba (Benin)","Èdè Yorùbá (Bɛ̀nɛ̀)"],yrl:["Nheengatu","nheẽgatu"],"yrl-CO":["Nheengatu (Colombia)","ñengatú (Kurũbiya)"],"yrl-VE":["Nheengatu (Venezuela)","ñengatú (Wenesuera)"],yue:["Cantonese","粵語"],"yue-Hans":["Cantonese (Simplified)","粤语 (简体)"],"yue-Hant":["Cantonese (Traditional)","粵語 (繁體)"],zgh:["Standard Moroccan Tamazight","ⵜⴰⵎⴰⵣⵉⵖⵜ"],zh:["Chinese","中文"],"zh-Hans":["Chinese (Simplified)","中文（简体）"],"zh-Hans-HK":["Chinese (Simplified, Hong Kong SAR China)","中文（简体，中国香港特别行政区）"],"zh-Hans-MO":["Chinese (Simplified, Macao SAR China)","中文（简体，中国澳门特别行政区）"],"zh-Hans-SG":["Chinese (Simplified, Singapore)","中文（简体，新加坡）"],"zh-Hant":["Chinese (Traditional)","中文（繁體）"],"zh-Hant-HK":["Chinese (Traditional, Hong Kong SAR China)","中文（繁體字，中國香港特別行政區）"],"zh-Hant-MO":["Chinese (Traditional, Macao SAR China)","中文（繁體字，中國澳門特別行政區）"],zu:["Zulu","isiZulu"]},Ds={locale:"en",domain:"en",direction:"ltr",countryCode:"",country:"",countryNative:"",language:"English",languageNative:"English",translations:{months:{formatted:{abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},nominative:{abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]}},days:{formatted:{abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},nominative:{abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]}},time:{AM:"AM",PM:"PM"}},formats:{date:{full:"EEEE, MMMM d, y",long:"MMMM d, y",medium:"MMM d, y",short:"M/d/yy"},time:{full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},dateTime:{full:"{1} 'at' {0}",long:"{1} 'at' {0}",medium:"{1}, {0}",short:"{1}, {0}"},numbers:{decimals:".",grouping:",",minus:"-"}}};class zs{static get locale(){return this.m_pLocale||Ds}static get identifier(){return this.locale.locale}static get domain(){return this.locale.domain}static get countryCode(){return this.locale.countryCode}static get country(){return this.locale.country}static get countryNative(){return this.locale.countryNative}static get language(){return this.locale.language}static get languageNative(){return this.locale.languageNative}static get direction(){return this.locale.direction}static get locales(){const t=[];return X(Ns,((e,s)=>{t.push(s)}),{keys:!0}),t}static get domains(){const t=[];return X(Ns,((e,s)=>{t.push({locale:s,language:e[0],native:e[1]})}),{keys:!0}),t}static isLoaded(t){return T(t)&&C(this.m_pLocales[t.toLowerCase()])}static load(t,e=!0){let s=!1;return X(F(t)?t:[t],(t=>{Q(t,Ds,!1)&&(this.isLoaded(t.locale)||(this.m_pLocales[t.locale.toLowerCase()]=Z(t)),s=!0)})),s&&e&&!F(t)&&this.set(t.locale),s}static get(t){return(T(t)?this.m_pLocales[t.toLowerCase()]:void 0)||this.locale}static set(t){return C(this.m_pLocale=this.isLoaded(t)&&this.m_pLocales[t.toLowerCase()].locale===t?this.m_pLocales[t.toLowerCase()]:void 0)}static findDomain(t){if(!t||Ns[t])return t||"";t=e.replace(t.toLowerCase(),"_","-"),this.m_pDomains||(this.m_pDomains={},X(Ns,((t,e)=>{this.m_pDomains[e.toLowerCase()]=e}),{keys:!0}));let s=this.m_pDomains[t];for(;!s&&-1!==t.lastIndexOf("-");)t=t.substr(0,t.lastIndexOf("-")),s=this.m_pDomains[t];return s||""}static getDomain(t){t=this.findDomain(t)||this.locale.domain;const e=Ns[t];return{locale:t,language:e[0],native:e[1]}}static number(e,s=0,n=!0,i){const r=this.get(i);return t.format(e,s,n?r.formats.numbers.grouping:"",r.formats.numbers.decimals,r.formats.numbers.minus)}static dateTime(t,e=b.now,s=!1,n){const i=this.get(n);return b.format(t,e,s,{monthsFormattedAbbreviated:i.translations.months.formatted.abbreviated,monthsFormattedNarrow:i.translations.months.formatted.narrow,monthsFormattedWide:i.translations.months.formatted.wide,monthsNominativeAbbreviated:i.translations.months.nominative.abbreviated,monthsNominativeNarrow:i.translations.months.nominative.narrow,monthsNominativeWide:i.translations.months.nominative.wide,weekdaysFormattedAbbreviated:i.translations.days.formatted.abbreviated,weekdaysFormattedNarrow:i.translations.days.formatted.narrow,weekdaysFormattedShort:i.translations.days.formatted.short,weekdaysFormattedWide:i.translations.days.formatted.wide,weekdaysNominativeAbbreviated:i.translations.days.nominative.abbreviated,weekdaysNominativeNarrow:i.translations.days.nominative.narrow,weekdaysNominativeShort:i.translations.days.nominative.short,weekdaysNominativeWide:i.translations.days.nominative.wide,AM:i.translations.time.AM,PM:i.translations.time.PM})}static dateFull(t=b.now,e=!1,s){return this.dateTime(this.get(s).formats.date.full,t,e,s)}static dateLong(t=b.now,e=!1,s){return this.dateTime(this.get(s).formats.date.long,t,e,s)}static dateMedium(t=b.now,e=!1,s){return this.dateTime(this.get(s).formats.date.medium,t,e,s)}static dateShort(t=b.now,e=!1,s){return this.dateTime(this.get(s).formats.date.short,t,e,s)}static timeFull(t=b.now,e=!1,s){return this.dateTime(this.get(s).formats.time.full,t,e,s)}static timeLong(t=b.now,e=!1,s){return this.dateTime(this.get(s).formats.time.long,t,e,s)}static timeMedium(t=b.now,e=!1,s){return this.dateTime(this.get(s).formats.time.medium,t,e,s)}static timeShort(t=b.now,e=!1,s){return this.dateTime(this.get(s).formats.time.short,t,e,s)}static dateTimeFull(t=b.now,s=!1,n){const i=this.get(n);return this.dateTime(e.replace(e.replace(i.formats.dateTime.full,"{0}",i.formats.time.full),"{1}",i.formats.date.full),t,s,n)}static dateTimeLong(t=b.now,s=!1,n){const i=this.get(n);return this.dateTime(e.replace(e.replace(i.formats.dateTime.long,"{0}",i.formats.time.long),"{1}",i.formats.date.long),t,s,n)}static dateTimeMedium(t=b.now,s=!1,n){const i=this.get(n);return this.dateTime(e.replace(e.replace(i.formats.dateTime.medium,"{0}",i.formats.time.medium),"{1}",i.formats.date.medium),t,s,n)}static dateTimeShort(t=b.now,s=!1,n){const i=this.get(n);return this.dateTime(e.replace(e.replace(i.formats.dateTime.short,"{0}",i.formats.time.short),"{1}",i.formats.date.short),t,s,n)}get locale(){return this.m_pLocale||zs.locale}get identifier(){return this.locale.locale}get domain(){return this.locale.domain}get countryCode(){return this.locale.countryCode}get country(){return this.locale.country}get countryNative(){return this.locale.countryNative}get language(){return this.locale.language}get languageNative(){return this.locale.languageNative}get direction(){return this.locale.direction}load(t){const e=zs.load(t,!1);return this.set(t.locale),e}set(t){return C(this.m_pLocale=zs.isLoaded(t)&&zs.m_pLocales[t.toLowerCase()].locale===t?zs.m_pLocales[t.toLowerCase()]:void 0)}number(t,e=0,s=!0){return zs.number(t,e,s,this.identifier)}dateTime(t,e=b.now,s=!1){return zs.dateTime(t,e,s,this.identifier)}dateFull(t=b.now,e=!1){return zs.dateFull(t,e,this.identifier)}dateLong(t=b.now,e=!1){return zs.dateLong(t,e,this.identifier)}dateMedium(t=b.now,e=!1){return zs.dateMedium(t,e,this.identifier)}dateShort(t=b.now,e=!1){return zs.dateShort(t,e,this.identifier)}timeFull(t=b.now,e=!1){return zs.timeFull(t,e,this.identifier)}timeLong(t=b.now,e=!1){return zs.timeLong(t,e,this.identifier)}timeMedium(t=b.now,e=!1){return zs.timeMedium(t,e,this.identifier)}timeShort(t=b.now,e=!1){return zs.timeShort(t,e,this.identifier)}dateTimeFull(t=b.now,e=!1){return zs.dateTimeFull(t,e,this.identifier)}dateTimeLong(t=b.now,e=!1){return zs.dateTimeLong(t,e,this.identifier)}dateTimeMedium(t=b.now,e=!1){return zs.dateTimeMedium(t,e,this.identifier)}dateTimeShort(t=b.now,e=!1){return zs.dateTimeShort(t,e,this.identifier)}}zs.m_pLocales={};const Us={"Asian (Chinese, Japanese, Korean)":{rules:["Everything"],expression:"nplurals=1; plural=0;",locales:["zh","ja","ko"],fn:t=>0},Persian:{rules:["Everything"],expression:"nplurals=1; plural=0;",locales:["fa"],fn:t=>0},"Turkic/Altaic (Turkish)":{rules:["Everything"],expression:"nplurals=1; plural=0;",locales:["tr"],fn:t=>0},Thai:{rules:["Everything"],expression:"nplurals=1; plural=0;",locales:["th"],fn:t=>0},Lao:{rules:["Everything"],expression:"nplurals=1; plural=0;",locales:["lo"],fn:t=>0},"Germanic (Danish, Dutch, English, Faroese, Frisian, German, Norwegian, Swedish)":{rules:["Is 1","Everything else"],expression:"nplurals=2; plural=(n != 1);",locales:["da","nl","en","fo","fy","de","nn","sv"],fn:t=>1!==t?1:0},"Finno-Ugric (Estonian, Finnish, Hungarian)":{rules:["Is 1","Everything else"],expression:"nplurals=2; plural=(n != 1);",locales:["et","fi","hu"],fn:t=>1!==t?1:0},"Language isolate (Basque)":{rules:["Is 1","Everything else"],expression:"nplurals=2; plural=(n != 1);",locales:["eu"],fn:t=>1!==t?1:0},"Latin/Greek (Greek)":{rules:["Is 1","Everything else"],expression:"nplurals=2; plural=(n != 1);",locales:["el"],fn:t=>1!==t?1:0},"Semitic (Hebrew)":{rules:["Is 1","Everything else"],expression:"nplurals=2; plural=(n != 1);",locales:["he"],fn:t=>1!==t?1:0},"Romanic (Italian, Portuguese, Spanish, Catalan)":{rules:["Is 1","Everything else"],expression:"nplurals=2; plural=(n != 1);",locales:["it","pt","es","ca"],fn:t=>1!==t?1:0},Vietnamese:{rules:["Is 1","Everything else"],expression:"nplurals=2; plural=(n != 1);",locales:["vi"],fn:t=>1!==t?1:0},"Romanic (French, Brazilian Portuguese)":{rules:["Is 0 or 1","Everything else"],expression:"nplurals=2; plural=(n > 1);",locales:["fr","pt_BR"],fn:t=>t>1?1:0},Lingala:{rules:["Is 0 or 1","Everything else"],expression:"nplurals=2; plural=(n > 1);",locales:["ln"],fn:t=>t>1?1:0},"Baltic (Latvian, Latgalian)":{rules:["Ends in 0","Ends in 1, excluding 11","Everything else"],expression:"nplurals=3; plural=(n%10==0 || (n%100>=11 && n%100<=19) ? 0 : n%10==1 && n%100!=11 ? 1 : 2);",locales:["lv"],fn:t=>t%10==0||t%100>=11&&t%100<=19?0:t%10==1&&t%100!=11?1:2},"Celtic (Scottish Gaelic)":{rules:["Is 1 or 11","Is 2 or 12","Is 3-10 or 13-19","Everything else"],expression:"nplurals=4; plural=(n==1 || n==11 ? 0 : n==2 || n==12 ? 1 : (n>=3 && n<=10) || (n>=13 && n<=19) ? 2 : 3);",locales:["gd"],fn:t=>1===t||11===t?0:2===t||12===t?1:t>=3&&t<=10||t>=13&&t<=19?2:3},"Romanic (Romanian)":{rules:["Is 1","Is 0 or ends in 01-19, excluding 1","Everything else"],expression:"nplurals=3; plural=(n==1 ? 0 : n==0 || (n!=1 && n%100>=1 && n%100<=19) ? 1 : 2);",locales:["ro"],fn:t=>1===t?0:0===t||1!==t&&t%100>=1&&t%100<=19?1:2},"Baltic (Lithuanian)":{rules:["Ends in 1, excluding 11","Ends in 0 or ends in 11-19","Everything else"],expression:"nplurals=3; plural=(n%10==1 && (n%100<11 || n%100>19) ? 0 : n%10>=2 && n%10<=9 && (n%100<11 || n%100>19) ? 1 : 2);",locales:["lt"],fn:t=>t%10==1&&(t%100<11||t%100>19)?0:t%10>=2&&t%10<=9&&(t%100<11||t%100>19)?1:2},Belarusian:{rules:["Ends in 1, excluding 11","Ends in 2-4, excluding 12-14","Everything else"],expression:"nplurals=3; plural=(n%10==1 && n%100!=11 ? 0 : n%10>=2 && n%10<=4 && (n%100<12 || n%100>14) ? 1 : 2);",locales:["be"],fn:t=>t%10==1&&t%100!=11?0:t%10>=2&&t%10<=4&&(t%100<12||t%100>14)?1:2},Russian:{rules:["Ends in 1, excluding 11","Ends in 2-4, excluding 12-14","Everything else"],expression:"nplurals=3; plural=(n%10==1 && n%100!=11 ? 0 : n%10>=2 && n%10<=4 && (n%100<12 || n%100>14) ? 1 : 2);",locales:["ru"],fn:t=>t%10==1&&t%100!=11?0:t%10>=2&&t%10<=4&&(t%100<12||t%100>14)?1:2},Ukrainian:{rules:["Ends in 1, excluding 11","Ends in 2-4, excluding 12-14","Everything else"],expression:"nplurals=3; plural=(n%10==1 && n%100!=11 ? 0 : n%10>=2 && n%10<=4 && (n%100<12 || n%100>14) ? 1 : 2);",locales:["uk"],fn:t=>t%10==1&&t%100!=11?0:t%10>=2&&t%10<=4&&(t%100<12||t%100>14)?1:2},"Slavic (Slovak, Czech)":{rules:["Is 1","Is 2-4","Everything else"],expression:"nplurals=3; plural=(n==1 ? 0 : n>=2 && n<=4 ? 1 : 2);",locales:["sk","cs"],fn:t=>1===t?0:t>=2&&t<=4?1:2},"Slavic (Polish)":{rules:["Is 1","Ends in 2-4, excluding 12-14","Everything else"],expression:"nplurals=3; plural=(n==1 ? 0 : n%10>=2 && n%10<=4 && (n%100<12 || n%100>14) ? 1 : 2);",locales:["pl"],fn:t=>1===t?0:t%10>=2&&t%10<=4&&(t%100<12||t%100>14)?1:2},"Slavic (Slovenian, Sorbian)":{rules:["Ends in 01","Ends in 02","Ends in 03-04","Everything else"],expression:"nplurals=4; plural=(n%100==1 ? 0 : n%100==2 ? 1 : n%100>=3 && n%100<=4 ? 2 : 3);",locales:["sl","dsb","hsb"],fn:t=>t%100==1?0:t%100==2?1:t%100>=3&&t%100<=4?2:3},"Celtic (Irish Gaelic)":{rules:["Is 1","Is 2","Is 3-6","Is 7-10","Everything else"],expression:"nplurals=5; plural=(n==1 ? 0 : n==2 ? 1 : n>=3 && n<=6 ? 2 : n>=7 && n<=10 ? 3 : 4);",locales:["ga"],fn:t=>1===t?0:2===t?1:t>=3&&t<=6?2:t>=7&&t<=10?3:4},"Semitic (Arabic)":{rules:["Is 0","Is 1","Is 2","Ends in 03-10","Everything else but is 0 and ends in 00-02, excluding 0-2","Ends in 00-02, excluding 0-2"],expression:"nplurals=6; plural=(n==0 ? 0 : n==1 ? 1 : n==2 ? 2 : n%100>=3 && n%100<=10 ? 3 : n%100>=11 && n%100<=99 ? 4 : 5);",locales:["ar"],fn:t=>0===t?0:1===t?1:2===t?2:t%100>=3&&t%100<=10?3:t%100>=11&&t%100<=99?4:5},"Semitic (Maltese)":{rules:["Is 1","Is 0 or ends in 01-10, excluding 1","Ends in 11-19","Everything else"],expression:"nplurals=4; plural=(n==1 ? 0 : n==0 || (n%100>=2 && n%100<=10) ? 1 : n%100>=11 && n%100<=19 ? 2 : 3);",locales:["mt"],fn:t=>1===t?0:0===t||t%100>=2&&t%100<=10?1:t%100>=11&&t%100<=19?2:3},Icelandic:{rules:["Ends in 1, excluding 11","Everything else"],expression:"nplurals=2; plural=(n%10==1 && n%100!=11 ? 0 : 1);",locales:["is"],fn:t=>t%10==1&&t%100!=11?0:1},Macedonian:{rules:["Ends in 1, excluding 11","Everything else"],expression:"nplurals=2; plural=(n%10==1 && n%100!=11 ? 0 : 1);",locales:["mk"],fn:t=>t%10==1&&t%100!=11?0:1},"Celtic (Breton)":{rules:["Ends in 1, excluding 11, 71, 91","Ends in 2, excluding 12, 72, 92","Ends in 3, 4 or 9 excluding 13, 14, 19, 73, 74, 79, 93, 94, 99","Ends in 000000","Everything else"],expression:"nplurals=5; plural=(n%10==1 && n%100!=11 && n%100!=71 && n%100!=91 ? 0 : n%10==2 && n%100!=12 && n%100!=72 && n%100!=92 ? 1 : ((n%10>=3 && n%10<=4) || n%10==9) && (n%100<10 || n%100>19) && (n%100<70 || n%100>79) && (n%100<90 || n%100>99) ? 2 : n!=0 && n%1000000==0 ? 3 : 4);",locales:["br"],fn:t=>t%10==1&&t%100!=11&&t%100!=71&&t%100!=91?0:t%10==2&&t%100!=12&&t%100!=72&&t%100!=92?1:(t%10>=3&&t%10<=4||t%10==9)&&(t%100<10||t%100>19)&&(t%100<70||t%100>79)&&(t%100<90||t%100>99)?2:0!==t&&t%1e6==0?3:4},"Ecuador indigenous languages (Shuar)":{rules:["Is 0","Everything else"],expression:"nplurals=2; plural=(n != 0);",locales:[],fn:t=>0!==t?1:0},Welsh:{rules:["Is 0","Is 1","Is 2","Is 3","Is 6","Everything else"],expression:"nplurals=6; plural=(n==0 ? 0 : n==1 ? 1 : n==2 ? 2 : n==3 ? 3 : n==6 ? 4 : 5);",locales:["cy"],fn:t=>0===t?0:1===t?1:2===t?2:3===t?3:6===t?4:5},"Slavic (Bosnian, Croatian, Serbian)":{rules:["Ends in 1, excluding 11","Ends in 2-4, excluding 12-14","Everything else"],expression:"nplurals=3; plural=(n%10==1 && n%100!=11 ? 0 : n%10>=2 && n%10<=4 && (n%100<12 || n%100>14) ? 1 : 2);",locales:["bs","hr","sr"],fn:t=>t%10==1&&t%100!=11?0:t%10>=2&&t%10<=4&&(t%100<12||t%100>14)?1:2}};class Gs{static get rules(){const t=[];return X(Us,((e,s)=>{t.push({family:s,rules:e.rules,expression:e.expression,locales:e.locales,fn:e.fn})}),{keys:!0}),t.sort(((t,e)=>t.family.localeCompare(e.family,zs.domain,{sensitivity:"base"})))}static get locales(){const t={};return X(Us,((e,s)=>{X(e.locales,(n=>{t[n]={family:s,rules:e.rules,expression:e.expression,locales:e.locales,fn:e.fn}}))}),{keys:!0}),t}static getForLocale(t){return this.locales[t||zs.domain]}static getForFamily(t){return lt(this.rules,(e=>e.family===t))}static getForExpression(t){return lt(this.rules,(e=>e.expression===t))||lt(this.rules,(s=>e.removeWhitespaces(s.expression)===e.removeWhitespaces(t)))}}class $s{constructor(t){this.m_nPlurals=1;const e=(this.m_pTranslation=Z(t))[""];if(C(e)){let t=K(e["plural-forms"]);if(T(t)){const e=Gs.getForExpression(t);if(e&&e.rules.length>0)this.m_nPlurals=e.rules.length,this.m_fnPlural=e.fn;else{const e=/nplurals\=(\d+);/;let s;if(t=t.replace(/^\s\s*/,"").replace(/\s\s*$/,""),/;\s*$/.test(t)||(t=t.concat(";")),s=j(R(t.match(e),1)),s>1&&(t=t.replace(e,""),t=K(R(t.match(/plural\=(.*);/),1)),T(t)&&/^[0-9n\u002b\u002d\u002a\u002f\u0025\u003e\u003c\u003d\u0021\u007e\u007c\u0026\u005e\u0028\u0029\u003a\u003b\u003f\s]+$/.test(t))){const e=new Function("n","return "+t);this.m_nPlurals=s,this.m_fnPlural=t=>j(e(t))}}}}}get plurals(){return this.m_nPlurals}enrich(t,e){X(t,((t,s)=>{!s||this.m_pTranslation[s]&&!e||(this.m_pTranslation[s]=t)}),{keys:!0})}plural(e){return t.range(this.m_fnPlural?this.m_fnPlural(e):1!==e?1:0,0,this.plurals-1)}translation(t){return this.m_pTranslation[t]}}class Ks{constructor(){this.m_pTranslations={},this.m_pCache={},this.m_sDefault=zs.domain,this.m_sCurrent=""}static assert(){return this.m_pTranslations||(this.m_pTranslations=new Ks)}static get domains(){return this.assert().domains}static get default(){return this.assert().default}static set default(t){this.assert().default=t}static get current(){return this.assert().current}static set current(t){this.assert().current=t}static load(t,e=!0,s="enrich"){return this.assert().load(t,e,s)}static unload(t){this.assert().unload(t)}static isLoaded(t){return this.assert().isLoaded(t)}static reset(t=""){this.assert().reset(t)}static translate(t,e,s,n=!1,i="",r=0,...a){return this.assert().translate(t,e,s,n,i,r,...a)}message(t,e,s,n,i){if(t){const r=t.translation((e?e+"":"")+s);if(r){const e=1+(n?t.plural(i):0);if(e<r.length){const t=r[e];if("string"==typeof t)return t;if(Array.isArray(t)&&1===t.length){const e=t[0];if("string"==typeof e)return e}return""}}}return""}find(t,e,s,n,i){if(!t)return"";const r=t+""+e+s+""+(n?"P":"S")+i,a=this.m_pCache[r]||(this.m_pCache[r]=this.message(this.m_pTranslations[t],e,s,n,i));if(a)return a;const o=Ks.m_pAlternatives[t];if(o)return this.find(o.alternative,e,s,n,i);const h=t.lastIndexOf("-"),l=-1!==h?t.substr(0,h):void 0;return Ks.m_pAlternatives[t]={alternative:l},this.find(l,e,s,n,i)}invalidate(t){if(!t)return;const e=t+"";X(this.m_pCache,((t,s)=>{0===s.indexOf(e)&&qt(this.m_pCache,s)}),{keys:!0})}get domains(){const t=[];return X(this.m_pTranslations,((e,s)=>{t.push(s)}),{keys:!0}),t}get default(){return this.m_sDefault}set default(t){(t=zs.findDomain(t))&&(this.m_sDefault=t)}get current(){return this.m_sCurrent||this.default}set current(t){this.m_sCurrent=zs.findDomain(t)}load(t,e,s){let n=!1,i="";return X(F(t)?t:[t],(t=>{if(C(t)){const e=t[""];if(C(e)){Dt(e,"language",zs.findDomain(e.language)||this.current),this.invalidate(e.language);const r="replace"!==s?this.m_pTranslations[e.language]:void 0;r?r.enrich(t,"overwrite"===s):this.m_pTranslations[e.language]=new $s(t),i||(i=e.language),n=!0}}})),!1===e||!i||!0!==e&&this.m_sCurrent||(this.current=i),n}unload(t){t?(t=zs.findDomain(t),this.invalidate(t),qt(this.m_pTranslations,t)):X(this.m_pTranslations,((t,e)=>{this.invalidate(e),qt(this.m_pTranslations,e)}),{keys:!0})}isLoaded(t){return this.default===t||this.m_pTranslations[zs.findDomain(t)]instanceof $s}reset(t=""){this.unload(),this.current=t}translate(t,e,s,n,i,r,...a){const o=this.find(t,e,s,n,r)||t!==this.default&&this.find(this.default,e,s,n,r)||(n&&1!==r?i:s);return a.length>0?o.replace(/%(\d+)/g,((t,e)=>K(R(a,j(e)-1,t)))):o}}Ks.m_pAlternatives={};class js{static get global(){return this.m_pNamespaces[""]||(this.m_pNamespaces[""]=new js(!0,!0))}static create(t){return this.m_pNamespaces[t]||(this.m_pNamespaces[t]=new js(!1,!1))}static translation(t){return this.m_pNamespaces[t]||(this.m_pNamespaces[t]=new js(!1,!0))}constructor(t,e){this.m_pLocale=e?zs:new zs,this.m_pTranslations=t?Ks:new Ks}get locale(){return this.m_pLocale}get default(){return this.m_pTranslations.default}set default(t){this.m_pTranslations.default=t}get current(){return this.m_pTranslations.current}set current(t){this.m_pTranslations.current=t}get domains(){return this.m_pTranslations.domains}get load(){return(t,e=!0,s="enrich")=>this.m_pTranslations.load(t,e,s)}get unload(){return t=>this.m_pTranslations.unload(t)}get isLoaded(){return t=>this.m_pTranslations.isLoaded(t)}get reset(){return t=>this.m_pTranslations.reset(t)}get gettext(){return(t,...e)=>this.m_pTranslations.translate(this.m_pTranslations.current,"",t,!1,"",0,...e)}get dgettext(){return(t,e,...s)=>this.m_pTranslations.translate(t,"",e,!1,"",0,...s)}get ngettext(){return(t,e,s,...n)=>this.m_pTranslations.translate(this.m_pTranslations.current,"",t,!0,e,s,this.m_pLocale.number(s),...n)}get dngettext(){return(t,e,s,n,...i)=>this.m_pTranslations.translate(t,"",e,!0,s,n,zs.number(n,0,!0,t),...i)}get pgettext(){return(t,e,...s)=>this.m_pTranslations.translate(this.m_pTranslations.current,t,e,!1,"",0,...s)}get dpgettext(){return(t,e,s,...n)=>this.m_pTranslations.translate(t,e,s,!1,"",0,...n)}get npgettext(){return(t,e,s,n,...i)=>this.m_pTranslations.translate(this.m_pTranslations.current,t,e,!0,s,n,this.m_pLocale.number(n),...i)}get dnpgettext(){return(t,e,s,n,i,...r)=>this.m_pTranslations.translate(t,e,s,!0,n,i,zs.number(i,0,!0,t),...r)}get _(){return(t,...e)=>this.m_pTranslations.translate(this.m_pTranslations.current,"",t,!1,"",0,...e)}get _n(){return(t,e,s,...n)=>this.m_pTranslations.translate(this.m_pTranslations.current,"",t,!0,e,s,this.m_pLocale.number(s),...n)}}js.m_pNamespaces={};var qs=Object.freeze({__proto__:null,CONTEXT_SEPARATOR:"",Domain:Ks,LOCALE_DEFAULTS:Ds,Locales:zs,Namespace:js,Plurals:Gs,Translation:$s,Translations:Ks,_:function(t,...e){return Ks.translate(Ks.current,"",t,!1,"",0,...e)},_n:function(t,e,s,...n){return Ks.translate(Ks.current,"",t,!0,e,s,zs.number(s),...n)},dgettext:function(t,e,...s){return Ks.translate(t,"",e,!1,"",0,...s)},dngettext:function(t,e,s,n,...i){return Ks.translate(t,"",e,!0,s,n,zs.number(n,0,!0,t),...i)},dnpgettext:function(t,e,s,n,i,...r){return Ks.translate(t,e,s,!0,n,i,zs.number(i,0,!0,t),...r)},dpgettext:function(t,e,s,...n){return Ks.translate(t,e,s,!1,"",0,...n)},gettext:function(t,...e){return Ks.translate(Ks.current,"",t,!1,"",0,...e)},ngettext:function(t,e,s,...n){return Ks.translate(Ks.current,"",t,!0,e,s,zs.number(s),...n)},npgettext:function(t,e,s,n,...i){return Ks.translate(Ks.current,t,e,!0,s,n,zs.number(n),...i)},pgettext:function(t,e,...s){return Ks.translate(Ks.current,t,e,!1,"",0,...s)}});class Ws extends me{constructor(t,e,s,n,i,r,a,o=!1,h=!1,l=!0,u="disabled",c,m=!1){super(),this.m_pDependencies={},this.m_pChanges={},this.m_pChangesBuffer={},this.m_bReloading=!1,this.m_pStencils={exportables:void 0,actionables:void 0},this.m_pChain={states:{},transducers:{},branches:{},conditions:{},slots:{}},this.m_pState=t,this.m_pStates=new as(this),this.m_pTransducer=e,this.m_pBranch=s,this.m_pCondition=n,this.m_bAutoPushForward=o,this.m_bIgnoreValidation=h,this.m_sPreviewMode=u,this.m_pL10n=c||js.create(""),this.m_bPaused=!1,this.m_bStopped=!0,this.m_fnFingerprint=r,this.m_fnStencil=a,this.m_bFingerprint=l,this.m_sFingerprint=l?ze("fingerprint"):void 0,this.m_pLog=[],this.m_bVerbose=m,this.m_fnLogger=t=>console.log(t),this.hook("OnItemPush","synchronous",(()=>{this.m_bPaused=!1,this.m_bStopped=!1,1===this.count&&(this.emitHook("OnStart",{ontology:this}),this.isVerbose&&this.logMessage(`Start (${this.fingerprint})`)),this.invokeNextInstance()})),this.hook("OnItemPop","synchronous",(t=>{this.invokeNextInstance(),0===this.count&&(this.m_bPaused=t.item.isPaused,this.m_bStopped=t.item.isStopped,this.m_bPaused?(this.emitHook("OnPause",{ontology:this}),this.isVerbose&&this.logMessage(`Pause (${this.fingerprint})`)):this.m_bStopped?(this.emitHook("OnStop",{ontology:this}),this.isVerbose&&this.logMessage(`Stop (${this.fingerprint})`)):(this.emitHook("OnFinish",{ontology:this}),this.isVerbose&&this.logMessage(`Finish (${this.fingerprint})`)),this.emitHook("OnEnd",{ontology:this,type:this.isStopped?"stopped":this.isPaused?"paused":"finished"}),this.isVerbose&&this.logMessage(`End (${this.fingerprint})`))})),i&&this.load(i)}chain(t,e){let s="";if(this.m_sFingerprint&&(s=t.id+(this.m_fnFingerprint&&this.m_fnFingerprint(t)||"")),t instanceof is)Nt(this.m_pChain.states,t.id,t);else if(t instanceof Ts)Nt(this.m_pChain.transducers,t.id,t);else if(t instanceof ts)Nt(this.m_pChain.branches,t.id,t),this.m_sFingerprint&&(s+=t.culling);else if(t instanceof Ze)Nt(this.m_pChain.conditions,t.id,t),this.m_sFingerprint&&(s+=t.context);else if(Nt(this.m_pChain.slots,t.id,t),this.m_sFingerprint&&t.required&&(s+="required"),e){const s=t.pipe(e);if(s){const n=t.legacyPipe(e);let i=this.m_pChain.slots[s];F(i)||(i=Nt(this.m_pChain.slots,s,[])),i.push(t),n&&Nt(this.m_pChain.slots,n,i)}}s&&(this.m_sFingerprint=ze(this.m_sFingerprint+s))}get constructors(){return{state:this.m_pState,transducer:this.m_pTransducer,branch:this.m_pBranch,condition:this.m_pCondition}}get ontology(){return this.m_pOntology}get fingerprint(){return this.m_sFingerprint||(this.m_sFingerprint=new Js(this.m_pState,this.m_pTransducer,this.m_pBranch,this.m_pCondition,this.m_pOntology,this.m_fnFingerprint,this.m_fnStencil).fingerprint)}get l10n(){return this.m_pL10n}get states(){return this.m_pStates}get main(){return this.m_pMain}get isLoaded(){return this.states.count>0&&this.main instanceof rs}get isRunning(){return this.count>0}get isStopped(){return this.m_bStopped}get isFinishing(){return this.count>0&&!this.each((t=>!t.isFinishing))}get isFinished(){return!this.isRunning&&!this.isPaused&&!this.isStopped}get isPausing(){return!!this.m_fnPause}get isPaused(){return this.m_bPaused}get isPreview(){return"disabled"!==this.m_sPreviewMode}get isVerbose(){return this.m_bVerbose}set isVerbose(t){this.m_bVerbose=t}get autoPushForward(){return this.m_bAutoPushForward}set autoPushForward(t){this.m_bAutoPushForward!==t&&(this.m_bAutoPushForward=t,this.each((t=>t.restart())))}get ignoreValidation(){return this.m_bIgnoreValidation}set ignoreValidation(t){this.m_bIgnoreValidation!==t&&(this.m_bIgnoreValidation=t,this.each((t=>t.restart())))}get metrics(){return this.m_pMetrics||{states:0,transducers:0,branches:0,conditions:0,slots:0}}get log(){return this.m_pLog}get logger(){return this.m_fnLogger}set logger(t){this.m_fnLogger=t}logMessage(t){this.m_pLog.push(`${b.log}: ${t}`),this.isVerbose&&this.m_fnLogger(`${b.log}: ${t}`)}getData(t,e){if(F(e.property)){const s=e.property.length;for(let n=0;n<s;n++){const s=t[e.property[n]];if(s)return s}}}parse(t,e,s,n=0,i="abort"){const r={states:0,transducers:0,branches:0,conditions:0,slots:0},a={conditions:[],transducers:[]};let o=ws.None;if(t&&T(t.id)){const h=e.branches.create(t,e),l="return"===t.jump?i:K(t.jump),u=this.getData(t,this.m_pState);let c,m=0;this.chain(h),this.m_pMain&&t.id===this.m_pMain.id||r.branches++,X(this.getData(t,this.m_pCondition),(e=>{if(e&&T(e.id)){const s=h.conditions.create(e);s&&(this.chain(s),"each"===t.culling&&a.conditions.push(s),r.conditions++)}else o|=ws.OntologyInvalidCondition,this.logMessage(`Invalid condition data in ontology: ${JSON.stringify(e)}`)})),e.isMain&&this.logMessage("Constructing main branch"),X(u,(t=>{if(m++,t&&T(t.id)){const l=this.states.create(t,h,e,++n);let p=i,d=!1;if("nest"===t.type){const e=R(u,m);e&&T(e.id)?p=e.id:(p=ze(t.id+":return"),d=!0)}if(this.chain(l),r.states++,c&&(c.setSuccessor("live",l),c.setSuccessor("preview",l)),c=l,X(this.getData(t,this.m_pTransducer),(t=>{if(t&&T(t.id)){const e=l.transducers.create(t);this.chain(e),a.transducers.push(e),r.transducers++,e.slots.deserialize(t.slots||[]).each((t=>{this.chain(t,e),r.slots++}))}else o|=ws.OntologyInvalidTransducer,this.logMessage(`Invalid transducer data in ontology: ${JSON.stringify(t)}`)})),X(this.getData(t,this.m_pBranch),(t=>{const e=this.parse(t,l,s,n,p);n=e.enumerator,o|=e.errors,r.states+=e.metrics.states,r.transducers+=e.metrics.transducers,r.branches+=e.metrics.branches,r.conditions+=e.metrics.conditions,r.slots+=e.metrics.slots,a.transducers.push(e.transducers)})),d){const t=this.states.create({id:p},h,e,++n);this.chain(t),r.states++,c&&(c.setSuccessor("live",t),c.setSuccessor("preview",t)),c=t}}else o|=ws.OntologyInvalidState,this.logMessage(`Invalid state data in ontology: ${JSON.stringify(t)}`)})),T(l)&&(this.states.each((t=>t.id===l))?this.logMessage(`Invalid branch jump detected in ontology: ${JSON.stringify(t)}`):(h.setSuccessor("live",void 0),"abort"!==l&&function(t,e,s){(t[e]||Nt(t,e,[])).push(s)}(s,l,h)))}else o|=ws.OntologyInvalidBranch,this.logMessage(`Invalid branch data in ontology: ${JSON.stringify(t)}`);return{errors:o,metrics:r,transducers:a,enumerator:n}}transducers(t){if(this.m_pTransducers){const s=(n,...i)=>{X(n.conditions.length>1?n.conditions:[void 0],(r=>{const a=i.concat(...r?[r]:[]);X(n.transducers,(n=>{n instanceof Ts?t(n,a,0===a.length?"*":1===a.length?a[0].context:ze(e.iterateToString(a,"",(t=>t.context)))):s(n,...a)}))}))};s(this.m_pTransducers)}}getFromChain(t,e){if(e)switch(t){case"state":return this.m_pChain.states[e];case"transducer":return this.m_pChain.transducers[e];case"branch":return this.m_pChain.branches[e];case"condition":return this.m_pChain.conditions[e];case"slot":return this.m_pChain.slots[e]}}invokeNextInstance(){if(!this.isStopped&&!this.isPaused&&this.count>0){let t=this.each((t=>t.isRunning));this.each((e=>{e.isRunning||t&&!e.allowConcurrency||(t=!0,e.start())}))}}onInstanceCreate(t){this.emitHook("OnInstanceCreate",{ontology:this,instance:t})}onInstanceStart(t){this.emitHook("OnInstanceStart",{ontology:this,instance:t})}onInstanceData(t,e){this.emitHook("OnInstanceData",{ontology:this,instance:t,transducer:e.transducer,slot:e.slot,data:e.data,id:e.id,context:e.key,get value(){return e.value}})}onInstanceProcessing(t,e){this.emitHook("OnInstanceProcessing",{ontology:this,instance:t,processing:e})}onInstanceStepForward(t,e){return!1}onInstanceUpdate(t){}onInstanceEnd(t,e){this.emitHook("OnInstanceEnd",{ontology:this,instance:t,type:e})}onInstanceFinishing(t,e){return!0}onInstanceFinish(t){this.emitHook("OnInstanceFinish",{ontology:this,instance:t})}onInstancePause(t){this.emitHook("OnInstancePause",{ontology:this,instance:t})}onInstanceStop(t){this.emitHook("OnInstanceStop",{ontology:this,instance:t})}spawn(t="single",e,s){if(!this.isLoaded)throw new Error("Cannot start the state machine, because no ontology is loaded.");const n=this;return this.pushToMatrix(new Vs({get fingerprint(){return n.fingerprint},l10n:this.l10n,states:this.states,get preview(){return n.m_sPreviewMode},get autoPushForward(){return n.autoPushForward},get ignoreValidation(){return n.ignoreValidation},chain:{state:t=>this.getFromChain("state",t),transducer:t=>this.getFromChain("transducer",t),branch:t=>this.getFromChain("branch",t),condition:t=>this.getFromChain("condition",t),slot:t=>this.getFromChain("slot",t)},events:{onInstanceCreate:t=>this.onInstanceCreate(t),onInstanceStart:t=>this.onInstanceStart(t),onInstanceData:(t,e)=>this.onInstanceData(t,e),onInstanceProcessing:(t,e)=>this.onInstanceProcessing(t,e),onInstanceStepForward:(t,e)=>this.onInstanceStepForward(t,e),onInstanceUpdate:t=>this.onInstanceUpdate(t),onInstanceFinishing:(t,e)=>this.onInstanceFinishing(t,e),onInstanceEnd:(t,e)=>this.onInstanceEnd(t,e),onInstanceFinish:t=>this.onInstanceFinish(t),onInstancePause:t=>this.onInstancePause(t),onInstanceStop:t=>this.onInstanceStop(t)},spawn:(t,e)=>this.pushToMatrix(t,{index:e,recalculate:!0,emit:"push"}),dependencies:t=>this.m_pDependencies[t.id]||{},iterate:t=>n.transducers(t),stencil:t=>n.stencil(t),hasChanged:(t,e)=>{const s=n.m_pChanges[t];return!(!s||!s.changed)&&(e&&(0===B(this.m_pChangesBuffer)&&kt((()=>{X(this.m_pChangesBuffer,((t,e)=>{const s=n.m_pChanges[e];s&&(s.changed=!1),delete this.m_pChangesBuffer[e]}),{keys:!0})})),this.m_pChangesBuffer[t]=!0),!0)},get logger(){return n.isVerbose?t=>n.logger(t):void 0}},t,this.main,e,s))}stencil(t="exportables"){switch(t){case"exportables":return this.m_pStencils.exportables||(this.m_pStencils.exportables=ze("stencil:exportables"),this.transducers(((t,e,s)=>{this.m_fnStencil&&!this.m_fnStencil(t)||t.slots.each((e=>{W(e.exportable,!e.actionable)&&(this.m_pStencils.exportables=ze(this.m_pStencils.exportables+t.id+e.type+e.reference+s))}))}))),this.m_pStencils.exportables;case"actionables":return this.m_pStencils.actionables||(this.m_pStencils.actionables=ze("stencil:actionables"),this.transducers(((t,e,s)=>{this.m_fnStencil&&!this.m_fnStencil(t)||t.slots.each((e=>{e.actionable&&(this.m_pStencils.actionables=ze(this.m_pStencils.actionables+t.id+e.type+e.reference+s))}))}))),this.m_pStencils.actionables}}load(t){if(w(t))return this.load(JSON.parse(t));this.m_bReloading=!0,this.m_pLog=[],this.unload(),this.logMessage("Start loading ontology"),this.m_pOntology=t,this.m_pMain=this.states.main(),this.m_bReloading=!1,this.chain(this.m_pMain);const e={},s=this.parse(Z(t,{id:this.m_pMain.id}),this.m_pMain,e),n=(t,e,s)=>{const n=this.m_pDependencies[t.id];n?n[e.id]=s:this.m_pDependencies[t.id]={[e.id]:s}},i=t=>{X(t.transducers,(t=>{var e;if(t instanceof Ts){const s=JSON.stringify(t.props);(null===(e=this.m_pChanges[t.id])||void 0===e?void 0:e.props)!==s&&(this.m_pChanges[t.id]={props:s,changed:!0},this.m_pChangesBuffer[t.id]&&delete this.m_pChangesBuffer[t.id],X(this.m_pChain.slots,((e,i)=>{e&&s.indexOf(i)>0&&(e instanceof _s?n(e,t,!1):X(e,(e=>n(e,t,!1))))}),{keys:!0}),t.slots.each((e=>n(e,t,!0))))}else i(t)}))};return i(this.m_pTransducers=s.transducers),this.states.each((t=>{X(e[t.id],(e=>{e.setSuccessor("live",t)})),qt(e,t.id)})),X(e,((t,e)=>{let n="";X(t,(t=>{n+=`${""===n?"":", "} ${t instanceof ts?"branch":"state"} '${t.id}'`})),s.errors|=ws.OntologyInvalidJump,this.logMessage(`Jump reference '${e}' not found (reference used in the following states/branches: ${n})`)}),{keys:!0}),s.errors===ws.None&&this.m_pMain?(this.m_pMetrics=s.metrics,this.logMessage(`Ontology loaded (${s.metrics.states} state${1===s.metrics.states?"":"s"}, ${s.metrics.transducers} transducer${1===s.metrics.transducers?"":"s"}, ${s.metrics.branches} branch${1===s.metrics.branches?"":"es"}, ${s.metrics.conditions} condition${1===s.metrics.conditions?"":"s"} and ${s.metrics.slots} slot${1===s.metrics.slots?"":"s"})`),this.emitHook("OnLoad",{ontology:this})):(this.logMessage("Ontology not loaded, an error occurred."),this.unload()),s.errors}unload(){this.stop(),this.isLoaded&&(this.m_pStates.clear(),this.logMessage("Ontology unloaded"),this.emitHook("OnUnload",{ontology:this})),this.m_bReloading||(X(this.m_pDependencies,((t,e)=>{delete this.m_pDependencies[e]}),{keys:!0}),X(this.m_pChanges,((t,e)=>{delete this.m_pChanges[e]}),{keys:!0})),this.m_pChain={states:{},transducers:{},branches:{},conditions:{},slots:{}},this.m_pOntology=void 0,this.m_pMain=void 0,this.m_pMetrics=void 0,this.m_sFingerprint=this.m_bFingerprint?ze("fingerprint"):void 0,this.m_pStencils.exportables=void 0,this.m_pStencils.actionables=void 0}start(t,e){return this.spawn("single",t,e)}stop(){return this.m_fnPause&&(this.m_fnPause("VFSM stopped."),this.m_fnPause=void 0),this.m_bStopped=!0,this.m_bReloading||X(this.m_pChanges,(t=>{t.changed=!0})),!!this.isRunning&&(this.reverseEach((t=>{t.stop()})),!0)}snapshot(t){const e=[];if(this.each((t=>{e.push(t.snapshot)})),e.length>0){const s={a:e};return k(t)&&Nt(s,"b",t),s}}pause(t,e){if(e){const s=new Promise(((s,n)=>{const i=this.snapshot(t);i&&this.isRunning&&!this.m_fnPause?(this.each((t=>t.data.freeze())),this.m_fnPause=n,e(i,(e=>{if(this.m_fnPause=void 0,e||this.each((t=>t.data.unfreeze())),e){const e=this.pause(t);e?s(e):n("VSFM cannot be paused.")}else n("VSFM pause canceled.")}))):n(this.m_fnPause?"VFSM already pausing.":"VSM not running.")}));return s.catch((t=>{this.logMessage(t||"Pause error!")})),s}if(this.isRunning){const e={a:[]};return this.m_bPaused=!0,this.reverseEach((t=>{const s=t.pause();s&&e.a.splice(0,0,s)})),k(t)&&Nt(e,"b",t),e}}resume(t){return this.stop(),B(t.a)>0&&(X(t.a,(t=>{this.spawn(t.e?"multi":"single",t)})),kt((()=>{this.isRunning&&this.emitHook("OnResume",{ontology:this,data:t.b})})),this.isRunning)}previewMode(t,e=!0){return t&&this.m_sPreviewMode!==t&&(this.m_sPreviewMode=t,e&&this.each((t=>t.restart()))),this.m_sPreviewMode}forEach(t,e="all",s){return this.states.each((n=>n!==s&&(!("states"!==e&&"all"!==e||!t(n))||(!!n.transducers.each((n=>n!==s&&!("transducers"!==e&&"all"!==e||!t(n))))||!!n.branches.each((n=>n!==s&&(!("branches"!==e&&"all"!==e||!t(n))||n.conditions.each((n=>n!==s&&!("conditions"!==e&&"all"!==e||!t(n)))))))))))}destroy(){this.unload(),super.destroy()}}class Js extends Ws{constructor(t,e,s,n,i,r,a){super(t,e,s,n,i,r,a)}}function Ys(...t){return e=>{Nt(e,"property",t)}}let Zs=class extends Ze{constructor(t,e){super(t,e)}get id(){return this.hash}get runner(){return this.branch.runner}onCondition(t,e){if(!this.props.disabled&&this.runner){const s=this.runner.namespace.conditionBlocks.create(this,t);if(s){const n=(this.props.block?this.props.block.slot:"")||"";if(n&&!t.mutableValueOf(n))return!1;const i=oe("condition",s,{callback:e});return!(A(i)||i instanceof es)||i}}return!1}onApproved(t){if(!this.props.disabled&&"each"===this.branch.culling){const e=(this.props.block?this.props.block.slot:"")||"";if(e){const s=t.mutableValueOf(e);s&&s.mountContext(t)}}}};Zs=hs([Ys("conditions")],Zs);let Qs=class extends ts{get id(){return this.hash}get runner(){return this.section.runner}get section(){return this.state}onCondition(){return!0}onLeave(t){this.runner&&this.runner.onInstanceBranchLeave(t,this),super.onLeave(t)}};Qs=hs([Ys("branches")],Qs);let Xs=class extends is{constructor(){super(...arguments),this.m_pValidation={}}get id(){return this.hash}get runner(){return this.ontology}get percentageInRunner(){const t=this.runner.metrics.states;return t>0?Math.floor(Math.min(this.enumerator-1,t)/t*100):0}getValidation(t){return this.m_pValidation[t.instance.id+t.key]||"unknown"}onEnterCondition(){return!0}onEnter(t,e){return this.runner.onInstanceSection(t,this,e),this.runner.onInstanceProgress(t.instance,this.percentageInRunner),e}onLeaveCondition(){return!0}onLeave(t){t.instance.isRunning&&"paginated"===this.runner.mode&&(this.runner.onInstanceSectionLeave(t.instance,"forward",this),bt((()=>{this.isPopped||this.runner.onInstanceStep(t.instance,"forward")})),super.onLeave(t))}onCancel(t){t.instance.isRunning&&"paginated"===this.runner.mode&&(this.runner.onInstanceSectionLeave(t.instance,"backward",this),bt((()=>{this.isPopped||this.runner.onInstanceStep(t.instance,"backward")})),super.onCancel(t))}onValidate(t){return Nt(this.m_pValidation,t.instance.id+t.key,"unknown"),!0}onValidated(t,e,s){Nt(this.m_pValidation,t.instance.id+t.key,e),this.runner.onInstanceValidated(t.instance,e,s),super.onValidated(t,e,s)}onEvaluate(t,e){this.runner.onInstanceSectionEvaluating(t.instance,this,e),super.onEvaluate(t,e)}};var tn,en;Xs=hs([Ys("sections","clusters")],Xs),function(t){t[t.None=0]="None",t[t.Formatting=1]="Formatting",t[t.Paragraphs=2]="Paragraphs",t[t.Breaks=4]="Breaks",t[t.Hyperlinks=8]="Hyperlinks",t[t.Headings=16]="Headings",t[t.Blockquotes=32]="Blockquotes",t[t.Code=64]="Code",t[t.InlineCode=128]="InlineCode",t[t.Images=256]="Images",t[t.All=511]="All"}(tn||(tn={})),function(t){t[t.Text=1]="Text",t[t.Content=2]="Content",t[t.Newline=4]="Newline",t[t.Space=8]="Space",t[t.Heading=16]="Heading",t[t.Quote=32]="Quote",t[t.Code=64]="Code",t[t.InlineCode=128]="InlineCode"}(en||(en={}));class sn{static parse(t,e){return new sn(t,e)}constructor(t,e){if(this.m_nFeatures=tn.All,this.m_bMentions=!1,this.m_bReferences=!1,this.m_pBlocks=[],this.m_nOpcode=en.Newline,this.m_nIndex=0,this.m_sBuffer="",this.m_pTags=[],this.m_nStopIndex=-1,this.m_sMarkdown=t.replace(/(\r\n|[\r\n])/,"\n"),this.m_nLength=this.m_sMarkdown.length,/[\n\\\*_~`#>\[!@]/g.test(this.m_sMarkdown))e&&("number"==typeof e.features&&(this.m_nFeatures=e.features),this.m_pMentions=e.mentions,this.m_pReferences=e.references,this.m_sStopWord=e.stopWord,this.m_sStopWord&&(this.m_sStopChar=this.m_sStopWord.charAt(0))),this.parse();else{if(e&&e.stopWord){const t=this.m_sMarkdown.indexOf(e.stopWord);-1!==t&&(this.m_sMarkdown=this.m_sMarkdown.substr(0,t),this.m_nStopIndex=t)}this.m_pBlocks.push({content:this.m_sMarkdown.replace(/\s\s+/g," ")})}}get features(){return this.m_nFeatures}get abstractSyntaxTree(){const t=this.m_pBlocks.length;if(1===t){const t={content:this.m_pBlocks[0].content,value:this.m_pBlocks[0].value};return"paragraph"!==this.m_pBlocks[0].type&&(t.type=this.m_pBlocks[0].type),t}return{content:0===t?"":this.m_pBlocks}}get text(){let t="";return this.map(((e,s)=>{switch(e){case"break":case"h1":case"h2":case"h3":case"h4":case"h5":case"h6":case"quote":case"codeline":return void(t+=(""===t?"":"\n")+s);case"paragraph":return void(t+=(""===t?"":"\n\n")+s);case"codeblock":case"image":return;default:return void(t+=s)}})),t.replace(/(^\s*)|(\s*$)/g,"").replace(/[^\S\r\n\.]{2,}/g," ").replace(/\n[^\S\r\n\.]/g,"\n")}get hasMentions(){return this.m_bMentions}get hasReferences(){return this.m_bReferences}parse(){for(;this.m_nIndex<this.m_nLength;this.m_nIndex++){if(this.m_sBuffer=this.m_sMarkdown.charAt(this.m_nIndex),this.m_nOpcode&en.Code){if("\n"===this.m_sBuffer){this.m_nOpcode&en.Newline&&this.m_pTag&&"codeblock"===this.m_pTag.type&&"string"!=typeof this.m_pTag.content&&(!Array.isArray(this.m_pTag.content)||this.m_pTag.content.length>0)&&(this.m_pTag.content=[...Array.isArray(this.m_pTag.content)?this.m_pTag.content:[this.m_pTag.content],{parent:this.m_pTag,type:"codeline",content:""}]),this.m_nOpcode|=en.Newline,this.m_pText=void 0;continue}}else{if("\n"===this.m_sBuffer){this.features&tn.Paragraphs?this.m_nOpcode&en.Newline&&this.m_pText&&(this.m_nOpcode&=~en.Quote,this.block("paragraph")):this.features&tn.Breaks&&this.m_nOpcode&en.Text&&(this.m_nOpcode&=~en.Content,this.m_pTags.push("break")),this.m_nOpcode|=en.Newline,this.m_nOpcode&en.Heading&&(this.m_nOpcode&=~en.Heading,this.block("paragraph"));continue}if(this.parseLinebreak())continue;if(this.m_nIndex>0&&(this.m_nOpcode&en.Newline||this.m_nOpcode&en.Space)&&" "===this.m_sBuffer)continue;if(this.m_nIndex>0&&(this.m_nOpcode&en.Newline||this.m_nOpcode&en.Space)&&"\t"===this.m_sBuffer)continue}this.parseStopWord()||(!(this.parseEscapeCharacters()||this.parseCodeBlock()||this.parseBuffer("mention",this.m_pMentions,"@",(()=>this.m_bMentions=!0))||this.parseBuffer("reference",this.m_pReferences,"#",(()=>this.m_bReferences=!0))||this.parseCode())&&(this.parseHeading()||this.parseBlockquotes()||this.parseImage()||this.parseHyperlinks()||this.features&tn.Formatting&&(this.parseTag("bold+italic","*","triple")||this.parseTag("bold","*","double")||this.parseTag("italic","*","single")||this.parseTag("underline","_","single-or-double")||this.parseTag("strikethrough","~","single-or-double")))||this.flush(),0===this.m_pTags.length&&(this.m_nOpcode&=~en.Newline," "!==this.m_sBuffer&&"\t"!==this.m_sBuffer||(this.m_nOpcode|=en.Space)))}}pushBlock(t,e){const s={parent:void 0,type:t,content:"",value:e};return this.m_pBlocks.push(s),this.m_nOpcode&=~en.Content,s}block(t,e){this.m_pBlock={type:t,value:e},this.m_pTags=[],this.m_nOpcode&=~en.InlineCode}pushTag(t){this.m_pTags.push(t)}popTag(t){const e=this.m_pTags.length;let s=this.m_pTag;if(e>0)for(let s=e-1;s>=0;s--)if(this.m_pTags[s]===t)return this.m_pTags.splice(s,this.m_pTags.length-s),!0;for(;s;){if(s.type===t)return this.m_pTag=this.m_pText=s.parent,!0;s=s.parent}return!1}isTagActive(t){const e=this.m_pTags.length;let s=this.m_pTag;if(e>0)for(let s=e-1;s>=0;s--)if(this.m_pTags[s]===t)return!0;for(;s;){if(s.type===t)return!0;s=s.parent}return!1}tag(t){return!this.popTag(t)&&(this.pushTag(t),!0)}flush(t=!1){if(!this.m_sBuffer&&!t)return{content:""};this.m_pBlock?(this.m_pTag=this.m_pText=this.pushBlock(this.m_pBlock.type,this.m_pBlock.value),this.m_pBlock=void 0,this.m_nOpcode&en.Code&&(this.m_pTag.content=this.m_pText={parent:this.m_pTag,type:"codeline",content:""})):this.m_pTag||(this.m_pTag=this.m_pText=this.pushBlock("paragraph"));let e=this.m_pTags.shift();for(;e;)this.m_pText={parent:this.m_pTag,type:e,content:""},"string"==typeof this.m_pTag.content&&this.m_pTag.content&&(this.m_pTag.content={parent:this.m_pTag,content:this.m_pTag.content}),this.m_pTag.content="string"==typeof this.m_pTag.content?this.m_pText:[...Array.isArray(this.m_pTag.content)?this.m_pTag.content:[this.m_pTag.content],this.m_pText],"break"===e?this.m_pText=this.m_pTag:this.m_pTag=this.m_pText,e=this.m_pTags.shift();return this.m_pText&&"string"==typeof this.m_pText.content||(this.m_pText={parent:this.m_pTag,content:""},this.m_pTag.content=[...Array.isArray(this.m_pTag.content)?this.m_pTag.content:[this.m_pTag.content],this.m_pText],"codeblock"===this.m_pTag.type&&(this.m_pText.type="codeline")),"\t"===this.m_sBuffer?(this.m_pText.content+="codeline"===this.m_pText.type?"  ":" ",{content:""}):(this.m_nOpcode&en.Newline&&this.m_nOpcode&en.Content&&(t||" "!==this.m_sBuffer)&&(this.m_pText.content+=" "),this.m_pText.content+=this.m_sBuffer,this.m_nOpcode|=en.Text,this.m_nOpcode|=en.Content,this.m_nOpcode&=~en.Space,t&&(this.m_sBuffer=""),this.m_pText)}parseLinebreak(){return!!(this.features&tn.Paragraphs&&this.features&tn.Breaks&&this.m_nOpcode&en.Content&&" "===this.m_sBuffer&&this.m_nIndex+2<this.m_nLength&&" "===this.m_sMarkdown.charAt(this.m_nIndex+1)&&"\n"===this.m_sMarkdown.charAt(this.m_nIndex+2))&&(this.m_nIndex++,this.m_nOpcode&=~en.Space,this.m_nOpcode&=~en.Content,this.m_pTags.push("break"),!0)}parseEscapeCharacters(){if("\\"===this.m_sBuffer&&this.m_nIndex+1<this.m_nLength){const t=this.m_sMarkdown.charAt(this.m_nIndex+1);if("\\"===t||"*"===t||"_"===t||"~"===t||"`"===t||"#"===t||">"===t||"["===t||"]"===t||"("===t||")"===t||"!"===t||"@"===t)return this.m_sBuffer=t,this.m_nIndex++,!0}return!1}parseTag(t,e,s){if(this.m_sBuffer===e){if("single"!==s&&this.m_nIndex+("triple"===s?2:1)<this.m_nLength&&this.m_sMarkdown.charAt(this.m_nIndex+1)===e&&("triple"!==s||this.m_sMarkdown.charAt(this.m_nIndex+2)===e))this.m_nIndex+="triple"===s?2:1;else if("double"===s||"triple"===s)return!1;if("bold"===t||"italic"===t){if(this.popTag("bold+italic"))return this.tag("bold"===t?"italic":"bold"),!0}else if("bold+italic"===t){const e=this.isTagActive("bold"),s=this.isTagActive("italic");if(this.popTag("bold"),this.popTag("italic"),e&&s)return!0;(e||s)&&(this.popTag(e?"bold":"italic"),t=e?"italic":"bold")}return this.tag(t),!0}return!1}parseBuffer(t,e,s,n){if(e&&this.m_sBuffer===s&&this.m_nIndex+1<this.m_nLength){const s=e.parser(this.m_sMarkdown.substr(this.m_nIndex+1,e.numberOfChars||void 0),this.m_nIndex);if(s&&s.shift>0){this.m_nIndex+=s.shift,this.m_sBuffer="",this.pushTag(t);const e=this.flush(!0);return s.markdown?e.parent&&"code"===e.parent.type?e.content=s.markdown:e.content=sn.parse(s.markdown,{features:this.features&tn.Formatting|this.features&tn.InlineCode|this.features&tn.Hyperlinks|this.features&tn.Images,mentions:this.m_pMentions,references:this.m_pReferences}).abstractSyntaxTree.content:s.text&&(e.content=s.text),e.value=s.value,e.value&&n(),this.popTag(t),!0}}return!1}parseStopWord(){return!(this.m_nOpcode&en.InlineCode||this.m_nOpcode&en.Code||this.m_sBuffer!==this.m_sStopChar||!this.m_sStopWord||this.m_sMarkdown.substr(this.m_nIndex,this.m_sStopWord.length)!==this.m_sStopWord)&&(this.m_nStopIndex=this.m_nIndex,this.m_nIndex=this.m_nLength,!0)}parseHeading(){if(this.features&tn.Paragraphs&&this.features&tn.Headings&&this.m_nOpcode&en.Newline&&"#"===this.m_sBuffer){let t=1,e=this.m_nIndex+1;for(;e<this.m_nLength&&t>=1&&t<=6;){const s=this.m_sMarkdown.charAt(e);if("#"!==s){" "!==s&&(t=0);break}t++,e++}switch(t){case 1:this.block("h1");break;case 2:this.block("h2");break;case 3:this.block("h3");break;case 4:this.block("h4");break;case 5:this.block("h5");break;case 6:this.block("h6");break;default:return!1}return this.m_nIndex+=t,this.m_nOpcode|=en.Heading,!0}return!1}parseBlockquotes(){return!!(this.features&tn.Paragraphs&&this.features&tn.Blockquotes&&this.m_nOpcode&en.Newline&&">"===this.m_sBuffer)&&(this.m_nIndex+1<this.m_nLength&&" "===this.m_sMarkdown.charAt(this.m_nIndex+1)&&this.m_nIndex++,this.m_nOpcode&en.Quote?(this.m_sBuffer=" ",!1):(this.m_nOpcode|=en.Quote,this.block("quote"),!0))}parseImage(){if(this.features&tn.Images&&"!"===this.m_sBuffer&&this.m_nIndex+4<this.m_nLength&&"["===this.m_sMarkdown.charAt(this.m_nIndex+1)){let t="",e="",s=!1;const n=this.m_nIndex++;for(;++this.m_nIndex<this.m_nLength;){if(this.m_sBuffer=this.m_sMarkdown.charAt(this.m_nIndex),!this.parseEscapeCharacters())if(s){if(")"===this.m_sBuffer){if(""!==e){this.pushTag("image");const s=this.flush(!0);s.content=t,s.value=e,this.popTag("image")}return!0}}else if("]"===this.m_sBuffer&&this.m_nIndex+1<this.m_nLength&&"("===this.m_sMarkdown.charAt(this.m_nIndex+1)){s=!0,this.m_nIndex++;continue}s?e+=this.m_sBuffer:t+=this.m_sBuffer}return this.m_nIndex=n,this.m_sBuffer="!",!1}return!1}parseHyperlinks(){if(this.features&tn.Hyperlinks&&"["===this.m_sBuffer&&this.m_nIndex+3<this.m_nLength){const t=sn.parse(this.m_sMarkdown.substr(this.m_nIndex+1),{features:this.features&tn.Formatting|this.features&tn.InlineCode|this.features&tn.Images,mentions:this.m_pMentions,references:this.m_pReferences,stopWord:"]("});if(-1!==t.m_nStopIndex){const e=this.m_nIndex;let s="";for(this.m_nIndex+=t.m_nStopIndex+2;++this.m_nIndex<this.m_nLength;){if(this.m_sBuffer=this.m_sMarkdown.charAt(this.m_nIndex),!this.parseEscapeCharacters()&&")"===this.m_sBuffer){if(""!==s){this.pushTag("hyperlink");const e=this.flush(!0);e.content=t.abstractSyntaxTree.content||s,e.value=s,this.popTag("hyperlink")}return!0}s+=this.m_sBuffer}this.m_nIndex=e,this.m_sBuffer="["}}return!1}parseCode(){return this.features&tn.InlineCode&&"`"===this.m_sBuffer&&(this.m_sBuffer="",this.m_nOpcode=this.m_nOpcode^en.InlineCode,this.tag("code")),!!(this.m_nOpcode&en.InlineCode)}parseCodeBlock(){if(this.features&tn.Paragraphs&&this.features&tn.Code&&this.m_nOpcode&en.Newline&&"`"===this.m_sBuffer&&this.m_nIndex+2<this.m_nLength&&"`"===this.m_sMarkdown.charAt(this.m_nIndex+1)&&"`"===this.m_sMarkdown.charAt(this.m_nIndex+2)){let t="",e=!0;for(this.m_nOpcode=this.m_nOpcode^en.Code,this.m_nIndex+=3,this.m_sBuffer="";this.m_nIndex<this.m_nLength;){const s=this.m_sMarkdown.charAt(this.m_nIndex);if("\n"===s){this.m_nIndex--;break}" "===s||"\t"===s?e=!1:e&&(t+=s),this.m_nIndex++}return this.m_nOpcode&en.Code?this.block("codeblock",t||void 0):this.block("paragraph"),!0}return!!(this.m_nOpcode&en.Code)}mapHelper(t,e,s=!0,n){const i="string"==typeof t.content,r=t.value;if(r&&r.ref&&"string"==typeof r.string)return e(t.type,r.string,r.ref,n,"node");const a=e(t.type,i?t.content:"",t.value,n,s&&!t.type?i?"text":"root":"node");return i||(Array.isArray(t.content)?t.content.forEach((t=>this.mapHelper(t,e,!1,a))):this.mapHelper(t.content,e,!1,a)),a}reduceHelper(t,e){const s=t.value;if(s&&s.ref&&"string"==typeof s.string)return e(t.type,s.string,s.ref);if("string"!=typeof t.content){const s=[];return Array.isArray(t.content)?t.content.forEach((t=>s.push(this.reduceHelper(t,e)))):s.push(this.reduceHelper(t.content,e)),e(t.type,s,t.value)}return e(t.type,t.content,t.value)}map(t){return this.mapHelper(this.abstractSyntaxTree,t)}reduce(t){return this.reduceHelper(this.abstractSyntaxTree,t)}}function nn(t,e){if(t.slot instanceof Ss){if(t.slot.digits)return t.slot.toString(t.value);{const s=t.slot.toValue(t.value);return t.slot.formatString(e.l10n.locale.number(s,t.slot.precision,!!t.slot.separator),1!==s)}}if(t.slot instanceof vs)return t.slot.supportsTime?e.l10n.locale.dateTimeFull(t.slot.toValue(t.value),!0):e.l10n.locale.dateFull(t.slot.toValue(t.value),!0)}function rn(t){return!(!t||64!==t.length||!/[A-Fa-f0-9]{64}/.test(t))}const an=ze("id");function on(t,e){return t=t||"",e&tn.Breaks?t:t.replace(/(\r\n|[\r\n])/g," ")}function hn(t,e,s,n,i){return sn.parse(t,{features:s,mentions:{numberOfChars:64,parser:(t,r)=>{if(rn(t)){const a=e&&e.variableFor(t,(t=>t.props.block&&t.props.block.slot),nn,an);return a?{shift:64,value:{ref:a,get string(){return(i&&r>0?encodeURIComponent(on(null==a?void 0:a.string,s)):on((null==a?void 0:a.display)||(null==a?void 0:a.string),s))||n}}}:{shift:64,text:n}}}}})}function ln(t,e,s){const n=s&&s.placeholder||"";let i=s&&!v(s.features)?s.features:tn.Formatting|tn.Hyperlinks;if(s&&s.lineBreaks&&(i|=tn.Breaks),e){const s=`${e.key}/${t}/${i}/${n}`;return e.instance.readFromCache(s)||e.instance.writeToCache(s,hn(t,e,i,n,!1))}return hn(t,void 0,i,n,!1)}function un(t,e,s="___",n=!1,i=tn.None){if(!e)return hn(t,void 0,i|(n?tn.Breaks:0),s,!1).text;const r=`${e.key}/${t}/${s}/${n}`,a=e.instance.readFromCache(r);if(w(a))return a;const o=a||e.instance.writeToCache(r,hn(t,e,i|(n?tn.Breaks:0),s,!1));return o.hasMentions?o.text:e.instance.writeToCache(r,o.text)}function cn(t,e,s="",n=[]){if(!e)return hn(t,void 0,tn.None,s,!0).text;const i=`${e.key}/${t}/${s}/URL`,r=e.instance.readFromCache(i);if(w(r))return r;const a=r||e.instance.writeToCache(i,hn(t,e,tn.None,s,!0)),o=a.text,h=(/(^https?:\/\/|^\/)(\S+)/i.test(o)||(0===o.indexOf("mailto:")||0===o.indexOf("tel:"))&&o.length>10||lt(n,(t=>0===o.indexOf(`data:${t};base64,`)&&o.length>13+t.length)))&&o||"";return a.hasMentions?h:e.instance.writeToCache(i,h)}function mn(t,e,s){let n=s&&!v(s.features)?s.features:tn.Formatting|tn.Hyperlinks;s&&s.lineBreaks&&(n|=tn.Breaks);const i=s&&s.placeholder||"";if(!e){const e=hn(t,void 0,n,i,!1);if("reduce"in s)return e.reduce(s.reduce);if("map"in s)return e.map(s.map);throw new Error("You need to specify a reduce or map function.")}const r=`${e.key}/${"reduce"in s?"reduce":"map"}/${t}/${n}/${i}`,a=e.instance.readFromCache(r);if(!a||a instanceof sn){const o=a||e.instance.writeToCache(r,hn(t,e,n,i,!1));let h;if("reduce"in s)h=o.reduce(s.reduce);else{if(!("map"in s))throw new Error("You need to specify a reduce or map function.");h=o.map(s.map)}return o.hasMentions?h:e.instance.writeToCache(r,h)}return a}function pn(t){return sn.parse(t,{features:tn.Formatting|tn.Hyperlinks|tn.Breaks,mentions:{numberOfChars:64,parser:t=>{if(rn(t))return{shift:64,text:"___"}}}}).text}class dn{constructor(t,e){this.m_pKeys={},this.m_pNode=t,this.context=e}get view(){return this.m_pNode.runner.isPreview?"preview":this.m_pNode.runner.isTest?"test":"live"}get validation(){return this.context.validationOf(this.m_pNode)}get node(){return this.m_pNode.props}get props(){return this.node.block}get shouldAutoRender(){return this.type.autoRender||!1}get shouldAutoValidate(){return W(this.type.autoValidate,!0)}get isFailed(){return"fail"===this.validation}get isPassed(){return"pass"===this.validation}slotOf(t,e){return this.m_pNode.slots.select(t,e)}valueOf(t,e,s){const n=t instanceof _s?t.slots===this.m_pNode.slots&&t:this.slotOf(t,e);if(n){const t=this.context.mutableValueOf(n);if(t)return s&&(t.useModifier(s.modifier),s.onChange&&t.useListener(s.onChange),s.onContext&&t.useContext(s.onContext),s.prefill&&!t.hasValue&&t.set(s.prefill.value,s.prefill.reference),s.confirm&&t.confirm("shallow"===s.confirm)),t}}immutableValueOf(t){return this.context.immutableValueOf(t)}variableFor(t){return this.context.variableFor(t,(t=>t.props.block&&t.props.block.slot),nn)}parseVariables(t,e="",s=!1){return un(t,this.context,e,s)}key(t="default"){return this.m_pKeys[t]||(this.m_pKeys[t]="_"+ze(`${this.m_pNode.id}/${this.context.key}/${t}`))}rerender(){this.m_pNode.runner.rerender(this.context.instance)}lock(){this.m_pNode.slots.each((t=>{const e=this.valueOf(t);e&&e.lock()}))}unlock(){this.m_pNode.slots.each((t=>{const e=this.valueOf(t);e&&e.unlock()}))}clear(){this.m_pNode.slots.each((t=>{const e=this.valueOf(t);e&&e.clear()}))}}class gn extends dn{mutableValueOf(t){return this.context.mutableValueOf(t)}}let fn=class extends Ts{constructor(t,e){super(t,e),this.m_pBlocks={},this.m_nRerender=0}get id(){return this.hash}get runner(){return this.section.runner}get section(){return this.state}get isVisible(){if(this.props.disabled)return!1;const t=Object.keys(this.m_pBlocks),e=t.length>0&&this.m_pBlocks[t[0]]||void 0;return!(e instanceof gn)&&!!(e||this.props.description||this.props.name&&W(this.props.nameVisible,!0))}block(t){const e=this.m_pBlocks[t.instance.id+t.key]||Nt(this.m_pBlocks,t.instance.id+t.key,this.runner.namespace.nodeBlocks.create(this,t));return e&&Nt(e,"context",t),e}onEnterCondition(t,e){if(this.props.disabled)return!1;const s=this.block(t);if(s){const t=oe("condition",s,{callback:e});return!(A(t)||t instanceof es)||t}return!0}onEnter(t,e){const s=this.block(t);if(this.runner.onInstanceNode(t,this,e),s){if(s instanceof gn)return t.instance.createTransaction(this,(()=>s.do(e)));t.instance.data.unhookContext(s),t.instance.data.hook("OnValueChange","framed",(t=>{t.transducer===this&&e.done()}),s),s.shouldAutoRender&&t.instance.data.hook("OnValueChange","synchronous",(t=>{t.transducer===this&&(this.m_nRerender=St((()=>{this.m_nRerender=0,s.rerender()}),this.m_nRerender))}),s)}return e}onLeave(t){if(0!==this.m_nRerender&&(this.m_nRerender=Ct(this.m_nRerender)),"paginated"!==this.runner.mode)return;const e=this.block(t);if(e){const s={type:"left"};t.instance.data.unhookContext(e),oe("destroy",e,s)}}onCancel(t){if(0!==this.m_nRerender&&(this.m_nRerender=Ct(this.m_nRerender)),"paginated"!==this.runner.mode)return;const e=this.block(t);if(e){const s={type:"canceled"};t.instance.data.unhookContext(e),oe("destroy",e,s)}}onValidate(t,e,s){const n=this.block(t);if(n){if(n.shouldAutoValidate&&this.slots.each((e=>{if(e.required){const s=t.mutableValueOf(e);if(!s||!s.hasValue)return!0;if(!s.reference&&w(s.value)&&""===s.value)return!0}return!1})))return!1;const i=oe("validator",n,{callback:s,current:e});return i instanceof es&&n.rerender(),!(A(i)||i instanceof es)||i}return!0}onValidated(t,e,s){const n=this.block(t);n&&n.rerender(),super.onValidated(t,e,s)}onSideEffect(t){if(!this.props.disabled){const e=this.m_pBlocks[t.instance.id+t.key];e instanceof gn&&t.instance.createTransaction(this,(()=>e.do()))}}};fn=hs([Ys("nodes")],fn);class _n{constructor(t,e){this.m_pCondition=t,this.context=e}get nodeRef(){return!this.m_pNode&&this.props.node&&this.m_pCondition.runner&&this.m_pCondition.runner.forEach((t=>(t.props.id===this.props.node&&(this.m_pNode=t),this.m_pNode instanceof fn)),"transducers"),this.m_pNode}get sectionRef(){return!this.m_pSection&&this.props.section&&this.m_pCondition.runner&&this.m_pCondition.runner.forEach((t=>(t.props.id===this.props.section&&(this.m_pSection=t),this.m_pSection instanceof Xs)),"states"),this.m_pSection}get branchRef(){return!this.m_pBranch&&this.props.branch&&this.m_pCondition.runner&&this.m_pCondition.runner.forEach((t=>(t.props.id===this.props.branch&&(this.m_pBranch=t),this.m_pBranch instanceof Qs)),"branches"),this.m_pBranch}get view(){return this.m_pCondition.runner?this.m_pCondition.runner.isPreview?"preview":this.m_pCondition.runner.isTest?"test":"live":"live"}get condition(){return this.m_pCondition.props}get props(){return this.condition.block}get node(){var t;return null===(t=this.nodeRef)||void 0===t?void 0:t.props}get section(){var t;return null===(t=this.sectionRef)||void 0===t?void 0:t.props}get branch(){var t;return null===(t=this.branchRef)||void 0===t?void 0:t.props}get slots(){var t;return null===(t=this.nodeRef)||void 0===t?void 0:t.slots}slotOf(t){const e=this.context.instance.data.forSlot(t||this.props.slot||"");return e&&e.slot}valueOf(t,e){if(this.nodeRef){const s=t instanceof _s?t:this.nodeRef.slots.select(t||this.props.slot||"",e);return s&&s.slots===this.nodeRef.slots&&this.context.immutableValueOf(s)||void 0}}immutableValueOf(t){return this.context.immutableValueOf(t||this.props.slot||"")}variableFor(t){return this.context.variableFor(t,(t=>t.props.block&&t.props.block.slot),nn)}parseVariables(t,e="",s=!1){return un(t,this.context,e,s)}}class bn{constructor(t){this.m_pBlocks={},this.m_sIdentifier=t}get identifier(){return this.m_sIdentifier}ofType(t){return this.m_pBlocks[t]}register(t,e,s,n){n&&0===e.indexOf("@tripetto/")&&Nt(this.m_pBlocks,`tripetto-${e.substring(10)}`,t),X(s,(e=>{Nt(this.m_pBlocks,e,t)})),Nt(t,"identifier",e),t.prototype.type=Nt(this.m_pBlocks,e,t)}create(t,e){if(t.props.block){const s=this.ofType(t.props.block.type);if(s)return new s(t,e)}}}function yn(t,s,n){let i="",r="";return X(t,(t=>{n&&1===s.length&&(t=e.replace(t,s,`\\${s}`)),t!==r&&(i+=(""===i?"":s)+t,r=t)})),i}function vn(t,e,s,n=" / ",i=!1){const r=[];return t.transducers(((a,o,h)=>{if(a.props.block){const l=ht(a.slots.all,(t=>!(!("all"===e||"exportables"===e&&W(t.exportable,!t.actionable)||"actionables"===e&&t.actionable)||s&&!lt(s,(e=>t.id===e))))),u=st(l,((t,e)=>t+(e.alias||e.name?1:0)),0)||0;X(l,(e=>{const s=t.data.forSlot(e);if(s){let c=[e.alias||e.name||""];c[0]||(c[0]=pn(a.props.name||"")||pn(a.props.placeholder||""),c[0]&&l.length-u>1&&e.label&&c.push(e.label),!c[0]&&e.label&&(c[0]=e.label)),o.length>0&&(c=ht(et(o,(e=>{if(e.props.block){const s=e.props.block;if(s.slot){const e=t.lookup.slot(s.slot);if(e instanceof _s){const t=e.alias||e.name||"";if(t)return t}}if(s.node){const e=t.lookup.transducer(s.node);if(e instanceof fn){const t=e.props.name||e.props.placeholder;if(t)return t}}if(s.section){const e=t.lookup.state(s.section);if(e instanceof Xs){const t=e.props.name;if(t)return t}}if(s.branch){const e=t.lookup.branch(s.branch);if(e instanceof Qs){const t=e.props.name;if(t)return t}}}return""})),(t=>!!t)).concat(...c));let m=a.section;for(;m;)m.props.alias&&c.splice(0,0,m.props.alias),m=m.ancestor;r.push({node:a,block:{type:a.props.block.type,version:a.props.block.version},slot:e,name:yn(c,n,i),context:h,key:ze(`${e.id}/${h}`),values:s,value:s.values[h],exportable:W(e.exportable,!e.actionable),actionable:e.actionable||!1})}}))}})),r}function kn(t){try{return t.normalize("NFC")}catch(e){return t}}var Sn,Cn;!function(t){function s(t,e){return{index:e,name:t.name,type:t.block.type,version:t.block.version,get form(){let e=t.node.section;for(;e;){if("nest"===e.props.type)return{id:e.id,name:e.props.name,reference:e.props.reference,version:e.props.version,alias:e.props.alias};e=e.ancestor}},get forms(){const e=[];let s=t.node.section;for(;s;)"nest"===s.props.type&&e.splice(0,0,{id:s.id,name:s.props.name,reference:s.props.reference,version:s.props.version,alias:s.props.alias}),s=s.ancestor;return e},get node(){return{id:t.node.id,key:ze(`${t.node.id}/${t.context}`),context:t.context,props:()=>t.node.props}},slot:t.slot.reference,datatype:t.slot.type,string:t.value&&kn(t.slot.toString(t.value.value))||"",value:t.value&&t.value.value,modified:t.values.isModified(t.key),reference:t.value&&t.value.reference,display:t.value&&t.value.display,time:t.value&&t.value.time,exportable:t.exportable,actionable:t.actionable,key:t.key}}function n(t,s){return{get fingerprint(){return t.fingerprint},get stencil(){return t.stencil},fields:e.iterateToString(t.fields,",",(t=>`"${e.replace(t.name,'"','""')}"`)),record:e.iterateToString(t.fields,s,(t=>`"${e.replace(t.string,'"','""')}"`))}}function i(t,e,n=" / ",i=!1){const r=t instanceof Es?t.instance:t;let a=0;return{get fingerprint(){return r.fingerprint},get stencil(){return r.stencil("exportables")},fields:et(vn(r,"exportables",e,n,i),(t=>s(t,a++)))}}function r(t,e,s=" / ",n=!1){const r=t instanceof Es?t.instance:t;return{get fingerprint(){return r.fingerprint},get stencil(){return r.stencil("exportables")},fields:ht(i(r,e,s,n).fields,(t=>E(t.time)))}}function a(t,e,s=" / ",n=!1){const r=t instanceof Es?t.instance:t;return{get fingerprint(){return r.fingerprint},get stencil(){return r.stencil("exportables")},fields:ht(i(r,e,s,n).fields,(t=>t.modified))}}t.values=function(t,e){const s=t instanceof Es?t.instance:t,n={};return X(s.data.all,(t=>{const i=t.transducer,r=i.props.block;!r||e&&!lt(e,(e=>t.slot.id===e))||Nt(n,t.slot.id,{get fingerprint(){return s.fingerprint},node:{id:i.id,get name(){return pn(i.props.name||"")||pn(i.props.placeholder||"")}},block:{type:r.type,version:r.version},slot:{id:t.slot.id,reference:t.slot.reference,name:t.slot.alias||t.slot.name||"",label:t.slot.label||""},values:t.values})})),n},t.exportables=i,t.exportablesWithData=r,t.exportablesDiff=a,t.fields=function(t,e,s=" / ",n=!1){return i(t,e,s,n)},t.NVPs=function(t,e){const s={};return(t instanceof Vs||t instanceof Es?i(t):t).fields.forEach((t=>{if(t.name){let n=t.name,i=1;for(;k(s[n]);)n=`${t.name} (${++i})`;s[n]=x(e)?e(t):"strings"!==e&&(v(t.value)||A(t.value)||E(t.value))?t.value:t.string}})),s},t.CSV=function(t,e,s=" / ",r=","){return n(i(t instanceof Es?t.instance:t,e,s),r)},t.CSVWithData=function(t,e,s=" / ",i=","){return n(r(t instanceof Es?t.instance:t,e,s),i)},t.CSVDiff=function(t,e,s=" / ",i=","){return n(a(t instanceof Es?t.instance:t,e,s),i)},t.actionables=function(t){const e=t instanceof Es?t.instance:t,s={};let n=!1;if(X(vn(e,"actionables"),(t=>{const e=ze(`${t.node.id}/${t.context}`);(s[e]||(s[e]={key:e,type:t.block.type,version:t.block.version,get node(){return{id:t.node.id,key:e,context:t.context,props:()=>t.node.props}},data:[]})).data.push({key:t.key,name:t.name,slot:t.slot.reference,datatype:t.slot.type,string:t.value&&kn(t.slot.toString(t.value.value))||"",value:t.value&&t.value.value,modified:t.values.isModified(t.key),reference:t.value&&t.value.reference,display:t.value&&t.value.display,time:t.value&&t.value.time}),!n&&t.value&&t.value.time&&(n=!0)})),n)return{get fingerprint(){return e.fingerprint},get stencil(){return e.stencil("actionables")},nodes:et(s,(t=>t))}},t.dataset=function(t,e="/",n=!0){const i=t instanceof Es?t.instance:t,r={};let a=0;return X(vn(i,"all",void 0,e,n),(t=>{let e=0;const n=()=>(t.name||t.key)+(e>0?` (${e+1})`:"");for(;r[n()];)e++;Nt(r,n(),s(t,a++))})),r},t.typedDataset=function(t){const n=t instanceof Es?t.instance:t,i={},r={};let a=0;return X(vn(n,"all",void 0,"\0",!0),(t=>{const n=(t.name||t.key).split("\0");let o=i,h="";for(let i=0;i<n.length;i++)if(i+1<n.length){if(n[i]){let t=0;const e=()=>n[i]+(t>0?` (${t+1})`:"");for(;o[e()]&&!r[h+"\0"+e()];)t++;o=o[e()]||Nt(o,e(),{}),h+="\0"+e(),r[h]=!0}}else if(n[i]){let r=0;const h=()=>n[i]+(r>0?` (${r+1})`:"");for(;o[h()];)r++;const l=s(t,a++);Nt(l,"name",e.replace(l.name,"\0"," / ")),Nt(o,h(),l)}})),i}}(Sn||(Sn={})),function(t){t.values=function(t,e,s){const n=t instanceof Es?t.instance:t;let i=!1;return X(e,((t,e)=>{const r=n.data.forSlot(e);!r||s&&!lt(s,(t=>r.slot.id===t))?i=!0:r.import(t.values)}),{keys:!0}),n.stepToHead(),!i},t.fields=function(t,e,s,n=" / "){const i=vn(t instanceof Es?t.instance:t,"all",s,n);let r=0;return X(e,(t=>{let e=!1;X(i,(s=>{s.key!==t.key&&s.name!==t.name||(s.values.importValue(s.context,{value:t.value,reference:t.reference,display:t.display,time:t.time}),e=!0)})),e||r++})),0===r},t.CSV=function(t,e,s,n=","){const i=vn(t instanceof Es?t.instance:t,"exportables",s),r=M(e),a=[];let o=!0,h=!1,l="";for(let t=0;t<r;t++){const s=e.charAt(t),i='"'===s;h?i?t+1<r&&'"'===e.charAt(t+1)?(l+='"',t++):(a.push(l||void 0),h=!1,l=""):l+=s:o&&i?(o=!1,h=!0):s===n&&(o=!0)}if(h&&a.push(l),a.length===i.length){let t=0;return X(i,(e=>e.values.importValue(e.context,{value:a[t++]}))),!0}return!1}}(Cn||(Cn={}));class xn{constructor(t,e){this.m_pNodes=[],this.m_nEnumerators=0,this.m_pMoment=t,X(t.transducers,(s=>{const n=s.block(t.context);if(n instanceof gn)return;const i=W(s.props.nameVisible,!0);if(n||s.props.description||s.props.name&&i){let r="";this.nodes.push({id:s.id,get key(){return r||(r="_"+ze(s.id+t.context.key))},node:s,props:s.props,block:n,context:t.context,get collectsData(){return s.slots.count>0},get hasDataCollected(){return s.slots.each((e=>{const s=t.context.mutableValueOf(e);return(null==s?void 0:s.hasValue)||!1}))},hasChanged:(e=!0)=>t.context.instance.hasChanged(s.id,e),enumerator:(()=>{if(n&&s.slots.count>0&&i)return this.m_nEnumerators++,++e})(),get validation(){return n?n.validation:"pass"},get isFailed(){return!!n&&n.isFailed},get isPassed(){return!n||n.isPassed},moment:this,observer:"present"===t.tense&&s.await||void 0})}}))}get section(){return this.m_pMoment.state}get nodes(){return this.m_pNodes}get tense(){return this.m_pMoment.tense}get isPast(){return"past"===this.tense}get isPresent(){return"present"===this.tense}get isFuture(){return"future"===this.tense}get isEvaluating(){return this.m_pMoment.state.isEvaluating}get isFailed(){return!this.isEvaluating&&"fail"===this.section.getValidation(this.m_pMoment.context)}get isPassed(){return!this.isEvaluating&&"pass"===this.section.getValidation(this.m_pMoment.context)}get count(){return this.nodes.length}get enumerators(){return this.m_nEnumerators}get bookmark(){if(this.section.props.bookmark){const t=this.section.props.bookmarkName||this.section.props.name||"";if(t)return{name:t,description:this.section.props.bookmarkDescription||"",level:this.section.props.bookmarkLevel||1}}}restore(){this.m_pMoment.restore()}}class wn{constructor(t){this.m_pMomentsCache={},this.m_nMoments=0,this.m_nCurrent=0,this.m_pPages=[],this.m_pOrchestrator=t}get checksum(){return this.parseMoments(),this.m_sChecksum}get immutable(){const t=[...this.moments],e=this.presentMoment;return{moments:t,pages:this.pages,nodes:[...this.nodes],bookmarks:[...this.bookmarks],slides:[...this.slides],all:[...this.all],activeNodes:[...this.all],uniqueNodes:[...this.all],presentMoment:e,presentSection:this.presentSection,presentNodes:e&&[...e.nodes]||[],isEvaluating:this.isEvaluating,isEmpty:this.isEmpty,isAtStart:this.isAtStart,isAtHead:this.isAtHead,isAtFinish:this.isAtFinish,isFinishable:this.isFinishable,isFinishing:this.isFinishing,isFinished:this.isFinished,isPausing:this.isPausing,isPaused:this.isPaused,hasDataCollected:this.hasDataCollected,isFailed:e&&e.isFailed||!1,isPassed:e&&e.isPassed||!1,mode:this.mode,direction:this.direction,count:this.count,enumerators:this.enumerators,percentage:this.presentSection&&this.presentSection.percentageInRunner||0,map:e=>{let s=0;return et(t,(t=>e(t,s++)))},stepForward:()=>this.stepForward(),stepBackward:()=>this.stepBackward(),stepToStart:()=>this.stepToStart(),stepToHead:()=>this.stepToHead(),stepToPage:t=>this.stepToPage(t),finish:()=>this.finish()}}get instance(){return this.m_pOrchestrator.instance}get moments(){return this.parseMoments()}get pages(){return"paginated"===this.mode?(this.parseMoments(),this.m_pPages):[]}get activePage(){if("paginated"===this.mode)return this.parseMoments(),lt(this.m_pPages,(t=>t.active))}get nodes(){const t=this.parseMoments();if(!this.m_pNodes){const e={};this.m_pNodes=[],X(t,(t=>{X(t.nodes,(t=>{const s=t.id+t.context.key;e[s]||(this.m_pNodes.push(t),e[s]=!0)}))}))}return this.m_pNodes}get bookmarks(){const t=this.parseMoments();if(!this.m_pBookmarks){const e={},s={},n={id:ze("1"),section:void 0,context:void 0,label:"",name:"",description:"",level:1,nodes:[],bookmarks:[],get validation(){return lt(n.nodes,(t=>t.isFailed))?"failed":lt(n.bookmarks,(t=>"passed"!==t.validation))?"partial":"passed"}};let i=n;const r="group"===this.m_pOrchestrator.bookmarks,a=[i,void 0,void 0],o=a.length,h=t=>{var e;let s="";for(;t-- >1;)s=((null===(e=a[t-1])||void 0===e?void 0:e.id)||"")+s;return s};this.m_pBookmarks=[],X(t,(t=>{if(t.nodes.length>0){const l=t.bookmark;if(l){let e=l.level>1?l.level:1;if(e-i.level>1&&(e=i.level+1),e<=o&&(1===e||a[0].id!==n.id)){const n=t.nodes[t.nodes.length-1].context,o=t.section,u=ze(`${h(e)}${e}${l.name}${n.key}`);if(r&&s[u])a[i.level-1]=i=s[u];else if(i.id!==u){const t={id:u,section:o,context:n,get label(){return un(l.name,n)},name:l.name,description:l.description,level:e,nodes:[],bookmarks:[],get validation(){return lt(t.nodes,(t=>t.isFailed))?"failed":lt(t.bookmarks,(t=>"passed"!==t.validation))?"partial":"passed"}};r||delete s[u],i=t}}}X(t.nodes,(t=>{var n;const r=t.id+t.context.key;e[r]||(i.nodes.push(t),s[i.id]||(a[i.level-1]=s[i.id]=i,i.level>1?null===(n=a[i.level-2])||void 0===n||n.bookmarks.push(i):this.m_pBookmarks.push(i)),e[r]=!0)}))}}))}return this.m_pBookmarks}get slides(){if(!this.m_pSlides){const t=(e,s)=>{const n=s.length;s.push({index:n,id:e.id,get section(){return e.section},get context(){return e.context},get label(){return e.label},name:e.name,description:e.description,bookmark:e,nodes:e.nodes,isFirst:0===n,get isLast(){return s.length===n+1},get isPassed(){return"failed"!==e.validation},get isFailed(){return"failed"===e.validation},get previous(){return R(s,n-1)},get next(){return R(s,n+1)}}),X(e.bookmarks,(e=>{t(e,s)}))};this.m_pSlides=[],X(this.bookmarks,(e=>{t(e,this.m_pSlides)}))}return this.m_pSlides}get all(){if(!this.m_pAll){const t=(e,s)=>{X(e.nodes,(t=>{const n=t;n.bookmark=e,s.push(n)})),X(e.bookmarks,(e=>{t(e,s)}))};this.m_pAll=[],X(this.bookmarks,(e=>{t(e,this.m_pAll)}))}return this.m_pAll}get activeNodes(){return this.all}get uniqueNodes(){return this.all}get presentMoment(){return ut(this.moments,(t=>t.isPresent))}get presentSection(){const t=this.presentMoment;return t&&t.section}get presentNodes(){const t=this.presentMoment;return t&&t.nodes||[]}get isEvaluating(){const t=this.moments,e=t.length;for(let s=0;s<e;s++)if(t[s].isEvaluating)return!0;return!1}get isChanged(){const t=this.checksum,e=t!==this.m_sChecksumLast;return this.m_sChecksumLast=t,e}get isEmpty(){return!lt(this.moments,(t=>t.nodes.length>0))}get isAtStart(){return!!this.instance.isAtStart||"paginated"===this.mode&&(this.parseMoments(),this.m_pPages.length>0&&this.m_pPages[0].active)}get isAtHead(){return this.instance.isAtHead}get isAtFinish(){return this.instance.isAtFinish}get isFinishable(){return this.instance.isFinishable}get isFinishing(){return this.instance.isFinishing}get isFinished(){return this.instance.isFinished}get isPausing(){return this.instance.isPausing}get isPaused(){return this.instance.isPaused}get hasDataCollected(){return this.instance.hasDataCollected}get isFailed(){const t=this.presentMoment;return t&&t.isFailed||!1}get isPassed(){const t=this.presentMoment;return t&&t.isPassed||!1}get mode(){return this.instance.isPreview?"ahead":this.m_pOrchestrator.mode}get direction(){return this.m_pOrchestrator.direction}get count(){let t=0;return X(this.moments,(e=>{t+=e.count})),t}get enumerators(){let t=0;return X(this.moments,(e=>{t+=e.enumerators})),t}get percentage(){return this.presentSection&&this.presentSection.percentageInRunner||0}get prologue(){return this.m_pOrchestrator.prologue}get epilogue(){return this.m_pOrchestrator.epilogue}parseMoments(){const t=this.m_pOrchestrator.checksum;if(this.instance.isRunning){if(!this.m_pMoments||this.m_sChecksum!==t){const e=[],s=this.instance.history;let n,i=!1,r=0,a=0;this.m_nMoments=s.length,this.m_nCurrent=0,this.m_pPages=[];for(let t=0;t<this.m_nMoments;t++){const o=s[t];if(i&&"continuous"===this.mode)break;const h=this.m_pMomentsCache[o.checksum]||(this.m_pMomentsCache[o.checksum]=new xn(o,r));h.count>0&&(r+=h.enumerators,"present"!==o.tense&&"paginated"===this.mode||e.push(h),n=h),"paginated"===this.mode&&"present"===o.tense&&0===e.length&&n&&e.push(n),i=i||"present"===o.tense,"paginated"===this.mode&&h.count>0&&(i&&0===this.m_nCurrent&&(this.m_nCurrent=t+1),this.m_pPages.push({number:++a,active:this.m_nCurrent===t+1,activate:()=>this.stepToPage(t+1)}))}this.m_pMoments=e,this.m_sChecksum=t,this.m_pNodes=void 0,this.m_pBookmarks=void 0,this.m_pSlides=void 0,this.m_pAll=void 0}}else this.m_sChecksum=void 0,this.invalidate();return this.m_pMoments||[]}invalidate(){this.m_pMoments=void 0,this.m_pNodes=void 0,this.m_pBookmarks=void 0,this.m_pSlides=void 0,this.m_pAll=void 0,this.m_nMoments=0,this.m_nCurrent=0}reset(){this.m_pMomentsCache={}}map(t){let e=0;return et(this.moments,(s=>t(s,e++)))}stepForward(){return this.instance.stepForward()}stepBackward(){if("paginated"===this.mode){this.parseMoments();for(let t=1;t<this.m_pPages.length;t++)if(this.m_pPages[t].active)return this.m_pPages[t-1].activate(),!0}return this.instance.stepBackward()}stepToStart(){return"paginated"===this.mode&&(this.parseMoments(),this.m_pPages.length>0)?(this.m_pPages[0].activate(),!0):this.instance.stepToStart()}stepToHead(){return this.instance.stepToHead()}stepToPage(t){const e=this.instance.history;if(t>0&&t<=e.length){return e[t-1].restore(),!0}return!1}finish(){return this.instance.finish()}getNodeByKey(t){let e;return lt(this.moments,(s=>(e=lt(s.nodes,(e=>e.key===t)),!!e))),e}getKeyByNodeId(t){let e;return lt(this.moments,(s=>(e=lt(s.nodes,(e=>e.id===t)),!!e))),e?e.key:void 0}}function Mn(t,e){const s=window;if(void 0!==s)if(void 0!==typeof s[t])s[t]=e;else if(s[t]!==e)throw new Error(`Marblecore.Loader: Another context is already registered for '${t}'!`)}const Tn={};function In(t,e,s){if("undefined"!=typeof document){let n=!1;const i=t=>{n||(n=!0,s&&s(t))};try{const s=document.createElement("script");s.onload=()=>i(!0),s.onerror=()=>i(!1),s.async=!0,s.src=function(t,e){if("undefined"!=typeof trustedTypes&&trustedTypes.createPolicy&&e)return(Tn[e]||(Tn[e]=trustedTypes.createPolicy(e,{createScriptURL:t=>t}))).createScriptURL(t);return t}(t,e),document.body.appendChild(s)}catch(t){i(!1)}}else s&&s(!1)}class En{constructor(t){this.m_pBlocks={},this.m_sIdentifier=t}get identifier(){return this.m_sIdentifier}ofType(t){return this.m_pBlocks[t]}register(t,e,s,n,i,r,a){n&&0===e.indexOf("@tripetto/")&&Nt(this.m_pBlocks,`tripetto-${e.substring(10)}`,t),X(s,(e=>{Nt(this.m_pBlocks,e,t)})),Nt(t,"identifier",e),Nt(t,"ref",i),Nt(t,"autoRender",r),Nt(t,"autoValidate",a),t.prototype.type=Nt(this.m_pBlocks,e,t)}create(t,e){if(t.props.block){const s=this.ofType(t.props.block.type);if(s)return new s(t,e)}}}const Pn="default";class An{static get(t){return t=t||this.m_sIdentifier,this.m_pNamespaces[t]||Dt(this.m_pNamespaces,t,{identifier:t,nodeBlocks:new En(t),conditionBlocks:new bn(t)})}static isAvailable(t){return!!this.m_pNamespaces[t]}static mount(t){this.m_sIdentifier!==t&&(this.m_pStack.push(this.m_sIdentifier),this.m_sIdentifier=t)}static unmount(){this.m_sIdentifier=this.m_pStack.pop()||Pn}static loadUMD(t){if(t){Mn("TripettoRunner",s);try{return Function(t)(),!0}catch(t){return!1}}return!1}static loadURL(t,e){var n,i,r;n=t,i="tripetto#runner",r=e,Mn("TripettoRunner",s),In(n,i,r)}static unload(t){return!!this.m_pNamespaces[t]&&(Dt(this.m_pNamespaces,t,void 0),!0)}}function Fn(t){An.mount(t)}function On(){An.unmount()}An.m_pNamespaces={},An.m_pStack=[],An.m_sIdentifier=Pn;const Ln=t=>{var e;return t instanceof fn?((null===(e=t.props.block)||void 0===e?void 0:e.type)||"")+(t.props.disabled?"disabled":""):""},Bn=t=>!!t.props.block;function Rn(t){return new Js(Xs,fn,Qs,Zs,t,Ln,Bn)}function Hn(t){return Rn(t).fingerprint}function Vn(t,e){if(t.redirectUrl){const s=cn(t.redirectUrl,e);if(s)return s}}class Nn extends Ws{static getInitialStoryline(t){return{moments:[],pages:[],presentMoment:void 0,presentSection:void 0,presentNodes:[],nodes:[],bookmarks:[],slides:[],all:[],activeNodes:[],uniqueNodes:[],isEvaluating:!1,isEmpty:!1,isAtStart:!1,isAtHead:!1,isAtFinish:!1,isFinishable:!1,isFinishing:!1,isFinished:!1,isPausing:!1,isPaused:!1,hasDataCollected:!1,isFailed:!1,isPassed:!1,mode:t,direction:"forward",count:0,enumerators:0,percentage:0,map:()=>[],stepForward:()=>!1,stepBackward:()=>!1,stepToStart:()=>!1,stepToHead:()=>!1,stepToPage:()=>!1,finish:()=>!1}}constructor(t){super(Xs,fn,Qs,Zs,(()=>{if(!t.definition)throw new Error("The runner cannot start because no valid definition was supplied!");return t.definition})(),Ln,Bn,"progressive"===t.mode||"ahead"===t.mode,"ahead"===t.mode,!t.preview&&!t.test,t.preview?"compact":"disabled",t.l10n),this.m_pStories={},this.m_nSections=0,this.m_nNodes=0,this.m_bTest=!1,this.m_sMode=t.mode,this.m_bTest=t.test||!1,this.m_sNamespace=t.namespace,this.m_sBookmarks=t.bookmarks||"default",t.data&&this.hook("OnInstanceStart","synchronous",(e=>{t.data(e.instance)})),this.hook("OnChange","synchronous",(t=>{this.onChange&&this.onChange(t)})),this.hook("OnRestart","framed",(t=>{this.onRestart&&this.onRestart(t.instance)})),this.isLoaded&&(A(t.start)?t.start:this.isPreview||t.snapshot)&&(this.isPreview||!t.snapshot||!this.restore(t.snapshot)&&!this.prologue)&&this.start()}get handleChange(){return this.m_pChange||(this.m_pChange=new te(((t,e,s)=>{if("started"===e||"finished"===e||"stopped"===e||"paused"===e||"mode"===e||!t||t.isRunning){const n=this.mode;this.emitHook("OnChange",{runner:this,instance:t,change:e,get storyline(){return s&&s.immutable||Nn.getInitialStoryline(n)}}),t&&this.onInstanceChange(t,e,s)}}),"promise"))}get namespace(){return An.get(this.m_sNamespace)}get definition(){return this.ontology}set definition(t){t&&this.reload(t)}get instance(){return this.m_pInstance}get storyline(){if(this.instance){const t=this.story(this.instance);return t&&t.storyline}}get name(){return this.definition&&this.definition.name||""}get mode(){return this.m_sMode}set mode(t){if(t!==this.m_sMode){const e="progressive"===t||"ahead"===t,s=this.storyline;s&&s.reset(),this.m_sMode=t,s&&e===this.autoPushForward&&s.invalidate(),this.autoPushForward=e,this.ignoreValidation="ahead"===t,this.change(this.instance,"mode",!1)}}get isPreview(){return"disabled"!==this.previewMode()}set isPreview(t){if(t!==this.isPreview){const e=this.storyline;e&&e.reset(),this.previewMode(t?"compact":"disabled"),t&&!this.isRunning?this.start():this.change(this.instance,"preview",!1)}}get isTest(){return this.m_bTest&&!this.isPreview}set isTest(t){this.m_bTest=t}get status(){return this.isPreview?"preview":this.isEmpty?"empty":this.isFinishing?"finishing":this.isFinished?"finished":this.isStopped?"stopped":this.isPausing?"pausing":this.isPaused?"paused":this.isRunning?"running":"idle"}get isEmpty(){if(this.isFinished&&0===this.m_nNodes&&0===this.m_nSections)return!0;const t=this.storyline;return t&&t.isEmpty||!1}get prologue(){var t,e;return(null===(t=this.ontology)||void 0===t?void 0:t.prologue)||(null===(e=this.ontology)||void 0===e?void 0:e.preface)}get epilogue(){var t;return this.m_pEpilogue||Object.assign(Object.assign({},null===(t=this.ontology)||void 0===t?void 0:t.epilogue),{context:this.m_pContext,getRedirect:()=>{var t;return this.m_pContext&&(null===(t=this.ontology)||void 0===t?void 0:t.epilogue)&&Vn(this.ontology.epilogue,this.m_pContext)}})}story(t){const e=this.m_pStories;if(t.isRunning){const s=this,n=e[t.id]||Nt(e,t.id,{storyline:new wn({instance:t,get mode(){return s.mode},get bookmarks(){return s.m_sBookmarks},get checksum(){return n.checksum},get direction(){return n.direction||"forward"},get prologue(){return s.prologue},get epilogue(){return s.epilogue}})});return n.checksum=t.checksum,n}qt(e,t.id)}change(t,e,s){if(s&&(!t||!t.isRunning))return;const n=t&&this.story(t);if(n)switch(e){case"forward":case"backward":if("progressive"===this.mode||"ahead"===this.mode||this.isPreview)return;n.direction=e;break;case"started":n.storyline.invalidate()}this.handleChange.invoke(t,e,n&&n.storyline)}onInstanceChange(t,e,s){}onInstanceStart(t){this.m_pInstance=t,this.m_nSections=0,this.m_nNodes=0,this.m_pContext=void 0,this.m_pEpilogue=void 0,this.change(t,"started",!1),super.onInstanceStart(t)}onInstanceData(t,e){kt((()=>{this.onData&&this.onData(t,e)})),super.onInstanceData(t,e)}onInstanceProcessing(t,e){e?this.handleChange.hold():this.handleChange.release(),super.onInstanceProcessing(t,e)}onInstanceStepForward(t,e){return!("progressive"===this.mode||"ahead"===this.mode||!e)&&(0===e.transducers.count||!e.transducers.each((t=>t instanceof fn&&t.isVisible)))}onInstanceUpdate(t){this.change(t,"render",!0),super.onInstanceUpdate(t)}onInstanceFinishing(t,e){if(this.change(t,"finishing",!1),this.onFinish){const s=this.onFinish(t),n=(s,n)=>{e(s,n),s||this.change(t,"finishing",!1)};return A(s)?n(s):s.then((t=>n(!0,t))).catch((()=>n(!1))),!1}return super.onInstanceFinishing(t,e)}onInstanceEnd(t,e){this.change(t,e,!1),super.onInstanceEnd(t,e)}onInstanceSection(t,e,s){this.m_pContext||(this.m_pContext=t),this.m_pEpilogue=void 0,this.m_nSections++,this.change(t.instance,"render",!0)}onInstanceSectionEvaluating(t,e,s){this.change(t,"evaluating",!0)}onInstanceSectionLeave(t,e,s){}onInstanceBranchLeave(t,e){if(e.isFinish&&e.props.epilogue&&(!this.isPreview||e.isMain)){const s=!e.isMain&&e.id||void 0;this.m_pEpilogue&&this.m_pEpilogue.branch!==s||(this.m_pEpilogue=Object.assign(Object.assign({},e.props.epilogue),{branch:s,context:t,getRedirect:()=>t&&e.props.epilogue&&Vn(e.props.epilogue,t)}))}}onInstanceNode(t,e,s){this.m_nNodes++,this.change(t.instance,"render",!0)}onInstanceProgress(t,e){this.change(t,"progress",!0)}onInstanceStep(t,e){this.change(t,e,!0)}onInstanceValidated(t,e,s){this.change(t,"validated",!0)}restore(t){if(!S(t)&&this.resume(t))return this.firstItem}reload(t,e=!1){var s;const n=JSON.stringify(t);if(n!==(this.m_sDefinition||JSON.stringify(this.definition))){const i=(null===(s=this.instance)||void 0===s?void 0:s.isRunning)&&this.instance||void 0,r=i&&Sn.values(i);if(this.m_sDefinition=n,this.load(t),!e||r)return this.start(void 0,r&&(t=>{Cn.values(t.inherit(i),r)})||void 0)}if(!this.isRunning&&!e)return this.start()}restart(t=!1){const e=t&&this.instance&&this.instance.isRunning&&Sn.values(this.instance);this.stop();const s=this.start();return e&&Cn.values(s,e),this.emitHook("OnRestart",{runner:this,instance:s}),s}rerender(t){this.change(t,"render",!0)}stepForward(){const t=this.storyline;return t&&t.stepForward()||!1}stepBackward(){const t=this.storyline;return t&&t.stepBackward()||!1}stepToStart(){const t=this.storyline;return t&&t.stepToStart()||!1}stepToHead(){const t=this.storyline;return t&&t.stepToHead()||!1}finish(){const t=this.storyline;return t&&t.finish()||!1}}function Dn(t,e){switch(t){case"exportables":if(e instanceof Vs||e instanceof Es||"fingerprint"in e&&"stencil"in e&&"fields"in e){const t=e instanceof Vs||e instanceof Es?Sn.exportables(e):e;let s=ze("stencil:exportables");return X(t.fields,(t=>{s=Pe(s+t.node.id+t.datatype+t.slot+t.node.context)})),s===t.stencil?s:Pe(s+t.stencil)}break;case"actionables":if(e instanceof Vs||e instanceof Es||"fingerprint"in e&&"stencil"in e&&"nodes"in e){const t=e instanceof Vs||e instanceof Es?Sn.actionables(e):e;let s=ze("stencil:actionables");return t&&(X(t.nodes,(t=>{X(t.data,(e=>{s=Pe(s+t.node.id+e.datatype+e.slot+t.node.context)}))})),t.stencil!==s)?Pe(s+t.stencil):s}}return Rn(e).stencil(t)}function zn(t,e){const s=t instanceof Vs||t instanceof Es?{exportables:Sn.exportables(t),actionables:Sn.actionables(t)}:t;let n=Pe(s.exportables.fingerprint+(e?s.exportables.stencil:Dn("exportables",s.exportables)));return X(s.exportables.fields,(t=>{n=Pe(n+t.key+K(t.time)+t.string.substr(0,4096)+K(t.reference).substr(0,4096))})),s.actionables&&(n=Pe(n+s.actionables.fingerprint+(e?s.actionables.stencil:Dn("actionables",s.actionables))),X(s.actionables.nodes,(t=>{n=Pe(n+t.key),X(t.data,(t=>{n=Pe(n+t.key+K(t.time)+t.string.substr(0,4096)+K(t.reference).substr(0,4096))}))}))),n}const Un="0123456789abcdef";let Gn=0,$n=0,Kn=0;function jn(t,e){return(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}function qn(t,e,s){t[s]=e>>>24&255,t[s+1]=e>>>16&255,t[s+2]=e>>>8&255,t[s+3]=255&e}function Wn(t,e){const s=new Array(t.length/2),n=s.length;let i=0,r=0;if(e>=8*n)throw new Error("The difficulty is too high to solve.");for(;r<n;r++)s[r]=parseInt(t.charAt(2*r)+t.charAt(2*r+1),16);for(r=0;r<=e-8;r+=8,i++)if(i>=n||0!==s[i])return!1;return i<n&&!(s[i]&255<<8+r-e)}function Jn(e,s,n,i=16,r,a=Date.now(),o="milliseconds"){const h=new Array(i),l=h.length,u=zn(e,!0),c=Date.now();let m=c;for(let t=0;t<l;t++)h[t]=0;for(;!r||m-c<r;){let e=8,i="";const r=e+4*((l-e)/4|0),p=a+("milliseconds"===o?m-c:t.round((m-c)/1e3));for(qn(h,p/4294967296>>>0,0),qn(h,(4294967295&p)>>>0,4);e<r;e+=4)qn(h,4294967296*Math.random()>>>0,e);for(;e<l;e++)h[e]=256*Math.random()>>>0;for(let t=0;t<l;t++)i+=Un.charAt(h[t]>>>4&15)+Un.charAt(h[t]>>>0&15);if(Gn++,Wn(Pe(u+(n||"")+i),s))return Kn=Date.now()-c,$n+=Kn,i;m=Date.now()}throw Kn=m-c,$n+=Kn,new Error("Nonce not solved!")}function Yn(t,e,s,n,i){if(t.length<16||t.length>64||t.length%16)return!1;const r=new Array(t.length/2),a=r.length;for(let e=0;e<a;e++)r[e]=parseInt(t.charAt(2*e)+t.charAt(2*e+1),16);const o=Date.now()-(4294967296*jn(r,0)+jn(r,4));return!(s>0&&(o<0||o>s))&&!!Wn(Pe(zn(n,!1)+(i||"")+t),e)}function Zn(){return $n&&Gn/$n||0}function Qn(){return $n}function Xn(){return Kn}function ti(t,e){const s=t.length-e;let n="",i="";if(e>0&&s>=e){const r=(s-s%e)/e;if(r>=1&&t.length>=e*(r+1)){let s=0;for(;s<e;s++)i+=t.substring(s*(r+1),s*(r+1)+r),n+=t.charAt(s*(r+1)+r);s*(r+1)<t.length&&(i+=t.substring(s*(r+1)))}}return[n,i]}function ei(t,e,s,n){const[i,r]=ti(s,64);if(t.h(r)===i){const[s,i]=ti(r,96),a=t.h(s);try{const r=JSON.parse(t.d(i,a,256,t.a));if(r&&r.a&&e){let i=t.o,o="";if(t.c(r.a.split("."),(t=>{i=i[t]})),i)return t.f(r.b,(h=>{try{const l=JSON.parse(t.d(h,a+i,256,t.a));if(t.f("string"==typeof e?[e]:e,(e=>!(!(l&&t.f(l.a,(s=>s===t.h(a+e)))&&l.b===t.h(a+i)&&l.c)||n&&l.d!==n||l.e&&!((new Date).getTime()>=l.e)||l.f&&!((new Date).getTime()<l.f)||t.d(s,l.c+r.a,256,t.a)!==t.h(l.c+r.a))&&(o=l.c,!0))))return!0}catch(t){}return!1}))&&o||void 0}}catch(t){}}}const si=[99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22],ni=[[0,0,0,0],[1,0,0,0],[2,0,0,0],[4,0,0,0],[8,0,0,0],[16,0,0,0],[32,0,0,0],[64,0,0,0],[128,0,0,0],[27,0,0,0],[54,0,0,0]];function ii(t,e,s,n){for(let i=0;i<4;i++)for(let r=0;r<n;r++)t[i][r]^=e[4*s+r][i]}function ri(t,e){for(let s=0;s<4;s++)for(let n=0;n<e;n++)t[s][n]=si[t[s][n]]}function ai(t){for(let e=0;e<4;e++)t[e]=si[t[e]]}function oi(t){const e=t[0];for(let e=0;e<3;e++)t[e]=t[e+1];return t[3]=e,t}function hi(t,e){const s=new Array(4);for(let n=1;n<4;n++){for(let i=0;i<4;i++)s[i]=t[n][(i+n)%e];for(let e=0;e<4;e++)t[n][e]=s[e]}}function li(t){for(let e=0;e<4;e++){const s=new Array(4),n=new Array(4);for(let i=0;i<4;i++)s[i]=t[i][e],n[i]=128&t[i][e]?t[i][e]<<1^283:t[i][e]<<1;t[0][e]=n[0]^s[1]^n[1]^s[2]^s[3],t[1][e]=s[0]^n[1]^s[2]^n[2]^s[3],t[2][e]=s[0]^s[1]^n[2]^s[3]^n[3],t[3][e]=s[0]^n[0]^s[1]^s[2]^n[3]}}function ui(t,e){const s=e.length/4-1,n=[[],[],[],[]];for(let e=0;e<16;e++)n[e%4][Math.floor(e/4)]=t[e];ii(n,e,0,4);for(let t=1;t<s;t++)ri(n,4),hi(n,4),li(n),ii(n,e,t,4);ri(n,4),hi(n,4),ii(n,e,s,4);const i=new Array(16);for(let t=0;t<16;t++)i[t]=n[t%4][Math.floor(t/4)];return i}function ci(t){const e=t.length/4,s=e+6,n=new Array(4*(s+1)),i=[0,0,0,0];for(let s=0;s<e;s++)n[s]=[t[4*s],t[4*s+1],t[4*s+2],t[4*s+3]];for(let t=e;t<4*(s+1);t++){n[t]=[0,0,0,0];for(let e=0;e<4;e++)i[e]=n[t-1][e];if(t%e==0){ai(oi(i));for(let s=0;s<4;s++)i[s]^=ni[t/e][s]}else e>6&&t%e==4&&ai(i);for(let s=0;s<4;s++)n[t][s]=n[t-e][s]^i[s]}return n}function mi(t){return t.replace(/[\u0080-\u07ff]/g,(t=>{const e=t.charCodeAt(0);return String.fromCharCode(192|e>>6,128|63&e)})).replace(/[\u0800-\uffff]/g,(t=>{const e=t.charCodeAt(0);return String.fromCharCode(224|e>>12,128|e>>6&63,128|63&e)}))}function pi(t,e,s,n){const i=s/8,r=new Array(i);t=n(t),e=mi(e);for(let t=0;t<i;t++)r[t]=isNaN(e.charCodeAt(t))?0:e.charCodeAt(t);const a=ui(r,ci(r)),o=ci(a.concat(a.slice(0,i-16))),h=new Array(8),l=t.slice(0,8),u=Math.ceil((t.length-8)/16),c=new Array(u);for(let t=0;t<8;t++)h[t]=l.charCodeAt(t);for(let e=0;e<u;e++)c[e]=t.slice(8+16*e,8+16*e+16);const m=new Array(c.length);for(let t=0;t<u;t++){for(let e=0;e<4;e++)h[15-e]=t>>>8*e&255;for(let e=0;e<4;e++)h[15-e-4]=(t+1)/4294967296-1>>>8*e&255;const e=ui(h,o),s=new Array(c[t].length);for(let n=0;n<c[t].length;n++)s[n]=String.fromCharCode(e[n]^c[t].charCodeAt(n));m[t]=s.join("")}return m.join("").replace(/[\u00e0-\u00ef][\u0080-\u00bf][\u0080-\u00bf]/g,(t=>String.fromCharCode((15&t.charCodeAt(0))<<12|(63&t.charCodeAt(1))<<6|63&t.charCodeAt(2)))).replace(/[\u00c0-\u00df][\u0080-\u00bf]/g,(t=>String.fromCharCode((31&t.charCodeAt(0))<<6|63&t.charCodeAt(1))))}var di=Object.freeze({__proto__:null,decrypt:pi,encrypt:function(t,e,s,n){const i=s/8,r=new Array(i);t=mi(t),e=mi(e);for(let t=0;t<i;t++)r[t]=isNaN(e.charCodeAt(t))?0:e.charCodeAt(t);const a=ui(r,ci(r)),o=ci(a.concat(a.slice(0,i-16))),h=Math.ceil(t.length/16),l=new Array(16),u=new Array(h),c=(new Date).getTime(),m=c%1e3,p=Math.floor(c/1e3),d=Math.floor(65535*Math.random());for(let t=0;t<2;t++)l[t]=m>>>8*t&255;for(let t=0;t<2;t++)l[t+2]=d>>>8*t&255;for(let t=0;t<4;t++)l[t+4]=p>>>8*t&255;let g="";for(let t=0;t<8;t++)g+=String.fromCharCode(l[t]);for(let e=0;e<h;e++){for(let t=0;t<4;t++)l[15-t]=e>>>8*t&255;for(let t=0;t<4;t++)l[15-t-4]=e/4294967296>>>8*t;const s=e<h-1?16:(t.length-1)%16+1,n=ui(l,o),i=new Array(s);for(let r=0;r<s;r++)i[r]=String.fromCharCode(n[r]^t.charCodeAt(16*e+r));u[e]=i.join("")}return n(g+u.join(""))}});function gi(t,e,s){return ei({h:Ue,d:pi,a:atob,f:lt,c:X,o:window},"string"==typeof t?["@tripetto/runner",t]:["@tripetto/runner",...t],e,s)}function fi(t,e,s){return function(t,e,s,n){return!!ei(t,e,s,n)}({h:Ue,d:pi,a:atob,f:lt,c:X,o:window},"string"==typeof t?["@tripetto/runner",t]:["@tripetto/runner",...t],e,s)}function _i(t){switch(t.type){case"node":return e=>{F(t.namespace)?X(t.namespace,(s=>An.get(s).nodeBlocks.register(e,t.identifier,w(t.alias)?[t.alias]:t.alias||[],t.legacyBlock||!1,t.ref,t.autoRender,t.autoValidate))):An.get(t.namespace).nodeBlocks.register(e,t.identifier,w(t.alias)?[t.alias]:t.alias||[],t.legacyBlock||!1,t.ref,t.autoRender,t.autoValidate)};case"headless":return e=>{F(t.namespace)?X(t.namespace,(s=>An.get(s).nodeBlocks.register(e,t.identifier,w(t.alias)?[t.alias]:t.alias||[],t.legacyBlock||!1))):An.get(t.namespace).nodeBlocks.register(e,t.identifier,w(t.alias)?[t.alias]:t.alias||[],t.legacyBlock||!1)};case"condition":return e=>{F(t.namespace)?X(t.namespace,(s=>An.get(s).conditionBlocks.register(e,t.identifier,w(t.alias)?[t.alias]:t.alias||[],t.legacyBlock||!1))):An.get(t.namespace).conditionBlocks.register(e,t.identifier,w(t.alias)?[t.alias]:t.alias||[],t.legacyBlock||!1)}}}function bi(t,e,s){ae("condition",t,e,s,"single")}function yi(t,e,s){ae("validator",t,e,s,"single")}function vi(t,e,s){ae("destroy",t,e,s)}const ki="@tripetto/runner",Si="8.2.0";export{di as AES,ss as Await,Qs as Branch,es as Callback,Zs as Condition,_n as ConditionBlock,bn as ConditionBlocksNamespace,Jt as Console,Es as Context,se as DEBUG,Fs as Data,b as DateTime,te as Debounce,i as Enumerator,Yt as Environment,ws as Errors,Sn as Export,Zt as Flags,gn as HeadlessBlock,re as Hooks,Cn as Import,Vs as Instance,qs as L10n,Qt as Limiter,tn as MarkdownFeatures,sn as MarkdownParser,xn as Moment,ki as NAME,An as Namespaces,fn as Node,dn as NodeBlock,En as NodeBlocksNamespace,t as Num,Nn as Runner,je as SHA2,Xs as Section,_s as Slot,Ms as Slots,ee as Stack,wn as Storyline,e as Str,Xt as Throttle,s as TripettoRunner,Si as VERSION,Ps as Value,R as arrayItem,B as arraySize,G as assert,_i as block,Rn as calculateFingerprintAndStencil,mt as call,pt as callAsync,ft as callBind,gt as callEx,_t as callFunction,dt as callPromise,Mt as cancelFrame,Ft as cancelInterval,Ct as cancelPromise,vt as cancelTick,It as cancelTimeout,Lt as cancelUIInterval,Pt as cancelUITimeout,$ as cast,W as castToBoolean,q as castToFloat,j as castToNumber,K as castToString,zn as checksum,J as clone,Q as compare,bi as condition,at as count,Wt as createInstanceOf,s as default,vi as destroy,ie as disableDebugging,X as each,tt as eachReverse,ne as enableDebugging,Y as extend,Z as extendImmutable,ht as filter,ct as find,lt as findFirst,ut as findLast,Hn as fingerprint,H as firstArrayItem,ot as forEach,zt as get,Ut as getAny,Gt as getBoolean,jt as getFloat,Kt as getNumber,$t as getString,nt as has,rt as hasOneOrMore,it as hasOnly,ue as hookup,F as isArray,L as isArrayOrCollection,A as isBoolean,O as isCollection,N as isDate,k as isDefined,z as isError,T as isFilledString,P as isFloat,x as isFunction,S as isNull,I as isNumber,E as isNumberFinite,C as isObject,U as isPromise,D as isRegEx,w as isString,v as isUndefined,rn as isVariable,V as lastArrayItem,gi as licensee,et as map,ln as markdownify,mn as markdownifyTo,pn as markdownifyToPlainText,un as markdownifyToString,cn as markdownifyToURL,Fn as mountNamespace,y as noop,Xn as powDuration,Zn as powHashRate,Jn as powSolve,Qn as powSpentTime,Yn as powVerify,st as reduce,Vt as scheduleAction,wt as scheduleAndCancelFrame,St as scheduleAndCancelPromise,yt as scheduleAndCancelTick,Rt as scheduleAnimation,Ht as scheduleEvent,xt as scheduleFrame,At as scheduleInterval,Bt as scheduleNumberOfFrames,kt as schedulePromise,bt as scheduleTick,Tt as scheduleTimeout,Ot as scheduleUIInterval,Et as scheduleUITimeout,Nt as set,Dt as setAny,Dn as stencil,M as stringLength,_i as tripetto,On as unmountNamespace,yi as validator,fi as verify};
