import * as Color from "color";

const getColor = (input) => {
    if (input) {
        input = input.toLowerCase();
        if (input !== "transparent") {
            try {
                return Color.default(input);
            } catch (_a) {
                try {
                    return Color.default("#" + input);
                } catch (_b) {
                    return Color.default("rgba(255,255,255,0)");
                }
            }
        }
    }
    return Color.default("rgba(255,255,255,0)");
};
const color = (input, operations) => {
    let clr = getColor(input);
    if (operations) {
        const ops = {
            manipulate: (manipulation, condition = true) => {
                if (condition) {
                    clr = manipulation(clr);
                }
                return ops;
            },
            makeBlackOrWhite: (condition = true) => {
                if (condition) {
                    const luminance = (0.299 * clr.red() + 0.587 * clr.green() + 0.114 * clr.blue()) / 255;
                    clr = clr
                        .red(luminance > 0.55 ? 0 : 255)
                        .green(luminance > 0.55 ? 0 : 255)
                        .blue(luminance > 0.55 ? 0 : 255)
                        .alpha(1);
                }
                return ops;
            },
            makeUnclear: (c) => {
                if (c && clr.alpha() === 0) {
                    clr = getColor(c);
                }
                return ops;
            },
        };
        operations(ops);
    }
    return clr.rgb().string();
};

export { color, getColor };
