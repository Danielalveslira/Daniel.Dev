import { skin } from "./skin/index.mjs";
import { clothing } from "./clothing/index.mjs";
import { face } from "./face/index.mjs";
import { top } from "./top/index.mjs";

const avataaarsCache = {};
const avataaars = (props, type) => {
    const key = `${type}:${props.skin}:${props.eyes}:${props.eyeBrow}:${props.mouth}:${props.top}:${props.hairColor || ""}:${
        props.hatColor || ""
    }:${props.facialHair}:${props.facialHairColor || ""}:${props.clothing}:${props.clothingFabric || ""}:${props.clothingGraphic || ""}:${
        props.accessories
    }`;
    const cache = avataaarsCache[key];
    if (cache) {
        return cache;
    }
    const svg = `
        <svg width="264px" height="280px" viewBox="0 0 264 280" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
            <g id="Avataaar" stroke-width="1" fill-rule="evenodd">
                ${skin(props.skin)}
                ${clothing(props.clothing, props.clothingFabric, props.clothingGraphic)}
                ${face(props.mouth, props.eyes, props.eyeBrow)}
                ${top(props.top, props.hairColor, props.hatColor, props.facialHair, props.facialHairColor, props.accessories)}
            </g>
        </svg>
    `;
    return (avataaarsCache[key] = type === "base64" ? btoa(svg) : svg);
};

export { avataaars };
