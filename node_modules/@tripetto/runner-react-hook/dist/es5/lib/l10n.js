"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.useL10n = void 0;
var react_1 = require("react");
var useL10n = function (initialL10n, onL10n, runner, purgeCache) {
    var l10n = (0, react_1.useRef)(initialL10n || {});
    var updateRef = (0, react_1.useRef)();
    var setL10n = function (l) {
        l10n.current = l;
        if (updateRef.current) {
            updateRef.current();
        }
    };
    updateRef.current = function () {
        if (purgeCache) {
            purgeCache();
        }
        runner.update();
    };
    return [
        l10n.current,
        function (l) {
            if (onL10n) {
                onL10n(l)
                    .then(function () {
                        return setL10n(l);
                    })
                    .catch(function () {
                        return setL10n(l);
                    });
            } else {
                setL10n(l);
            }
        },
        function (language) {
            if (
                onL10n &&
                ((l10n.current.language !== "auto" && l10n.current.language) ||
                    language ||
                    navigator.language) !== runner.l10n.current
            ) {
                onL10n(l10n.current).then(function () {
                    if (updateRef.current) {
                        updateRef.current();
                    }
                });
            }
        },
    ];
};
exports.useL10n = useL10n;
